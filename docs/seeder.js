!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.scores=e||[new r(8,s.Strength),new r(8,s.Dexterity),new r(8,s.Constitution),new r(8,s.Intelligence),new r(8,s.Wisdom),new r(8,s.Charisma)]}static Empty(){return new i([new r(0,s.Strength),new r(0,s.Dexterity),new r(0,s.Constitution),new r(0,s.Intelligence),new r(0,s.Wisdom),new r(0,s.Charisma)])}map(e){return this.scores.map(e)}reduce(e,t){return this.scores.reduce(e,t)}modifier(e){return this.scores.find(t=>t.kind==e).modifier}value(e){return this.scores.find(t=>t.kind==e).value}diff(e){return Object.getOwnPropertyNames(s).map(t=>[t,e.value(t)-this.value(t)])}clone(){return i.fromJson(this)}set(e,t){let n=this.scores.findIndex(t=>t.kind==e);n<0||(this.scores[n].value=t)}add(e){return new i([new r(this.scores[0].value+e.scores[0].value,this.scores[0].kind),new r(this.scores[1].value+e.scores[1].value,this.scores[1].kind),new r(this.scores[2].value+e.scores[2].value,this.scores[2].kind),new r(this.scores[3].value+e.scores[3].value,this.scores[3].kind),new r(this.scores[4].value+e.scores[4].value,this.scores[4].kind),new r(this.scores[5].value+e.scores[5].value,this.scores[5].kind)])}totalCost(){return this.scores.reduce((e,t)=>e+t.cost(),0)}static fromJson(e){return new i(e.scores.map(r.fromJson))}}t.AbilityScores=i;class r{constructor(e,t){this.value=e,this.kind=t}get modifier(){return Math.floor((this.value-10)/2)}cost(){return this.value<14?this.value-8:2*(this.value-13)+5}static fromJson(e){return new r(e.value,e.kind)}}var s;t.AbilityScore=r,function(e){e.Strength="Strength",e.Dexterity="Dexterity",e.Constitution="Constitution",e.Intelligence="Intelligence",e.Wisdom="Wisdom",e.Charisma="Charisma"}(s=t.AbilityKind||(t.AbilityKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),r=n(4),s=n(6),a=n(3),o=n(7),l=n(5),c=n(9);class u{constructor(e=u.nextName(),t=new i.AbilityScores,n=new s.Race,r,a=new o.Background(o.BackgroundKind.Criminal),c=w.ChaoticGood(),d=0,f=new S,p=160,m="grey",g=0,y=null,v=null,b=new l.Skills,k=[new A],C=new D,K=[h.Common],P=0,W=0,_=[],F=[]){this.name=e,this.abilityScores=t,this.race=n,this.characterClass=r,this.background=a,this.alignment=c,this.experience=d,this.height=f,this.weight=p,this.eyeColor=m,this.inspiration=g,this.armor=y,this.shield=v,this.skills=b,this.weapons=k,this.wealth=C,this.languages=K,this.damage=P,this.tempHp=W,this.magicItems=_,this.expendables=F,this.background.skills.map(e=>{this.skills.set(e,!0)})}get proficiencyBonus(){return this.characterClass.proficiencyBonus()}get proficiency(){let e=this.characterClass.armorProfs.map(e=>`${e} Armor`);return e.push(...this.characterClass.weaponProfs.map(e=>p[e.replace(/\s/g,"")]?e:`${e} Weapons`)),e.push(...this.characterClass.miscProfs),this.background.toolProficiencies.forEach(t=>{Array.isArray(t)||e.push(t)}),this.background.languages.length>0&&(0==this.background.languages.filter(e=>null!=e).length?e.push(`${this.background.languages.length} languages of your choice`):e.push(...this.background.languages)),e}static nextName(){let e="Carl";return u.counter>0&&(e+=` ${u.counter}`),u.counter++,e}get saves(){let e=this.abilityScores.map(e=>{let t=new i.AbilityScore(e.value,e.kind),n=this.race.abilityModifiers.find(e=>e[0]==t.kind);n&&(t.value+=n[1]);let r=this.characterClass.bonusAbilityScores.find(e=>e[0]==t.kind);return r&&(t.value+=r[1]),t}),t=this.characterClass.savingThrows;return e.map(e=>{let n=t.indexOf(e.kind)>-1,i=n?e.modifier+this.proficiencyBonus:e.modifier;return new k(e.kind,n,i)})}get rawSkills(){let e=this.modifiedAbilityScores().reduce((e,t)=>(e[t.kind]=t.modifier,e),{});return this.skills.map(t=>{let n=e[t.modifier],i=0,r=t.enabled||this.characterClass.selectedSkills.indexOf(t.kind)>-1;r?i=this.characterClass.expertise.includes(t.kind)?2*this.proficiencyBonus:this.proficiencyBonus:this.characterClass.name===a.ClassKind.Bard&&this.level>1&&(i=Math.floor(this.proficiencyBonus/2));let s=n+i;return[t.kind,s,r]})}modifiedAbilityScores(){return this.abilityScores.map(e=>{let t=0,n=this.race.abilityModifiers.find(t=>t[0]==e.kind);n&&(t+=n[1]);let r=this.characterClass.bonusAbilityScores.find(t=>t[0]==e.kind);return r&&(t+=r[1]),new i.AbilityScore(t+e.value,e.kind)})}get passiveWisdom(){return this.abilityScores.modifier(i.AbilityKind.Wisdom)+this.proficiencyBonus}get initiative(){return this.modifiedAbilityScores().find(e=>e.kind===i.AbilityKind.Dexterity).modifier}armorClass(){let e=this.modifiedAbilityScores().find(e=>e.kind===i.AbilityKind.Dexterity).modifier,t=0;return this.armor?(t=this.armor.bonus,this.armor.dexLimit&&this.armor.dexLimit<e&&(e=this.armor.dexLimit)):this.characterClass.name==a.ClassKind.Barbarian&&(t=this.abilityScores.modifier(i.AbilityKind.Constitution)),this.shield&&(t+=this.shield.bonus),10+t+e}get level(){let e=r.Data.levelForExp(this.experience);return this.characterClass.level!=e&&(this.characterClass.level=e),e}addExperience(e){this.experience+=e}get expToNextLevel(){switch(this.level){case 1:return 300-this.experience;case 2:return 900-this.experience;case 3:return 2700-this.experience;case 4:return 6500-this.experience;case 5:return 14e3-this.experience;case 6:return 23e3-this.experience;case 7:return 34e3-this.experience;case 8:return 48e3-this.experience;case 9:return 64e3-this.experience;case 10:return 85e3-this.experience;case 11:return 1e5-this.experience;case 12:return 12e4-this.experience;case 13:return 14e4-this.experience;case 14:return 165e3-this.experience;case 15:return 195e3-this.experience;case 16:return 225e3-this.experience;case 17:return 265e3-this.experience;case 18:return 305e3-this.experience;case 19:return 355e3-this.experience}}hitPoints(){let e=this.abilityScores.modifier(i.AbilityKind.Constitution),t=this.characterClass.hitDie+e,n=r.Data.averageHpFor(this.characterClass.name);for(let i=0;i<this.level;i++)t+=n+e;return t}currentHealth(){return this.hitPoints()+this.tempHp-this.damage}get speed(){return this.characterClass.name==a.ClassKind.Barbarian&&this.level>4?this.race.speed+10:this.race.speed}abilityScoreModNeeded(){return r.Data.getAbilityScoreBonusCountFor(this.characterClass.name,this.level)-this.characterClass.bonusAbilityCount()}skillsModNeeded(){return this.characterClass.numberOfSkills-this.characterClass.selectedSkills.length}availableSkillsToAdd(){return this.characterClass.unselectedAvailableSkills().filter(e=>!this.background.skills.includes(e))}castorAbilityModifier(){let e;switch(this.characterClass.name){case a.ClassKind.Bard:case a.ClassKind.Paladin:case a.ClassKind.Sorcerer:case a.ClassKind.Warlock:e=i.AbilityKind.Charisma;break;case a.ClassKind.Cleric:case a.ClassKind.Druid:case a.ClassKind.Ranger:e=i.AbilityKind.Wisdom;break;case a.ClassKind.Fighter:case a.ClassKind.Rogue:case a.ClassKind.Wizard:e=i.AbilityKind.Intelligence;break;default:return 0}return this.modifiedAbilityScores().find(t=>t.kind===e).modifier}static fromJson(e){if(!e){let e=new Error("Character json is undefined");throw console.error(e.message,e.stack),e}let t=new u(e.name,i.AbilityScores.fromJson(e.abilityScores),s.Race.fromJson(e.race),a.Class.fromJson(e.characterClass),o.Background.fromJson(e.background),w.fromJson(e.alignment),e.experience,S.fromJson(e.height),e.weight,e.eyeColor,e.inspiration,C.fromJson(e.armor),C.fromJson(e.shield),l.Skills.fromJson(e.skills),e.weapons.map(A.fromJson),D.fromJson(e.wealth),e.languages,e.damage,e.tempHp,e.magicItems.map(K.fromJson),e.expendables.map(P.fromJson));return e.id&&(t.id=e.id),t}}var h,d,f,p,m,g,y,v,b;u.counter=0,t.Character=u,function(e){e.Common="Common",e.Dwarvish="Dwarvish",e.Elvish="Elvish",e.Halfling="Halfling",e.Draconic="Draconic",e.Gnomish="Gnomish",e.Orc="Orc",e.Infernal="Infernal"}(h=t.NormalLanguage||(t.NormalLanguage={})),function(e){e.ThievesCant="Thieves' Cant",e.Druidic="Druidic"}(t.ClassLanguage||(t.ClassLanguage={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(t.CharacterSize||(t.CharacterSize={}));class w{constructor(e,t){this.major=e,this.minor=t}toString(){return this.major==d.Neutral&&this.minor==f.Neutral?"True Neutral":`${this.major} ${this.minor}`}static LawfulGood(){return new w(d.Lawful,f.Good)}static LawfulNeutral(){return new w(d.Lawful,f.Neutral)}static LawfulEvil(){return new w(d.Lawful,f.Evil)}static NeutralGood(){return new w(d.Neutral,f.Good)}static TrueNeutral(){return new w(d.Neutral,f.Neutral)}static NeutralEvil(){return new w(d.Neutral,f.Evil)}static ChaoticGood(){return new w(d.Chaotic,f.Good)}static ChaoticNeutral(){return new w(d.Chaotic,f.Neutral)}static ChaoticEvil(){return new w(d.Chaotic,f.Evil)}static fromJson(e){return new w(e.major,e.minor)}}t.Alignment=w,function(e){e.Lawful="Lawful",e.Neutral="Neutral",e.Chaotic="Chaotic"}(d=t.AlignmentMajor||(t.AlignmentMajor={})),function(e){e.Good="Good",e.Neutral="Neutral",e.Evil="Evil"}(f=t.AlignmentMinor||(t.AlignmentMinor={}));class S{constructor(e=5,t=9){this.feet=e,this.inches=t}toString(){return`${this.feet}' ${this.inches}"`}static fromJson(e){return new S(e.feet,e.inches)}}t.Height=S;class k{constructor(e,t,n){this.kind=e,this.enabled=t,this.value=n}static fromJson(e){return new k(e.kind,e.enabled,e.value)}}t.Save=k;class C{constructor(e,t,n,i){this.name=e,this.kind=t,this.bonus=n,this.dexLimit=i}static fromJson(e){return e?new C(e.name,e.kind,e.bonus,e.dexLimit):null}}t.Armor=C,function(e){e.Padded="Padded",e.Leather="Leather",e.StuddedLeather="StuddedLeather"}(t.LightArmor||(t.LightArmor={})),function(e){e.Hide="Hide",e.ChainShirt="ChainShirt",e.ScaleMail="ScaleMail",e.BreastPlate="BreastPlate",e.HalfPlate="HalfPlate"}(t.MediumArmor||(t.MediumArmor={})),function(e){e.RingMail="RingMail",e.ChainMail="ChainMail",e.Splint="Splint",e.Plate="Plate"}(t.HeavyArmor||(t.HeavyArmor={})),function(e){e.Light="Light",e.Medium="Medium",e.Heavy="Heavy",e.Shield="Shield"}(t.ArmorWeight||(t.ArmorWeight={}));class A{constructor(e="Daggar",t=m.Melee,n=g.Simple,i=y.Piercing,r=v.Light,s=b.One,a=[1,4],o=new c.Range(5),l=1,u=new c.Range(20,60),h=!1,d=!0,f=""){this.name=e,this.weaponType=t,this.kind=n,this.damageKind=i,this.weight=r,this.handedness=s,this.hitDie=a,this.range=o,this.carryWeight=l,this.thrown=u,this.isRanged=h,this.isFinesse=d,this.notes=f}miscString(){let e=`${this.damageKind.substr(0,1)}`;return this.handedness&&(e+=`/${this.handedness.substr(0,1)}`),this.weight&&(e+=`/${this.weight.substr(0,1).toLocaleLowerCase()}`),this.isRanged&&(e+="/R"),this.thrown&&(e+="/T"),this.isFinesse&&(e+="/F"),e+="/"+this.range.metaString()}static fromJson(e){return new A(e.name,e.weaponType,e.kind,e.damageKind,e.weight,e.handedness,e.hitDie,c.Range.fromJson(e.range),e.carryWeight,c.Range.fromJson(e.thrown),e.isRanged,e.isFinesse,e.notes)}}t.Weapon=A,function(e){e.Battleaxe="Battleaxe",e.HandAxe="Hand Axe",e.ThrowingHammer="Throwing Hammer",e.WarHammer="War Hammer",e.LongSword="Long Sword",e.ShortSword="Short Sword",e.ShortBow="Short Bow",e.LongBow="Long Bow",e.Rapier="Rapier",e.HandCrossbow="Hand Crossbow",e.Club="Club",e.Dagger="Dagger",e.Dart="Dart",e.Javelin="Javelin",e.Mace="Mace",e.QuarterStaff="Quarter Staff",e.Scimitar="Scimitar",e.Sickle="Sickle",e.Sling="Sling",e.LightCrossbow="LightCrossbow",e.Spear="Spear"}(p=t.StdWeaponName||(t.StdWeaponName={})),function(e){e.Melee="Melee",e.Range="Range"}(m=t.WeaponType||(t.WeaponType={})),function(e){e.Simple="Simple",e.Martial="Martial",e.Natural="Natural"}(g=t.WeaponKind||(t.WeaponKind={})),function(e){e.Piercing="Piercing",e.Slashing="Slashing",e.Bludgeoning="Bludgeoning",e.Acid="Acid",e.Fire="Fire",e.Lightening="Lightening",e.Cold="Cold",e.Poison="Poison"}(y=t.WeaponDamageKind||(t.WeaponDamageKind={})),function(e){e.Light="Light",e.Heavy="Heavy"}(v=t.WeaponWeight||(t.WeaponWeight={})),function(e){e.One="One",e.Two="Two",e.Versatile="Versatile"}(b=t.WeaponHandedness||(t.WeaponHandedness={}));class D{constructor(e=0,t=0,n=0,i=0,r=0){this.copper=e,this.silver=t,this.electrum=n,this.gold=i,this.platinum=r,this.balance()}balance(){this.roundUp(),this.roundDown()}clone(){return D.fromJson(this)}add(e){return new D(this.copper+e.copper,this.silver+e.silver,this.electrum+e.electrum,this.gold+e.gold,this.platinum+e.platinum)}mul(e){return new D(this.copper*e,this.silver*e,this.electrum*e,this.gold*e,this.platinum*e)}roundUp(){for(;this.copper>99;)this.copper-=100,this.silver++;for(;this.silver>99;)this.silver-=100,this.electrum++;for(;this.electrum>99;)this.electrum-=100,this.gold++;for(;this.gold>99;)this.gold-=100,this.platinum+=1}roundDown(){for(;this.copper<0;)this.silver--,this.copper+=100;for(;this.silver<0;)this.electrum--,this.silver+=100;for(;this.electrum<0;)this.gold--,this.electrum+=100;for(;this.gold<0;)this.platinum--,this.gold+=100}static fromJson(e){return new D(e.copper||0,e.silver||0,e.electrum||0,e.gold||0,e.platinum||0)}}t.Wealth=D;class K{constructor(e,t){this.name=e,this.buf=t}static fromJson(e){return new K(e.name,e.buf)}}t.MagicItem=K;class P{constructor(e,t,n){this.quantity=e,this.name=t,this.desc=n}static fromJson(e){return new P(e.quantity,e.name,e.desc)}}t.ExpendableItem=P},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),r=n(1),s=n(5),a=n(11),o=n(4),l=n(12);t.DEFAULT_BONUS_ABILITY_SCORES=[[i.AbilityKind.Strength,0],[i.AbilityKind.Dexterity,0],[i.AbilityKind.Constitution,0],[i.AbilityKind.Intelligence,0],[i.AbilityKind.Wisdom,0],[i.AbilityKind.Charisma,0]];class c{constructor(e,n,i,r=t.DEFAULT_BONUS_ABILITY_SCORES,s=[],a=[],o){switch(this.name=e,this._level=n,this.classDetails=i,this.bonusAbilityScores=r,this.selectedSkills=s,this.expertise=a,this.casterInfo=o,this.numberOfPrimaryAbilities=1,this.savingThrows=[],this.weaponProfs=[],this.armorProfs=[],this.canUseShield=!1,this.features=[],this.numberOfSkills=0,this.availableSkills=[],this.miscProfs=[],e){case u.Barbarian:this.barbarianCtor(i);break;case u.Bard:this.bardCtor(i);break;case u.Cleric:this.clericCtor(i);break;case u.Druid:this.druidCtor(i);case u.Fighter:this.fighterCtor(i);break;case u.Monk:this.monkCtor(i);break;case u.Paladin:this.paladinCtor(i);break;case u.Ranger:this.rangerCtor(i);break;case u.Rogue:this.rogueCtor(i);break;case u.Sorcerer:this.sorcererCtor(i);break;case u.Warlock:this.warlockCtor(i);break;case u.Wizard:this.wizardCtor(i)}}get level(){return this._level}set level(e){this._level=e,this.classDetails.level&&(this.classDetails.level=e)}proficiencyBonus(){return o.Data.proficiencyBonusFor(this.level)}barbarianCtor(e){this.desc="A fierce warrior of primitive background who can enter a battle rage",this.classDetails=e,this.hitDie=12,this.primaryAbility=[i.AbilityKind.Strength,i.AbilityKind.Constitution],this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Constitution],this.weaponProfs=[r.WeaponKind.Martial,r.WeaponKind.Simple],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium,r.ArmorWeight.Heavy],this.canUseShield=!0,this.numberOfSkills=2,this.availableSkills=[s.SkillKind.AnimalHandling,s.SkillKind.Athletics,s.SkillKind.Intimidation,s.SkillKind.Nature,s.SkillKind.Perception,s.SkillKind.Survival]}bardCtor(e=new a.BardDetails(this._level,null,[])){this.desc="An inspiring magician whose power echoes the music of creation",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Charisma],this.savingThrows=[i.AbilityKind.Charisma,i.AbilityKind.Dexterity],this.weaponProfs=[r.WeaponKind.Simple,r.StdWeaponName.HandCrossbow,r.StdWeaponName.LongSword,r.StdWeaponName.Rapier,r.StdWeaponName.ShortSword],this.armorProfs=[r.ArmorWeight.Light],this.numberOfSkills=3,this.availableSkills=Object.getOwnPropertyNames(s.SkillKind).map(e=>s.SkillKind[e]),this.classDetails&&this.classDetails.archetype===a.BardCollege.Valor&&this._level>2&&(this.weaponProfs.push(r.WeaponKind.Martial),this.armorProfs.push(r.ArmorWeight.Medium),this.canUseShield=!0),this.miscProfs=["Musical Instrument"],this._level>2&&this.expertise.length<2&&(this.expertise=[null,null])}clericCtor(e){this.desc="A priestly champion who wields divine magic in service of a higher power",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Wisdom],this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Charisma],this.weaponProfs=[r.WeaponKind.Simple],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.numberOfSkills=2,this.classDetails.archetype!==a.ClericDomain.Knowledge&&this.classDetails.archetype!==a.ClericDomain.Nature||(this.numberOfSkills+=2),this.availableSkills=[s.SkillKind.History,s.SkillKind.Insight,s.SkillKind.Medicine,s.SkillKind.Persuasion,s.SkillKind.Religion],this.canUseShield=!0}druidCtor(e){this.desc="A priest of the Old Faith, wielding lhe powers of nature-moonlight and plant growth, fire and lightning-and adopting animal forms",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Wisdom],this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Intelligence],this.weaponProfs=[r.StdWeaponName.Club,r.StdWeaponName.Dagger,r.StdWeaponName.Dart,r.StdWeaponName.Javelin,r.StdWeaponName.Mace,r.StdWeaponName.QuarterStaff,r.StdWeaponName.Scimitar,r.StdWeaponName.Sickle,r.StdWeaponName.Spear],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Arcana,s.SkillKind.AnimalHandling,s.SkillKind.Insight,s.SkillKind.Medicine,s.SkillKind.Nature,s.SkillKind.Perception,s.SkillKind.Religion,s.SkillKind.Survival],this.canUseShield=!0}fighterCtor(e){this.desc="A master of martial combat, skilled with a variety of weapons and armor",this.classDetails=e,this.hitDie=10,this.primaryAbility=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium,r.ArmorWeight.Heavy],this.weaponProfs=[r.WeaponKind.Simple,r.WeaponKind.Martial],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Acrobatics,s.SkillKind.AnimalHandling,s.SkillKind.Athletics,s.SkillKind.History,s.SkillKind.Insight,s.SkillKind.Intimidation,s.SkillKind.Perception,s.SkillKind.Survival],this.canUseShield=!0}monkCtor(e){this.desc="An master of martial arts, harnessing the power of lhe body in pursuit of physical and spiritual perfection",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Dexterity,i.AbilityKind.Wisdom],this.numberOfPrimaryAbilities=2,this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[],this.weaponProfs=[r.WeaponKind.Simple,r.StdWeaponName.ShortSword],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Acrobatics,s.SkillKind.Athletics,s.SkillKind.History,s.SkillKind.Insight,s.SkillKind.Religion,s.SkillKind.Stealth]}paladinCtor(e){this.desc="A holy warrior bound to a sacred oath",this.classDetails=e,this.hitDie=10,this.primaryAbility=[i.AbilityKind.Strength,i.AbilityKind.Charisma],this.numberOfPrimaryAbilities=2,this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Charisma],this.canUseShield=!0,this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium,r.ArmorWeight.Heavy],this.weaponProfs=[r.WeaponKind.Martial,r.WeaponKind.Simple],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Athletics,s.SkillKind.Insight,s.SkillKind.Intimidation,s.SkillKind.Medicine,s.SkillKind.Persuasion,s.SkillKind.Religion]}rangerCtor(e){this.desc="A warrior who uses martial prowess and nature magic lo combat threats on lhe edges of civilization",this.classDetails=e,this.hitDie=10,this.primaryAbility=[i.AbilityKind.Dexterity,i.AbilityKind.Wisdom],this.numberOfPrimaryAbilities=2,this._level,this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.canUseShield=!0,this.weaponProfs=[r.WeaponKind.Simple,r.WeaponKind.Martial],this.numberOfSkills=3,this.availableSkills=[s.SkillKind.AnimalHandling,s.SkillKind.Athletics,s.SkillKind.Insight,s.SkillKind.Investigation,s.SkillKind.Nature,s.SkillKind.Perception,s.SkillKind.Stealth,s.SkillKind.Survival]}rogueCtor(e){this.desc="A scoundrel who uses stealth and trickery to overcome obstacles and enemies",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Dexterity],this.savingThrows=[i.AbilityKind.Dexterity,i.AbilityKind.Intelligence],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.canUseShield=!0,this.weaponProfs=[r.WeaponKind.Simple,r.StdWeaponName.HandCrossbow,r.StdWeaponName.LongSword,r.StdWeaponName.Rapier,r.StdWeaponName.ShortSword],this.numberOfSkills=4,this.availableSkills=[s.SkillKind.Acrobatics,s.SkillKind.Athletics,s.SkillKind.Deception,s.SkillKind.Insight,s.SkillKind.Intimidation,s.SkillKind.Investigation,s.SkillKind.Perception,s.SkillKind.Performance,s.SkillKind.Persuasion,s.SkillKind.SleightOfHand,s.SkillKind.Stealth],this.expertise.length<2&&(this.expertise=[null,null])}sorcererCtor(e){this.desc="A spell caster who draws on inherent magic from a gift or bloodline",this.classDetails=e,this.hitDie=6,this.primaryAbility=[i.AbilityKind.Charisma],this.savingThrows=[i.AbilityKind.Constitution,i.AbilityKind.Charisma],this.weaponProfs=[r.StdWeaponName.Dagger,r.StdWeaponName.Sling,r.StdWeaponName.Dart,r.StdWeaponName.QuarterStaff,r.StdWeaponName.LightCrossbow],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Arcana,s.SkillKind.Deception,s.SkillKind.Insight,s.SkillKind.Intimidation,s.SkillKind.Persuasion,s.SkillKind.Religion]}warlockCtor(e){this.desc="A wielder of magic that is derived from a bargain with an extra-planar entity",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Charisma],this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Charisma],this.armorProfs=[r.ArmorWeight.Light],this.weaponProfs=[r.WeaponKind.Simple],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Arcana,s.SkillKind.Deception,s.SkillKind.History,s.SkillKind.Intimidation,s.SkillKind.Investigation,s.SkillKind.Nature,s.SkillKind.Religion]}wizardCtor(e){this.desc="A scholarly magic-user capable of manipulating lhe structures of reality",this.classDetails=e,this.hitDie=6,this.primaryAbility=[i.AbilityKind.Intelligence],this.savingThrows=[i.AbilityKind.Intelligence,i.AbilityKind.Wisdom],this.weaponProfs=[r.StdWeaponName.Dagger,r.StdWeaponName.Dart,r.StdWeaponName.Sling,r.StdWeaponName.QuarterStaff,r.StdWeaponName.LightCrossbow],this.armorProfs=[],this.numberOfSkills=2,this.availableSkills=[s.SkillKind.Arcana,s.SkillKind.History,s.SkillKind.Insight,s.SkillKind.Investigation,s.SkillKind.Medicine,s.SkillKind.Religion]}addLevel(){this.level+=1}get isCaster(){return this.name==u.Bard||this.name==u.Cleric||this.name==u.Druid||this.name==u.Paladin&&this.level>1||this.name==u.Ranger||this.name==u.Sorcerer||this.name==u.Warlock||this.name==u.Wizard||this.name==u.Fighter&&this.classDetails.archetype==a.CombatArchetype.EldrichKnight||this.name==u.Rogue&&this.classDetails.archetype==a.RoguishArchetype.ArcaneTrickster}bonusAbilityCount(){return this.bonusAbilityScores.reduce((e,t)=>e+t[1],0)}unselectedAvailableSkills(){if(this.name===u.Cleric){if(this.classDetails.archetype===a.ClericDomain.Knowledge)return[s.SkillKind.Arcana,s.SkillKind.History,s.SkillKind.Nature,s.SkillKind.Religion].filter(e=>this.selectedSkills.includes(e));if(this.classDetails.archetype===a.ClericDomain.Nature)return[s.SkillKind.AnimalHandling,s.SkillKind.Nature,s.SkillKind.Survival].filter(e=>this.selectedSkills.includes(e))}return[]}static fromJson(e){let t=new c(null,e._level,null,e.bonusAbilityScores,e.selectedSkills||[],e.expertise||[],l.CasterInfo.fromJson(e.casterInfo));switch(t.name=e.name,e.name){case u.Barbarian:t.barbarianCtor(a.BarbarianDetails.fromJson(e.classDetails));break;case u.Bard:t.bardCtor(a.BardDetails.fromJson(e.classDetails));break;case u.Cleric:t.clericCtor(a.ClericDetails.fromJson(e.classDetails));break;case u.Druid:t.druidCtor(a.DruidDetails.fromJson(e.classDetails));break;case u.Fighter:t.fighterCtor(a.FighterDetails.fromJson(e.classDetails));break;case u.Monk:t.monkCtor(a.MonkDetails.fromJson(e.classDetails));break;case u.Paladin:t.paladinCtor(a.PaladinDetails.fromJson(e.classDetails));break;case u.Ranger:t.rangerCtor(a.RangerDetails.fromJson(e.classDetails));break;case u.Rogue:t.rogueCtor(a.RogueDetails.fromJson(e.classDetails));break;case u.Sorcerer:t.sorcererCtor(a.SorcererDetails.fromJson(e.classDetails));break;case u.Warlock:t.warlockCtor(a.WarlockDetails.fromJson(e.classDetails));break;case u.Wizard:t.wizardCtor(a.WizardDetails.fromJson(e.classDetails))}return t}}var u;t.Class=c,function(e){e.Barbarian="Barbarian",e.Bard="Bard",e.Cleric="Cleric",e.Druid="Druid",e.Fighter="Fighter",e.Monk="Monk",e.Paladin="Paladin",e.Ranger="Ranger",e.Rogue="Rogue",e.Sorcerer="Sorcerer",e.Warlock="Warlock",e.Wizard="Wizard"}(u=t.ClassKind||(t.ClassKind={}))},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,o)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),s=n(6),a=n(3),o=n(7),l=n(13),c=n(16),u=n(11),h=n(12);t.Data=class{constructor(){this.db=new m}getCharacters(){return i(this,void 0,void 0,function*(){return this.db.ready||(yield this.db.init()),yield this.db.allCharacters()})}addCharacter(e){return i(this,void 0,void 0,function*(){yield this.db.addCharacter(e)})}saveCharacter(e){return i(this,void 0,void 0,function*(){return this.db.saveCharacter(e)})}getSpellsForClass(e){return i(this,void 0,void 0,function*(){return this.db.spellsForClass(e)})}getClassDetails(e,t){return i(this,void 0,void 0,function*(){return this.db.getClassDetails(e,t)})}static getAllClasses(){return Object.getOwnPropertyNames(a.ClassKind).map(e=>a.ClassKind[e])}static getAllRaces(){return Object.getOwnPropertyNames(s.RaceKind).map(e=>s.RaceKind[e])}static subRaceFor(e){switch(e){case s.RaceKind.Elf:return Object.getOwnPropertyNames(s.Elf).map(e=>s.Elf[e]);case s.RaceKind.Dwarf:return Object.getOwnPropertyNames(s.Dwarf).map(e=>s.Dwarf[e]);case s.RaceKind.Gnome:return Object.getOwnPropertyNames(s.Gnome).map(e=>s.Gnome[e]);case s.RaceKind.Halfling:return Object.getOwnPropertyNames(s.Halfling).map(e=>s.Halfling[e]);case s.RaceKind.Dragonborn:return Object.getOwnPropertyNames(s.Dragon).map(e=>s.Dragon[e]);default:return null}}static getAllBackground(){return[o.Background.Acolyte(),o.Background.Charlatan(),o.Background.Criminal(),o.Background.Entertainer(),o.Background.FolkHero(),o.Background.GuildArtisan(),o.Background.Hermit(),o.Background.Noble(),o.Background.Outlander(),o.Background.Sage(),o.Background.Sailor(),o.Background.Soldier(),o.Background.Urchin()]}static levelForExp(e){return e<300?1:e<900?2:e<2700?3:e<6500?4:e<14e3?5:e<23e3?6:e<34e3?7:e<48e3?8:e<64e3?9:e<85e3?10:e<1e5?11:e<12e4?12:e<14e4?13:e<165e3?14:e<195e3?15:e<225e3?16:e<265e3?17:e<305e3?18:e<355e3?19:20}static proficiencyBonusFor(e){return e<5?2:e<9?3:e<13?4:e<17?5:6}static averageHpFor(e){switch(e){case a.ClassKind.Barbarian:return 7;case a.ClassKind.Fighter:case a.ClassKind.Paladin:case a.ClassKind.Ranger:return 6;case a.ClassKind.Bard:case a.ClassKind.Cleric:case a.ClassKind.Druid:case a.ClassKind.Rogue:case a.ClassKind.Warlock:case a.ClassKind.Monk:return 5;case a.ClassKind.Sorcerer:case a.ClassKind.Wizard:return 4}}static startingWealthFor(e){let t=10,n=0;switch(e){case a.ClassKind.Barbarian:case a.ClassKind.Druid:n=2;break;case a.ClassKind.Sorcerer:n=3;break;case a.ClassKind.Rogue:case a.ClassKind.Warlock:case a.ClassKind.Wizard:n=4;break;default:n=5;case a.ClassKind.Monk:t=1}let i=0;for(var s=0;s<n;s++)i+=Math.floor(4*Math.random())+1;return new r.Wealth(0,0,0,i*t,0)}static getAbilityScoreBonusCountFor(e,t){let n=0;return t>3&&(n+=2),t>7&&(n+=2),t>11&&(n+=2),t>15&&(n+=2),t>18&&(n+=2),e===a.ClassKind.Rogue&&t>9&&(n+=2),e===a.ClassKind.Fighter&&(t>5&&(n+=2),t>13&&(n+=2)),n}};class d{constructor(e,t,n,i,r,s,a,o){this.classKind=e,this.level=t,this.name=n,this.shortDesc=i,this.longDesc=r,this.options=s,o&&(this.id=o),a&&(this.levelValues=a)}static fromJson(e){let t=new d(e.classKind,e.level,e.name,e.shortDesc,e.longDesc);return e.options&&(t.options=e.options.map(e=>f.fromJson(e,e.features))),e.id&&(t.id=e.id),e.levelValues&&(t.levelValues=e.levelValues),t}getShortDesc(e){return this.levelValues?this.shortDesc.replace("{{levelValue}}",this.levelValues[e-1].toString()):this.shortDesc}getLongDesc(e){return this.levelValues?this.longDesc.replace("{{levelValue}}",this.levelValues[e-1].toString()):this.longDesc}toString(){return`${this.name} - ${this.shortDesc}`}}t.ClassFeature=d;class f{constructor(e,t,n,i,r){this.name=e,this.shortDesc=t,this.longDesc=n,this.features=i,r&&(this.id=r)}static fromJson(e,t){let n=new f(e.name,e.shortDesc,e.longDesc);return t&&(n.features=t.map(d.fromJson)),e.id&&(n.id=e.id),n}}function p(e){let t="";return t+=e[0].toLocaleUpperCase(),t+=e.substr(1)}t.ClassFeatureOption=f;class m extends c.default{constructor(){super("DnDCharacterManager"),this.ready=!1,window.db=this;try{this.version(3).stores({seeds:"++id",characters:"++id,name",spells:"++id,name,*classKinds",classFeatures:"++id,classKind,level,optionId",classFeatureOptions:"++id,featId",classSpellSlots:"++id,classKind,level"})}catch(e){console.error("error upgrading to version 3",e)}this.version(2).stores({seeds:"++id",characters:"++id,name",spells:"++id,name,*classKinds",classFeatures:"++id,classKind,level,optionId",classFeatureOptions:"++id,featId"}).upgrade(e=>{console.info("upgrading to v2"),this.upgradeToTwo(e).then(()=>{console.info("update complete")})}),this.version(1).stores({seeds:"++id",characters:"++id,name",bardSpells:"++id,name",clericSpells:"++id,name",druidSpells:"++id,name",paladinSpells:"++id,name",rangerSpells:"++id,name",rogueSpells:"++id,name",sorcererSpells:"++id,name",warlockSpells:"++id,name",wizardSpells:"++id,name"})}upgradeToTwo(e){return i(this,void 0,void 0,function*(){for(let t in e.tables){let n=t.indexOf("Spells");if(n>-1){let i=p(t.substring(0,n)),r=yield e.table(t).toArray();for(let t of r){let n=yield e.table("spells").where("name").equals(t.name).first();n?(n.classKinds.push(i),yield e.table("spells").put(n)):(delete t.id,t.classKinds=[i],yield e.table("spells").add(t))}}}})}init(){return i(this,void 0,void 0,function*(){console.info("checking for seeds");let e=yield this.seeds.orderBy("id").reverse().first();e?e.version<this.verno?(console.info("outdated database reseeding"),yield this.seed(!0)):console.info("last seeded version",e.version||1,"at",e.when):(console.info("no seeds... seeding"),yield this.seed()),this.ready=!0})}seed(e=!1){return i(this,void 0,void 0,function*(){return Promise.resolve().then(()=>n(14)).then(t=>t.seed(this,e))})}allCharacters(){return i(this,void 0,void 0,function*(){let e=yield this.characters.toArray(),t=new Array(e.length);for(let n=0;n<e.length;n++){let i=e[n],s=r.Character.fromJson(i);s.characterClass.isCaster&&(s.characterClass.casterInfo=yield this.casterInfoFor(s)),t[n]=s}return t})}addCharacter(e){return i(this,void 0,void 0,function*(){try{e.characterClass.isCaster&&(e.characterClass.casterInfo=yield this.casterInfoFor(e)),yield this.characters.add(e)}catch(t){console.error("failed to add character",t,e)}})}casterInfoFor(e){return i(this,void 0,void 0,function*(){let t=yield this.classSpellSlots.where("classKind").equals(e.characterClass.name).and(t=>t.level===e.level).first(),n=t.spells||0;return e.characterClass.name!==a.ClassKind.Cleric&&e.characterClass.name!==a.ClassKind.Druid&&e.characterClass.name!==a.ClassKind.Paladin&&e.characterClass.name!==a.ClassKind.Wizard||(n=e.characterClass.level+e.castorAbilityModifier()),new h.CasterInfo(t.slots,t.slots,t.cantrips,n,(e.characterClass.casterInfo._knownSpells||t._knownSpells||[]).map(l.Spell.fromJson))})}saveCharacter(e){return i(this,void 0,void 0,function*(){try{let t=r.Character.fromJson(yield this.characters.get(e.id));if(t.level<e.level){for(let n=0;n<e.level-t.level;n++){let i=yield this.getSingleLevelFeatures(e.characterClass.name,t.level+n+1);e.characterClass.classDetails.features.push(...i)}if(e.characterClass._level=e.level,e.characterClass.classDetails.level=e.level,e.characterClass.isCaster){let t=e.characterClass.casterInfo._knownSpells.map(e=>e);e.characterClass.casterInfo=yield this.casterInfoFor(e),e.characterClass.casterInfo.setRawSpells(t)}}e.characterClass.isCaster&&!e.characterClass.casterInfo?e.characterClass.casterInfo=yield this.casterInfoFor(e):!e.characterClass.isCaster&&e.characterClass.casterInfo&&delete e.characterClass.casterInfo,yield this.characters.put(e)}catch(e){console.error(e)}return e})}spellsForClass(e){return i(this,void 0,void 0,function*(){try{return(yield this.spells.where("classKinds").equals(e).toArray()).map(e=>new l.Spell(e.name,e.level,e.verbalRequirement,e.somaticRequirement,e.materialRequirement,e.castingTime,e.desc,e.duration,e.range,e.save))}catch(t){throw console.error("failed to get spells for ",e,t),t}})}getClassDetails(e,t){return i(this,void 0,void 0,function*(){let n=yield this.getClassFeatures(e,t);switch(e){case a.ClassKind.Barbarian:return new u.BarbarianDetails(t,n);case a.ClassKind.Bard:return new u.BardDetails(t,n);case a.ClassKind.Cleric:return new u.ClericDetails(t,n);case a.ClassKind.Druid:return new u.DruidDetails(t,n);case a.ClassKind.Fighter:return new u.FighterDetails(t,n);case a.ClassKind.Monk:return new u.MonkDetails(t,n);case a.ClassKind.Paladin:return new u.PaladinDetails(t,n);case a.ClassKind.Ranger:return new u.RangerDetails(t,n);case a.ClassKind.Rogue:return new u.RogueDetails(t,n);case a.ClassKind.Sorcerer:return new u.SorcererDetails(t,n);case a.ClassKind.Warlock:return new u.WarlockDetails(t,n);case a.ClassKind.Wizard:return new u.WizardDetails(t,n)}})}getClassFeatures(e,t,n){return i(this,void 0,void 0,function*(){let i=yield this.classFeatures.where("classKind").equals(e).and(e=>e.level<=t&&e.optionId==n).toArray(),r=new Array(i.length);for(let n=0;n<i.length;n++){let s=i[n],a=new d(s.classKind,s.level,s.name,s.shortDesc,s.longDesc,null,s.levelValues,s.id),o=yield this.getOptionsForClassFeature(i[n].id);if(o&&o.length>0){let n=new Array(o.length);for(let i=0;i<o.length;i++){let r=o[i],s=yield this.getClassFeatures(e,t,r.id);n[i]=new f(r.name,r.shortDesc,r.longDesc,s,r.id)}a.options=n}r[n]=a}return r})}getSingleLevelFeatures(e,t,n){return i(this,void 0,void 0,function*(){let i=yield this.classFeatures.where("classKind").equals(e).and(e=>e.level===t&&e.optionId==n).toArray(),r=new Array(i.length);for(let n=0;n<i.length;n++){let s=i[n],a=new d(s.classKind,s.level,s.name,s.shortDesc,s.longDesc,null,s.levelValues,s.id),o=yield this.getOptionsForClassFeature(i[n].id);if(o&&o.length>0){let n=new Array(o.length);for(let i=0;i<o.length;i++){let r=o[i],s=yield this.getClassFeatures(e,t,r.id);n[i]=new f(r.name,r.shortDesc,r.longDesc,s,r.id)}a.options=n}r[n]=a}return r})}getOptionsForClassFeature(e){return i(this,void 0,void 0,function*(){return yield this.classFeatureOptions.where("featId").equals(e).toArray()})}getFeaturesForOption(e){return i(this,void 0,void 0,function*(){return yield this.classFeatures.where("optionId").equals(e).toArray()})}getCasterInfoFor(e,t){return i(this,void 0,void 0,function*(){return yield this.classSpellSlots.where("classKind").equals(e).and(e=>e.level===t).first()})}}t.Database=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);class r{constructor(e=[new s(a.Acrobatics,!1,i.AbilityKind.Dexterity),new s(a.AnimalHandling,!1,i.AbilityKind.Wisdom),new s(a.Athletics,!1,i.AbilityKind.Strength),new s(a.Arcana,!1,i.AbilityKind.Intelligence),new s(a.Deception,!1,i.AbilityKind.Charisma),new s(a.History,!1,i.AbilityKind.Intelligence),new s(a.Insight,!1,i.AbilityKind.Wisdom),new s(a.Intimidation,!1,i.AbilityKind.Charisma),new s(a.Investigation,!1,i.AbilityKind.Intelligence),new s(a.Medicine,!1,i.AbilityKind.Wisdom),new s(a.Nature,!1,i.AbilityKind.Intelligence),new s(a.Perception,!1,i.AbilityKind.Wisdom),new s(a.Performance,!1,i.AbilityKind.Charisma),new s(a.Persuasion,!1,i.AbilityKind.Charisma),new s(a.Religion,!1,i.AbilityKind.Intelligence),new s(a.SleightOfHand,!1,i.AbilityKind.Dexterity),new s(a.Stealth,!1,i.AbilityKind.Dexterity),new s(a.Survival,!1,i.AbilityKind.Wisdom)]){this.skills=e}isEnabled(e){if(!this.skills)return!1;let t=this.skills.filter(t=>t.kind==e);return t.length>0&&t[0].enabled}map(e){return this.skills.map(e)}set(e,t){let n=this.skills.findIndex(t=>t.kind==e);n>-1&&(this.skills[n].enabled=t)}enabledCount(){return this.skills.filter(e=>e.enabled).length}static fromJson(e){return new r(e.skills.map(s.fromJson))}}t.Skills=r;class s{constructor(e,t,n){this.kind=e,this.enabled=t,this.modifier=n}static from(e){return new s(e.kind,e.enabled,e.modifier)}get desc(){switch(this.kind){case a.Acrobatics:return`Dealing with difficult physical situations like tumbling or balancing on a ledge, modified by ${this.modifier}`;case a.AnimalHandling:return`Your ability to communicate with animals like calming your mount or interpreting your dog's needs, modified by ${this.modifier}`;case a.Arcana:return`This represents your knowledge about all things magic, modified by ${this.modifier}`;case a.Athletics:return`Physical situations that might be an olympic individual competition like long/high jump or swimming, modified by ${this.modifier}`;case a.Deception:return`Your ability to hide information from someone else, modified by ${this.modifier}`;case a.History:return`Your ability to recall important things from the past, modified by ${this.modifier}`;case a.Insight:return`Your ability to see through deception, modified by ${this.modifier}`;case a.Intimidation:return`Your ability to scare someone into doing what you want, modified by ${this.modifier}`;case a.Investigation:return`Your ability to discern the information you need from the resources in front of you, modified by ${this.modifier}`;case a.Medicine:return`Your ability to stabilize someone who's below 0 HP, modified by ${this.modifier}`;case a.Nature:return`You knowledge of the natural world, modified by ${this.modifier}`;case a.Perception:return`Your ability to notice something in your current environment, modified by ${this.modifier}`;case a.Performance:return`Your ability to entertain a crowd, modified by ${this.modifier}`;case a.Persuasion:return`Your ability to influence someone else's decision, modified by ${this.modifier}`;case a.Religion:return`Your knowledge about the gods and their worshipers, modified by ${this.modifier}`;case a.SleightOfHand:return`When you want to do something with your hands discretely enough that someone else doesn't see/feel it like card tricks or pick pocketing, modified by ${this.modifier}`;case a.Stealth:return`When you want to remain hidden, modified by ${this.modifier}`;case a.Survival:return`Anything Bear Grills would need to do to survive, modified by ${this.modifier}`;default:return""}}copy(){return s.from(this)}static fromJson(e){return new s(e.kind,e.enabled,e.modifier)}}var a;t.Skill=s,function(e){e.Acrobatics="Acrobatics",e.AnimalHandling="Animal Handling",e.Arcana="Arcana",e.Athletics="Athletics",e.Deception="Deception",e.History="History",e.Insight="Insight",e.Intimidation="Intimidation",e.Investigation="Investigation",e.Medicine="Medicine",e.Nature="Nature",e.Perception="Perception",e.Performance="Performance",e.Persuasion="Persuasion",e.Religion="Religion",e.SleightOfHand="Sleight Of Hand",e.Stealth="Stealth",e.Survival="Survival"}(a=t.SkillKind||(t.SkillKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1),r=n(9),s=n(0),a=n(10);class o{constructor(e=l.Human,t=null){switch(this.name=e,this.size=i.CharacterSize.Medium,this.speed=30,this.weaponProfs=[],this.toolProfs=[],this.languages=[],this.armorProfs=[],this.miscBenefits=[],this.bonusLanguages=0,this.naturalWeapons=[new i.Weapon("Left Fist",i.WeaponType.Melee,i.WeaponKind.Martial,i.WeaponDamageKind.Bludgeoning,i.WeaponWeight.Light,i.WeaponHandedness.One,[1,4]),new i.Weapon("Right Fist",i.WeaponType.Melee,i.WeaponKind.Martial,i.WeaponDamageKind.Bludgeoning,i.WeaponWeight.Light,i.WeaponHandedness.One,[1,4])],e==l.Dragonborn&&null==t&&(t=f.Black),this.checkSubRace(t),this.subRace=t,e){case l.Dwarf:this.dwarfCtor();break;case l.Elf:this.elfCtor();break;case l.Halfling:this.halflingCtor();break;case l.Human:this.humanCtor();break;case l.Dragonborn:this.dragonbornCtor();break;case l.Gnome:this.gnomeCtor();break;case l.HalfElf:this.halfElfCtor();break;case l.HalfOrc:this.halfOrcCtor();break;case l.Tiefling:this.tieflingCtor()}}dwarfCtor(){this.abilityModifiers=[[s.AbilityKind.Constitution,2]],this.subRace==c.Hill&&this.abilityModifiers.push([s.AbilityKind.Wisdom,1]),this.subRace==c.Mountain&&this.abilityModifiers.push([s.AbilityKind.Strength,2]),this.ageRange=[50,350],this.preferredAlignment=new i.Alignment(i.AlignmentMajor.Lawful,i.AlignmentMinor.Good),this.heightRange=[new i.Height(4,0),new i.Height(5,0)],this.size=i.CharacterSize.Medium,this.avgWeight=150,this.speed=25,this.darkVision=new r.Range(60),this.weaponProfs=[i.StdWeaponName.Battleaxe,i.StdWeaponName.HandAxe,i.StdWeaponName.ThrowingHammer,i.StdWeaponName.WarHammer],this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Dwarvish],this.miscBenefits=["Your speed is not reduced by wearing heavy armor","Stonecunning: +1 on Int (History) checks about Stonework"],this.subRace==c.Hill&&this.miscBenefits.push("+1 max HP at each level"),this.subRace==c.Mountain&&(this.armorProfs=[i.ArmorWeight.Light,i.ArmorWeight.Medium])}elfCtor(){this.abilityModifiers=[[s.AbilityKind.Dexterity,2]],this.subRace==u.High&&this.abilityModifiers.push([s.AbilityKind.Intelligence,1]),this.subRace==u.Wood&&this.abilityModifiers.push([s.AbilityKind.Wisdom,1]),this.subRace==u.Drow&&this.abilityModifiers.push([s.AbilityKind.Charisma,1]),this.ageRange=[100,750],this.preferredAlignment=new i.Alignment(i.AlignmentMajor.Chaotic,this.subRace==u.Drow?i.AlignmentMinor.Evil:i.AlignmentMinor.Good),this.heightRange=[new i.Height(5,0),new i.Height(6,0)],this.avgWeight=130,this.size=i.CharacterSize.Medium,this.speed=30,this.darkVision=new r.Range(60),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Elvish],this.miscBenefits=["Keen Senses: Proficiency in perception","Fey Ancestry: Advantage against being charmed and magic cannot be put to sleep","Trance: Instead of sleeping you meditate for 4 hours"],this.subRace==u.High&&(this.weaponProfs=[i.StdWeaponName.LongBow,i.StdWeaponName.LongSword,i.StdWeaponName.ShortBow,i.StdWeaponName.ShortSword],this.miscBenefits.push("Cantrip: You know one Cantrip of your choice from lhe wizard spell list"),this.bonusLanguages=1),this.subRace==u.Wood&&(this.weaponProfs=[i.StdWeaponName.LongBow,i.StdWeaponName.LongSword,i.StdWeaponName.ShortBow,i.StdWeaponName.ShortSword],this.speed=35,this.miscBenefits.push("Mask of the Wild: You can attempt to hide even when you are only lightly obscured by foliage, heavy rain, falling snow, mist, and other natural phenomena.")),this.subRace==u.Drow&&(this.darkVision=new r.Range(120),this.miscBenefits.push("Sun Light Sensitivity: You have disadvantage on attack rolls and on Wisdom (Perception) checks that rely on sight when you, the target of your attack, or whatever you are trying to perceive is in direct sunlight"),this.miscBenefits.push("Drow Magic: You know the dancing lights Cantrip. At level 3 you can cas Faerie Fire once per day, at level 5 you can cast Darkness once per day Charisma is your spell casting ability"),this.weaponProfs=[i.StdWeaponName.ShortSword,i.StdWeaponName.Rapier,i.StdWeaponName.HandCrossbow])}halflingCtor(){this.abilityModifiers=[[s.AbilityKind.Dexterity,2]],this.heightRange=[new i.Height(2,6),new i.Height(3,6)],this.avgWeight=40,this.preferredAlignment=i.Alignment.LawfulGood(),this.speed=25,this.size=i.CharacterSize.Small,this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Halfling],this.ageRange=[20,175],this.miscBenefits=["Lucky: When you roll a 1 on an attack roll, ability check, or saving throw, you can reroll the die and must use the new roll","Brave: Vou have advantage on saving throws against being frightened","Halfling Nimbleness: You can move through the space of any creature that is of a size larger than yours"],this.subRace==h.Lightfoot&&(this.abilityModifiers.push([s.AbilityKind.Charisma,1]),this.miscBenefits.push("Naturally Stealthy: You can attempt to hide even when you are obscured only by a creature that is at least one size larger than you")),this.subRace==h.Stout&&(this.abilityModifiers.push([s.AbilityKind.Constitution,1]),this.miscBenefits.push("Stout Resilience: You have advantage on saving throws against poison, and you have resistance against poison damage"))}humanCtor(){this.abilityModifiers=[[s.AbilityKind.Strength,1],[s.AbilityKind.Dexterity,1],[s.AbilityKind.Constitution,1],[s.AbilityKind.Intelligence,1],[s.AbilityKind.Wisdom,1],[s.AbilityKind.Charisma,1]],this.ageRange=[16,90],this.preferredAlignment=i.Alignment.TrueNeutral(),this.heightRange=[new i.Height(5,0),new i.Height(7,0)],this.avgWeight=150,this.speed=30,this.languages=[i.NormalLanguage.Common],this.bonusLanguages=1}dragonbornCtor(){let e,t,n;switch(this.abilityModifiers=[[s.AbilityKind.Strength,2]],this.ageRange=[15,80],this.preferredAlignment=i.Alignment.NeutralGood(),this.heightRange=[new i.Height(6,0),new i.Height(9,0)],this.avgWeight=250,this.size=i.CharacterSize.Medium,this.speed=30,this.subRace){case f.Black:case f.Copper:t=new r.Range(30),this.damageResistance=e=i.WeaponDamageKind.Acid,n="Dex save";break;case f.Blue:case f.Bronze:t=new r.Range(30),this.damageResistance=e=i.WeaponDamageKind.Lightening,n="Dex save";break;case f.Brass:case f.Gold:case f.Red:t=this.subRace==f.Brass?new r.Range(30):new r.Range(15),this.damageResistance=e=i.WeaponDamageKind.Fire,n="Dex save";break;case f.Green:t=new r.Range(15),this.damageResistance=e=i.WeaponDamageKind.Poison,n="Con save";break;case f.Silver:case f.White:t=new r.Range(15),this.damageResistance=e=i.WeaponDamageKind.Cold,n="Con save"}this.naturalWeapons.push(new i.Weapon("Breath Weapon",i.WeaponType.Melee,i.WeaponKind.Natural,e,null,null,[2,6],t,0,null,!1,n)),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Draconic]}gnomeCtor(){this.abilityModifiers=[[s.AbilityKind.Intelligence,2]],"Forest"==this.subRace&&this.abilityModifiers.push([s.AbilityKind.Dexterity,1]),"Rock"==this.subRace&&this.abilityModifiers.push([s.AbilityKind.Constitution,1]),this.ageRange=[17,500],this.preferredAlignment=i.Alignment.NeutralGood(),this.heightRange=[new i.Height(3,0),new i.Height(4,0)],this.avgWeight=40,this.size=i.CharacterSize.Small,this.speed=25,this.darkVision=new r.Range(60),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Gnomish],this.miscBenefits=["Gnome Cunning: You have advantage on all Int, Wis, & Cha saving throws against magic"],this.subRace==d.Forest&&this.miscBenefits.push("Natural Illusionist: You know the minor illusion Cantrip. Intelligence is your spell casting ability","Speak with Small Beasts: You can communicate with small or smaller beasts"),this.subRace==d.Rock&&(this.toolProfs=[a.ArtisanTools.Tinker],this.miscBenefits.push("Artificer's Lore: Whenever you make an Intelligence (History) check related to magic items, alchemical objects, ar technological devices, you can add twice your proficiency bonus, instead of any proficiency bonus you normally appIy","Tinker: You can create 1 clockwork device (AC5, 1hp) it takes 1 hour and 10 gp. \nClockwork Toy: animal, monster or person (i.e. mouse, dragon, soldier). It moves 5 feet each turn and makes noises appropriate to the creature it represents\nFire Starter: A lighter\nMusic Box: When opened it plays a single song an moderate volume, stops when song ends/is closed\n"))}halfElfCtor(){this.abilityModifiers=[[s.AbilityKind.Charisma,2]],this.ageRange=[20,180],this.preferredAlignment=i.Alignment.ChaoticGood(),this.heightRange=[new i.Height(5,0),new i.Height(6,0)],this.avgWeight=160,this.size=i.CharacterSize.Medium,this.speed=25,this.darkVision=new r.Range(60),this.bonusLanguages=1,this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Elvish],this.miscBenefits=["Skill Versatility: You gain proficiency in two skills of your choice","Fey Ancestry: Advantage against being charmed and magic cannot be put to sleep"]}halfOrcCtor(){this.abilityModifiers=[[s.AbilityKind.Strength,2],[s.AbilityKind.Constitution,1]],this.ageRange=[14,75],this.preferredAlignment=i.Alignment.ChaoticGood(),this.heightRange=[new i.Height(5,0),new i.Height(8,0)],this.avgWeight=200,this.size=i.CharacterSize.Medium,this.speed=30,this.darkVision=new r.Range(60),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Orc],this.miscBenefits=["Menacing: You gain proficiency in the Intimidation skill","Savage Attacks: When you score a critical hit with a melee weapon attack you add 1 hit die to the damage role as bonus damage"]}tieflingCtor(){this.abilityModifiers=[[s.AbilityKind.Intelligence,1],[s.AbilityKind.Charisma,2]],this.ageRange=[16,120],this.preferredAlignment=i.Alignment.ChaoticEvil(),this.heightRange=[new i.Height(5,0),new i.Height(7,0)],this.avgWeight=160,this.speed=30,this.darkVision=new r.Range(60),this.damageResistance=i.WeaponDamageKind.Fire,this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Infernal],this.miscBenefits=["Infernal Legacy: You know the thaumaturgy cantrip. Once you reach 3rd level, you can cast the hellish rebuke spell once per day as a 2nd-level spell. Once you reach 5th level, you can also cast the darkness spell once per day. Charisma is your spell casting ability for these spells."]}checkSubRace(e){if((e==d.Rock||e==d.Forest)&&this.name!=l.Gnome||(e==u.Drow||e==u.High||e==u.Wood)&&this.name!=l.Elf||(e==c.Hill||e==c.Mountain)&&this.name!=l.Dwarf||(e==h.Lightfoot||e==h.Stout)&&this.name!=l.Halfling||(e==f.Black||e==f.Blue||e==f.Brass||e==f.Bronze||e==f.Copper||e==f.Gold||e==f.Green||e==f.Red||e==f.Silver||e==f.White)&&this.name!=l.Dragonborn)throw new Error(`Subrace ${e} isn't compatible with ${this.name}`);if(!e&&this.name==l.Dragonborn)throw new Error("Dragonborn must pick an ancestry")}static fromJson(e){return new o(e.name,e.subRace)}}var l,c,u,h,d,f;t.Race=o,function(e){e.Dwarf="Dwarf",e.Elf="Elf",e.Halfling="Halfling",e.Human="Human",e.Dragonborn="Dragonborn",e.Gnome="Gnome",e.HalfElf="Half-Elf",e.HalfOrc="Half-Orc",e.Tiefling="Tiefling"}(l=t.RaceKind||(t.RaceKind={})),function(e){e.Hill="Hill",e.Mountain="Mountain"}(c=t.Dwarf||(t.Dwarf={})),function(e){e.Drow="Drow",e.Wood="Wood",e.High="High"}(u=t.Elf||(t.Elf={})),function(e){e.Stout="Stout",e.Lightfoot="Lightfoot"}(h=t.Halfling||(t.Halfling={})),function(e){e.Forest="Forest",e.Rock="Rock"}(d=t.Gnome||(t.Gnome={})),function(e){e.Black="Black",e.Blue="Blue",e.Brass="Brass",e.Bronze="Bronze",e.Copper="Copper",e.Gold="Gold",e.Green="Green",e.Red="Red",e.Silver="Silver",e.White="White"}(f=t.Dragon||(t.Dragon={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),r=n(10),s=Object.getOwnPropertyNames(r.GamingSet).map(e=>r.GamingSet[e]),a=Object.getOwnPropertyNames(r.Instrument).map(e=>r.Instrument[e]),o=Object.getOwnPropertyNames(r.ArtisanTools).map(e=>r.ArtisanTools[e]),l=Object.getOwnPropertyNames(r.Mount).map(e=>r.Mount[e]).concat(Object.getOwnPropertyNames(r.Vehicle).map(e=>r.Vehicle[e])).concat(Object.getOwnPropertyNames(r.Boat).map(e=>r.Boat[e]));class c{constructor(e,t=[],n=[],i=[],r=[]){this.kind=e,this.skills=t,this.languages=n,this.toolProficiencies=i,this.toolOptions=r}static Acolyte(){return new c(u.Acolyte,[i.SkillKind.Insight,i.SkillKind.Religion],[null,null],[],[])}static Charlatan(){return new c(u.Charlatan,[i.SkillKind.Deception,i.SkillKind.SleightOfHand],[],[r.MiscTools.Disguise,r.MiscTools.Forgery])}static Criminal(){return new c(u.Criminal,[i.SkillKind.Deception,i.SkillKind.Stealth],[],[r.MiscTools.Thieves,null],[null,s])}static Entertainer(){return new c(u.Entertainer,[i.SkillKind.Acrobatics,i.SkillKind.Performance],[],[r.MiscTools.Disguise,null],[null,a])}static FolkHero(){return new c(u.FolkHero,[i.SkillKind.AnimalHandling,i.SkillKind.Survival],[],[null,null],[o,l])}static GuildArtisan(){return new c(u.GuildArtisan,[i.SkillKind.Insight,i.SkillKind.Persuasion],[null],[null],[o])}static Hermit(){return new c(u.Hermit,[i.SkillKind.Medicine,i.SkillKind.Religion],[null],[r.MiscTools.Herbalism],[])}static Noble(){return new c(u.Noble,[i.SkillKind.History,i.SkillKind.Persuasion],[null],[null],[s])}static Outlander(){return new c(u.Outlander,[i.SkillKind.Athletics,i.SkillKind.Survival],[null],[null],[a])}static Sage(){return new c(u.Sage,[i.SkillKind.Arcana,i.SkillKind.History],[null,null],[],[])}static Sailor(){return new c(u.Sailor,[i.SkillKind.Athletics,i.SkillKind.Perception],[],[r.MiscTools.Navigator,null],[null,Object.getOwnPropertyNames(r.Boat).map(e=>r.Boat[e])])}static Soldier(){return new c(u.Soldier,[i.SkillKind.Athletics,i.SkillKind.Intimidation],[],[null,null],[s,Object.getOwnPropertyNames(r.Vehicle).map(e=>r.Vehicle[e])])}static Urchin(){return new c(u.Urchin,[i.SkillKind.SleightOfHand,i.SkillKind.Stealth],[],[r.MiscTools.Disguise,r.MiscTools.Thieves],[])}static fromJson(e){return new c(e.kind,e.skills,e.languages,e.toolProficiencies,e.toolOptions)}}var u;t.Background=c,function(e){e.Acolyte="Acolyte",e.Charlatan="Charlatan",e.Criminal="Criminal",e.Entertainer="Entertainer",e.FolkHero="Folk Hero",e.GuildArtisan="Guild Artisan",e.Hermit="Hermit",e.Noble="Noble",e.Outlander="Outlander",e.Sage="Sage",e.Sailor="Sailor",e.Soldier="Soldier",e.Urchin="Urchin"}(u=t.BackgroundKind||(t.BackgroundKind={})),t.ACOLYTE_TRAITS=["I idolize a particular hero of my faith, and constantly refer to that person's deeds and example,","I can find common ground between lhe fiercest enemies, empathizing with them and always working toward peace.","I see omens in every event and action. The gods try to speak to us we just need lo listen","Nothing can shake my optimistic attitude.","I quote (or misquote) sacred texts and proverbs in almost every situation.","I am tolerant (or intolerant) of other faiths and respect (or condemn) the worship of other gods.","I've enjoyed fine food, drink, and high society among my temple's elite. Rough living grates on me.","I've spent so long in the tem pie that I have little practical experience dealing with people in the outside world."],t.ACOLYTE_IDEALS=["Tradition. lhe ancient traditions of worship and sacrifice must be preserved and upheld. (Lawful)","Charily. I always try to help those in need, no matter what the personal cost. (Good)","Change. We must help bring about the changes lhe gods are constantly working in the world. (Chaotic)","Power. I hope to one day rise to the top of my faith's religious hierarchy. (Lawful)","Faith. I trust that my deity will guide my actions. I have faith that if I work hard, things will go well. (Lawful)","Aspiration. I seek lo prove myself worthy of my god's favor by matching my actions against his or her teachings. (Any)"],t.ACOLYTE_BONDS=["I would die to recover an ancient relic of my faith that was lost long ago.","I will someday get revenge on the corrupt temple hierarchy who branded me a heretic.","I owe my life to the priest who took me in when my parents died.","Everything I do is for the common people.","I will do anything lo protect the tem pie where I served.","I seek to preserve a sacred text that my enemies consider heretical and seek to destroy."],t.ACOLYTE_FLAWS=["I judge others harshly, and myself even more severely.","I put roo much trust in those who wield power within my temple's hierarchy.","My piety sometimes leads me lo blindly trust those that profess faith in my god.","I am inflexible in my thinking.","I am suspicious af strangers and expect the worst of them.","Once I pick a goal, I become obsessed with it to the detriment of everything else in my life."],t.CHARLATAN_TRAITS=[],t.CHARLATAN_IDEALS=[],t.CHARLATAN_BONDS=[],t.CHARLATAN_FLAWS=[],t.ALL_BACKGROUNDS=[c.Acolyte(),c.Charlatan(),c.Criminal(),c.Entertainer(),c.FolkHero(),c.GuildArtisan(),c.Hermit(),c.Noble(),c.Outlander(),c.Sage(),c.Sailor(),c.Soldier(),c.Urchin()]},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t=null){this.first=e,this.second=t}metaString(){return this.second?`${this.first}/${this.second}`:this.first.toString()}static fromJson(e){return e?new i(e.first||0,e.second):null}}t.Range=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Alchemist="Alchemist's Supplies",e.Brewer="Brewer's Supplies ",e.Calligrapher="Calligrapher's Supplies ",e.Carpenter="Carpenter's Tools",e.Cartographer="Cartographer's Tools",e.Cobbler="Cobbler's Tools",e.Cook="Cook's Utensils ",e.Glassblower="Glassblower's Tools",e.Jeweler="Jeweler's Tools",e.Leatherworker="Leatherworker's Tools",e.Mason="Mason's Tools",e.Painter="Painter's Supplies",e.Potter="Potter's Tools",e.Smith="Smith's Tools",e.Tinker="Tinker's Tools",e.Weaver="Weaver's Tools",e.Woodcarver="Woodcarver's Tools"}(t.ArtisanTools||(t.ArtisanTools={})),function(e){e.Dice="Dice Set",e.Dragonchess="Dragonchess Set",e.PlayingCards="Playing Card Set",e.ThreeDragonAnte="Three-Dragon Ante Set"}(t.GamingSet||(t.GamingSet={})),function(e){e.Bagpipes="Bagpipes",e.Drum="Drum",e.Dulcimer="Dulcimer",e.Flute="Flute",e.Lute="Lute ",e.Lyre="Lyre",e.Horn="Horn",e.Pan="Pan Flute",e.Shawm="Shawm",e.Viol="Viol"}(t.Instrument||(t.Instrument={})),function(e){e.Disguise="Disguise Kit",e.Forgery="Forgery Kit",e.Herbalism="Herbalism Kit",e.Navigator="Navigator's Tools",e.Poisoner="Poisoner's Kit",e.Thieves="Thieves' Tools"}(t.MiscTools||(t.MiscTools={})),function(e){e.Camel="Camel",e.Donkey="Donkey",e.Elephant="Elephant",e.DraftHorse="Horse (draft)",e.Horse="Horse (riding)",e.Mastiff="Mastiff",e.Pony="Pony",e.Warhorse="Warhorse"}(t.Mount||(t.Mount={})),function(e){e.Carriage="Carriage",e.Cart="Cart",e.Chariot="Chariot",e.Sled="Sled",e.Wagon="Wagon"}(t.Vehicle||(t.Vehicle={})),function(e){e.Galley="Galley",e.Keelboat="Keelboat",e.Longship="Longship",e.Rowboat="Rowboat",e.Sailing="Sailing",e.Warship="Warship"}(t.Boat||(t.Boat={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);class r{constructor(e,t,n,i,r){this.level=e,this.features=t,this.ARCHETYPE_KEY=n,this.selectedFeatures=i,r&&(this.id=r),i&&0!=i.size||(this.selectedFeatures=new Map),this.mapFeatures(t,this.selectedFeatures)}mapFeatures(e,t){for(let n of e)if(n.options&&n.options.length>0&&!t.has(n.name)){t.set(n.name,{idx:-1,minLevel:n.level});for(let e of n.options)e.features&&e.features.length>0&&this.mapFeatures(e.features,t)}}attackCount(){return 1}chooseFeatureOption(e,t){let n=this.selectedFeatures.get(e),i=Object.assign({},n,{idx:t});this.selectedFeatures.set(e,i)}remainingChoices(){let e=[];for(let[t,{idx:n,minLevel:i}]of this.selectedFeatures.entries())i<=this.level&&n<0&&e.push(this.features.find(e=>e.name==t));return e}remainingChoiceIdxs(){let e=[];for(var t=0;t<this.features.length;t++){let n=this.features[t];n.options&&n.options.length>0&&this.selectedFeatures.get(n.name).idx<0&&e.push(t)}return e}getAllAvailableFeatures(){return this.features.reduce((e,t)=>{if(t.options&&t.options.length>0){let n=this.selectedFeatures.get(t.name);if(n||(n={idx:-1,minLevel:t.level},this.selectedFeatures.set(t.name,n)),n.idx>-1)return e.push(t),e.push(...t.options[n.idx].features),e}return e.push(t),e},[])}get archetype(){if(!this.selectedFeatures.has(this.ARCHETYPE_KEY))return null;let{idx:e,minLevel:t}=this.selectedFeatures.get(this.ARCHETYPE_KEY);if(e<0||this.level<t)return null;if(this.archetypeIdx)return this.features[this.archetypeIdx].options[e].name;for(let t=0;t<this.features.length;t++){let n=this.features[t];if(n.name===this.ARCHETYPE_KEY)return this.archetypeIdx=t,n.options[e].name}return null}}t._ClassDetails=r;class s extends r{constructor(e,t,n,i){super(e,t,"Primal Path",n,i)}attackCount(){return this.level<4?super.attackCount():2}static fromJson(e){return new s(e.level,e.features,e.selectedFeatures,e.id)}}var a;t.BarbarianDetails=s,function(e){e.Berserker="Berserker",e.TotemWarrior="Totem Warrior"}(t.PrimalPath||(t.PrimalPath={})),function(e){e.Bear="Bear",e.Eagle="Eagle",e.Wolf="Wolf"}(t.Totem||(t.Totem={}));class o extends r{constructor(e,t,n=[],i=0,r,s){super(e,t,"Bard College",r,s),this.expertise=n,this.inspiration=i}attackCount(){return this.archetype===a.Valor&&this.level>5?2:super.attackCount()}static fromJson(e){return new o(e.level,e.features.map(i.ClassFeature.fromJson),e.expertise,e.inspiration,e.selectedFeatures,e.id)}}t.BardDetails=o,function(e){e.Lore="College of Lore",e.Valor="College of Valor"}(a=t.BardCollege||(t.BardCollege={}));class l extends r{constructor(e,t,n,i){super(e,t,"Divine Domain",n,i)}static fromJson(e){return new l(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.ClericDetails=l,function(e){e.Knowledge="Knowledge",e.Life="Life",e.Light="Light",e.Nature="Nature",e.Tempest="Tempest",e.Trickery="Trickery",e.War="War"}(t.ClericDomain||(t.ClericDomain={}));class c extends r{constructor(e,t,n,i){super(e,t,"Druid Circle",n,i)}static fromJson(e){return new c(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.DruidDetails=c,function(e){e.Land="Land",e.Moon="Moon"}(t.DruidCircle||(t.DruidCircle={}));class u extends r{constructor(e,t,n,i){super(e,t,"Combat Archetype",n,i)}attackCount(){return this.level<5?super.attackCount():this.level<11?2:this.level<20?3:4}static fromJson(e){return new u(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.FighterDetails=u,function(e){e.Archery="Archery",e.Defense="Defense",e.Dueling="Dueling",e.GreatWeapon="Great Weapon Fighting",e.Protection="Protection",e.TwoWeapon="Two Weapon Fighting"}(t.FighterStyle||(t.FighterStyle={})),function(e){e[e.BattleMaster=0]="BattleMaster",e[e.Champion=1]="Champion",e[e.EldrichKnight=2]="EldrichKnight"}(t.CombatArchetype||(t.CombatArchetype={})),function(e){e.CommandersStrike="Commander's Strike",e.DisarmingAttack="Disarming Attack",e.DistractingStrike="Distracting Strike",e.EvasiveFootwork="Evasive Footwork",e.FeintingAttack="Feinting Attack",e.GoadingAttack="Goading Attack",e.LungingAttack="Lunging Attack",e.ManeuveringAttack="Maneuvering Attack",e.MenacingAttack="Menacing Attack",e.Parry="Parry",e.PrecisionAttack="Precision Attack",e.PushingAttack="Pushing Attack",e.Rally="Rally",e.Riposte="Riposte",e.SweepingAttack="Sweeping Attack",e.TripAttack="Trip Attack"}(t.CombatSuperiority||(t.CombatSuperiority={}));class h extends r{constructor(e,t,n=0,i,r){super(e,t,"Monastic Tradition",i,r),this.kiPoints=n}attackCount(){return this.level<5?super.attackCount():2}static fromJson(e){return new h(e.level,e.features.map(i.ClassFeature.fromJson),e.kiPoints,e.selectedFeatures,e.id)}}t.MonkDetails=h,function(e){e.Shadow="Way of Shadow",e.OpenHand="Way of the Open Hand",e.FourElements="Way of the Four Elements",e.LongDeath="Way of the Long Death",e.SunSoul="Way of the Sun Soul"}(t.MonasticTradition||(t.MonasticTradition={}));class d extends r{constructor(e,t,n,i){super(e,t,"Paladin Oath",n,i)}attackCount(){return this.level<5?super.attackCount():2}static fromJson(e){return new d(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.PaladinDetails=d,function(e){e.Defense="Defense",e.Dueling="Dueling",e.GreatWeapon="Great Weapon Fighting",e.Protection="Protection"}(t.PaladinStyle||(t.PaladinStyle={})),function(e){e.Ancients="Ancients",e.Devotion="Devotion",e.Vengeance="Vengeance",e.Oathbreaker="Oathbreaker"}(t.PaladinOath||(t.PaladinOath={}));class f extends r{constructor(e,t,n,i){super(e,t,"Ranger Archetype",n,i)}attackCount(){return this.level<5?super.attackCount():2}static fromJson(e){return new f(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.RangerDetails=f,function(e){e.Aberration="Aberration",e.Beast="Beast",e.Celestial="Celestial",e.Construct="Construct",e.Dragon="Dragon",e.Elemental="Elemental",e.Fey="Fey",e.Fiend="Fiend",e.Giant="Giant",e.Monstrosity="Monstrosity",e.Ooze="Ooze",e.Plant="Plant",e.Undead="Undead"}(t.RangerEnemy||(t.RangerEnemy={})),function(e){e.Archery="Archery",e.Defense="Defense",e.Dueling="Dueling",e.TwoWeapon="Two-Weapon Fighting"}(t.RangerStyle||(t.RangerStyle={})),function(e){e.Hunter="Hunter",e.BeastMaster="Beast Master"}(t.RangerArchetype||(t.RangerArchetype={}));class p extends r{constructor(e,t,n=[],i=[],r,s){super(e,t,"Roguish Archetype",r,s),this.expertise=n,this.bonusAbilityScore=i}static fromJson(e){return new p(e.level,e.features.map(i.ClassFeature.fromJson),e.expertise,e.bonusAbilityScore,e.selectedFeatures,e.id)}}t.RogueDetails=p;class m extends r{constructor(e,t,n=0,i,r){super(e,t,"Sorcerous Origin",i,r),this.sorcererPoints=n}static fromJson(e){return new m(e.level,e.features.map(i.ClassFeature.fromJson),e.sorcererPoints,e.selectedFeatures,e.id)}}t.SorcererDetails=m,function(e){e.Carful="Carful",e.Distant="Distant",e.Empowered="Empowered",e.Extended="Extended",e.Heightened="Heightened",e.Quickened="Quickened",e.Subtle="Subtle",e.Twinned="Twinned"}(t.MetaMagic||(t.MetaMagic={})),function(e){e.DraconicAncestor="DraconicAncestor",e.Wild="Wild"}(t.SorcererOrigins||(t.SorcererOrigins={}));class g extends r{constructor(e,t,n,i){super(e,t,"Otherworldly Patron",n,i)}static fromJson(e){return new g(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.WarlockDetails=g;t.EldritchIncantation=class{constructor(e,t,n){this.name=e,this.prerequisite=t,this.desc=n}},function(e){e.ArmorOfShadows="Armor of Shadows",e.BeastSpeech="Beast Speech",e.BeguilingInfluence="Beguiling Influence",e.BookOfAncientSecrets="Book of Ancient Secrets",e.DevilsSight="Devil's Sight",e.EldritchSight="Eldritch Sight",e.EldritchSpear="Eldritch Spear",e.EyesOfTheRuneKeeper="Eyes of the Rune Keeper",e.FiendishVigor="Fiendish Vigor",e.GazeOfTwoMinds="Gaze of Two Minds",e.MaskOfManyFaces="Mask of Many Faces",e.MistyVisions="Misty Visions",e.RepellingBlast="Repelling Blast",e.ThiefOfFiveFates="Thief of Five Fates",e.VoiceOfTheChainMaster="Voice of the Chain Master"}(t.EldrichIncantationName||(t.EldrichIncantationName={})),function(e){e[e.ArchFey=0]="ArchFey",e[e.Fiend=1]="Fiend",e[e.GreatOldOne=2]="GreatOldOne"}(t.OtherworldlyPatron||(t.OtherworldlyPatron={}));class y extends r{constructor(e,t,n,i){super(e,t,"Arcane Tradition",n,i)}static fromJson(e){return new y(e.level,e.features.map(i.ClassFeature.fromJson),e.selectedFeatures,e.id)}}t.WizardDetails=y,function(e){e.Abjuration="Abjuration",e.Conjuration="Conjuration",e.Divination="Divination",e.Enchantment="Enchantment",e.Evocation="Evocation",e.Illusion="Illusion",e.Necromancy="Necromancy",e.Transmutation="Transmutation"}(t.ArcaneTradition||(t.ArcaneTradition={})),function(e){e.Thief="Thief",e.Assassin="Assassin",e.ArcaneTrickster="Arcane Trickster"}(t.RoguishArchetype||(t.RoguishArchetype={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(13);class r{constructor(e=[],t=[],n=0,i=0,r=[]){this.spellSlots=e,this.currentSlots=t,this.cantripCount=n,this.spellCount=i,this._knownSpells=r,this._highest=0,this.knownSet=new Set(r.map(e=>e.name))}resetSpells(){this.currentSlots=this.spellSlots.map(e=>e)}useSlot(e){let t=this.currentSlots[e];if(!t)throw new Error("Attempted to use unusable spell slot");this.currentSlots[e]=Math.max(0,t-1)}addSpell(e){this._knownSpells.push(e),this.knownSet.add(e.name)}removeSpell(e){let t=this._knownSpells.findIndex(t=>t.name===e);t<0||(this._knownSpells.splice(t,1),this.knownSet.delete(e))}get knownSpells(){return this._knownSpells.reduce((e,t)=>{return e[t.level]?e[t.level].push(t):e[t.level]=[t],e},[])}set knownSpells(e){this.setRawSpells(e.reduce((e,t)=>e.concat(t),[]))}setRawSpells(e){this._knownSpells=e,this.knownSet=new Set(this._knownSpells.map(e=>e.name))}has(e){return this.knownSet.has(e)}static fromJson(e){if(e)return new r(e.spellSlots,e.currentSlots,e.cantripCount,e.spellCount,(e._knownSpells||[]).map(i.Spell.fromJson))}}t.CasterInfo=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=[]){this.spells=e}map(e){return this.spells.map(e)}static fromJson(e){return new i(e.spells.map(r.fromJson))}}t.Spells=i,function(e){e.AcidSplash="Acid Splash",e.BladeWard="Blade Ward",e.ChillTouch="Chill Touch",e.DancingLights="Dancing Lights",e.Druidcraft="Druidcraft",e.EldritchBlast="Eldritch Blast",e.FireBolt="Fire Bolt",e.Friends="Friends",e.Guidance="Guidance",e.Light="Light",e.MageHand="Mage Hand",e.Mending="Mending",e.Message="Message",e.MinorIllusion="Minor Illusion",e.PoisonSpray="Poison Spray",e.Prestidigitation="Prestidigitation",e.ProduceFlame="Produce Flame",e.RayOfFrost="Ray of Frost",e.Resistance="Resistance",e.SacredFlame="Sacred Flame",e.Shillelagh="Shillelagh",e.ShockingGrasp="Shocking Grasp",e.SpareTheDying="Spare the Dying",e.Thaumaturgy="Thaumaturgy",e.ThornWhip="Thorn Whip",e.TrueStrike="True Strike",e.ViciousMockery="Vicious Mockery",e.Alarm="Alarm",e.AnimalFriendship="Animal Friendship",e.ArmorOfAgathys="Armor of Agathys",e.ArmsOfHadar="Arms of Hadar",e.Bane="Bane",e.Bless="Bless",e.BurningHands="Burning Hands",e.CharmPerson="Charm Person",e.ChromaticOrb="Chromatic Orb",e.ColorSpray="Color Spray",e.Command="Command",e.CompelledDuel="Compelled Duel",e.ComprehendLanguages="Comprehend Languages",e.CreateOrDestroyWater="Create or Destroy Water",e.CureWounds="Cure Wounds",e.DetectEvilAndGood="Detect Evil and Good",e.DetectMagic="Detect Magic",e.DetectPoisonAndDisease="Detect Poison and Disease",e.DisguiseSelf="Disguise Self",e.DissonantWhispers="Dissonant Whispers",e.DivineFavor="Divine Favor",e.EnsnaringStrike="Ensnaring Strike",e.Entangle="Entangle",e.ExpeditiousRetreat="Expeditious Retreat",e.FaerieFire="Faerie Fire",e.FalseLife="False Life",e.FeatherFall="Feather Fall",e.FindFamiliar="Find Familiar",e.FogCloud="Fog Cloud",e.Goodberry="Goodberry",e.Grease="Grease",e.GuidingBolt="Guiding Bolt",e.HailOfThorns="Hail of Thorns",e.HealingWord="Healing Word",e.HellishRebuke="Hellish Rebuke",e.Heroism="Heroism",e.Hex="Hex",e.HuntersMark="Hunter's Mark",e.Identify="Identify",e.IllusoryScript="Illusory Script",e.InflictWounds="Inflict Wounds",e.Jump="Jump",e.Longstrider="Longstrider",e.MageArmor="Mage Armor",e.MagicMissile="Magic Missile",e.ProtectionFromEvilAndGood="Protection from Evil and Good",e.PurifyFoodAndDrink="Purify Food and Drink",e.RayOfSickness="Ray of Sickness",e.Sanctuary="Sanctuary",e.SearingSmite="Searing Smite",e.Shield="Shield",e.ShieldOfFaith="Shield of Faith",e.SilentImage="Silent Image",e.Sleep="Sleep",e.SpeakWithAnimals="Speak with Animals",e.TashasHideousLaughter="Tasha's Hideous Laughter",e.TensersFloatingDisk="Tenser's Floating Disk",e.ThunderousSmite="Thunderous Smite",e.Thunderwave="Thunderwave",e.UnseenServant="Unseen Servant",e.WitchBolt="Witch Bolt",e.WrathfulSmite="Wrathful Smite",e.Aid="Aid",e.AlterSelf="Alter Self",e.AnimalMessenger="Animal Messenger",e.ArcaneLock="Arcane Lock",e.Augury="Augury",e.Barkskin="Barkskin",e.BeastSense="Beast Sense",e.BlindnessDeafness="Blindness/Deafness",e.Blur="Blur",e.BrandingSmite="Branding Smite",e.CalmEmotions="Calm Emotions",e.CloudOfDaggers="Cloud of Daggers",e.ContinualFlame="Continual Flame",e.CordonOfArrows="Cordon of Arrows",e.CrownOfMadness="Crown of Madness",e.Darkness="Darkness",e.Darkvision="Darkvision",e.DetectThoughts="Detect Thoughts",e.EnhanceAbility="Enhance Ability",e.EnlargeReduce="Enlarge/Reduce",e.Enthrall="Enthrall",e.FindSteed="Find Steed",e.FindTraps="Find Traps",e.FlameBlade="Flame Blade",e.FlamingSphere="Flaming Sphere",e.GentleRepose="Gentle Repose",e.GustOfWind="Gust of Wind",e.HeatMetal="Heat Metal",e.HoldPerson="Hold Person",e.Invisibility="Invisibility",e.Knock="Knock",e.LesserRestoration="Lesser Restoration",e.Levitate="Levitate",e.LocateAnimalsOrPlants="Locate Animals or Plants",e.LocateObject="Locate Object",e.MagicMouth="Magic Mouth",e.MagicWeapon="Magic Weapon",e.MelfsAcidArrow="Melf's Acid Arrow",e.MirrorImage="Mirror Image",e.MistyStep="Misty Step",e.Moonbeam="Moonbeam",e.NystulsMagicAura="Nystul's Magic Aura",e.PassWithoutTrace="Pass Without Trace",e.PhantasmalForce="Phantasmal Force",e.PrayerOfHealing="Prayer of Healing",e.ProtectionFromPoison="Protection from Poison",e.RayOfEnfeeblement="Ray of Enfeeblement",e.RopeTrick="Rope Trick",e.ScorchingRay="Scorching Ray",e.SeeInvisibility="See Invisibility",e.Shatter="Shatter",e.Silence="Silence",e.SpiderClimb="Spider Climb",e.SpikeGrowth="Spike Growth",e.SpiritualWeapon="Spiritual Weapon",e.Suggestion="Suggestion",e.WardingBond="Warding Bond",e.Web="Web",e.ZoneOfTruth="Zone of Truth",e.AnimateDead="Animate Dead",e.AuraOfVitality="Aura of Vitality",e.BeaconOfHope="Beacon of Hope",e.BestowCurse="Bestow Curse",e.BlindingSmite="Blinding Smite",e.Blink="Blink",e.CallLightning="Call Lightning",e.Clairvoyance="Clairvoyance",e.ConjureAnimals="Conjure Animals",e.ConjureBarrage="Conjure Barrage",e.Counterspell="Counterspell",e.CreateFoodAndWater="Create Food and Water",e.CrusadersMantle="Crusader's Mantle",e.Daylight="Daylight",e.DispelMagic="Dispel Magic",e.ElementalWeapon="Elemental Weapon",e.Fear="Fear",e.FeignDeath="Feign Death",e.Fireball="Fireball",e.Fly="Fly",e.GaseousForm="Gaseous Form",e.GlyphOfWarding="Glyph of Warding",e.Haste="Haste",e.HungerOfHadar="Hunger of Hadar",e.HypnoticPattern="Hypnotic Pattern",e.LeomundsTinyHut="Leomund's Tiny Hut",e.LightningArrow="Lightning Arrow",e.LightningBolt="Lightning Bolt",e.MagicCircle="Magic Circle",e.MajorImage="Major Image",e.MassHealingWord="Mass Healing Word",e.MeldIntoStone="Meld into Stone",e.Nondetection="Nondetection",e.PhantomSteed="Phantom Steed",e.PlantGrowth="Plant Growth",e.ProtectionFromEnergy="Protection from Energy",e.RemoveCurse="Remove Curse",e.Revivify="Revivify",e.Sending="Sending",e.SleetStorm="Sleet Storm",e.Slow="Slow",e.SpeakWithDead="Speak with Dead",e.SpeakWithPlants="Speak with Plants",e.SpiritGuardians="Spirit Guardians",e.StinkingCloud="Stinking Cloud",e.Tongues="Tongues",e.VampiricTouch="Vampiric Touch",e.WaterBreathing="Water Breathing",e.WaterWalk="Water Walk",e.WindWall="Wind Wall",e.ArcaneEye="Arcane Eye",e.AuraOfLife="Aura of Life",e.AuraOfPurity="Aura of Purity",e.Banishment="Banishment",e.Blight="Blight",e.Compulsion="Compulsion",e.Confusion="Confusion",e.ConjureMinorElementals="Conjure Minor Elementals",e.ConjureWoodlandBeings="Conjure Woodland Beings",e.ControlWater="Control Water",e.DeathWard="Death Ward",e.DimensionDoor="Dimension Door",e.Divination="Divination",e.DominateBeast="Dominate Beast",e.EvardsBlackTentacles="Evard's Black Tentacles",e.Fabricate="Fabricate",e.FireShield="Fire Shield",e.FreedomOfMovement="Freedom of Movement",e.GiantInsect="Giant Insect",e.GraspingVine="Grasping Vine",e.GreaterInvisibility="Greater Invisibility",e.GuardianOfFaith="Guardian of Faith",e.HallucinatoryTerrain="Hallucinatory Terrain",e.IceStorm="Ice Storm",e.LeomundsSecretChest="Leomund's Secret Chest",e.LocateCreature="Locate Creature",e.MordenkainensFaithfulHound="Mordenkainen's Faithful Hound",e.MordenkainensPrivateSanctum="Mordenkainen's Private Sanctum",e.OtilukesResilientSphere="Otiluke's Resilient Sphere",e.PhantasmalKiller="Phantasmal Killer",e.Polymorph="Polymorph",e.StaggeringSmite="Staggering Smite",e.StoneShape="Stone Shape",e.Stoneskin="Stoneskin",e.WallOfFire="Wall of Fire",e.AnimateObjects="Animate Objects",e.AntilifeShell="Antilife Shell",e.Awaken="Awaken",e.BanishingSmite="Banishing Smite",e.BigbysHand="Bigby's Hand",e.CircleOfPower="Circle of Power",e.Cloudkill="Cloudkill",e.Commune="Commune",e.CommuneWithNature="Commune with Nature",e.ConeOfCold="Cone of Cold",e.ConjureElemental="Conjure Elemental",e.ConjureVolley="Conjure Volley",e.ContactOtherPlane="Contact Other Plane",e.Contagion="Contagion",e.Creation="Creation",e.DestructiveWave="Destructive Wave",e.DispelEvilAndGood="Dispel Evil and Good",e.DominatePerson="Dominate Person",e.Dream="Dream",e.FlameStrike="Flame Strike",e.Geas="Geas",e.GreaterRestoration="Greater Restoration",e.Hallow="Hallow",e.HoldMonster="Hold Monster",e.InsectPlague="Insect Plague",e.LegendLore="Legend Lore",e.MassCureWounds="Mass Cure Wounds",e.Mislead="Mislead",e.ModifyMemory="Modify Memory",e.Passwall="Passwall",e.PlanarBinding="Planar Binding",e.RaiseDead="Raise Dead",e.RarysTelepathicBond="Rary's Telepathic Bond",e.Reincarnate="Reincarnate",e.Scrying="Scrying",e.Seeming="Seeming",e.SwiftQuiver="Swift Quiver",e.Telekinesis="Telekinesis",e.TeleportationCircle="Teleportation Circle",e.TreeStride="Tree Stride",e.WallOfForce="Wall of Force",e.WallOfStone="Wall of Stone",e.ArcaneGate="Arcane Gate",e.BladeBarrier="Blade Barrier",e.ChainLightning="Chain Lightning",e.CircleOfDeath="Circle of Death",e.ConjureFey="Conjure Fey",e.Contingency="Contingency",e.CreateUndead="Create Undead",e.Disintegrate="Disintegrate",e.DrawmijsInstantSummon="Drawmij's Instant Summon",e.Eyebite="Eyebite",e.FindThePath="Find the Path",e.FleshToStone="Flesh to Stone",e.Forbiddance="Forbiddance",e.GlobeOfInvulnerability="Globe of Invulnerability",e.GuardsAndWards="Guards and Wards",e.Harm="Harm",e.Heal="Heal",e.HeroesFeast="Heroes' Feast",e.MagicJar="Magic Jar",e.MassSuggestion="Mass Suggestion",e.MoveEarth="Move Earth",e.OtilukesFreezingSphere="Otiluke's Freezing Sphere",e.OttosIrresistibleDance="Otto's Irresistible Dance",e.PlanarAlly="Planar Ally",e.ProgrammedIllusion="Programmed Illusion",e.Sunbeam="Sunbeam",e.TransportViaPlants="Transport via Plants",e.TrueSeeing="True Seeing",e.WallOfIce="Wall of Ice",e.WallOfThorns="Wall of Thorns",e.WindWalk="Wind Walk",e.WordOfRecall="Word of Recall",e.ConjureCelestial="Conjure Celestial",e.DelayedBlastFireball="Delayed Blast Fireball",e.DivineWord="Divine Word",e.Etherealness="Etherealness",e.FingerOfDeath="Finger of Death",e.FireStorm="Fire Storm",e.Forcecage="Forcecage",e.MirageArcane="Mirage Arcane",e.MordenkainensMagnificentMansion="Mordenkainen's Magnificent Mansion",e.MordenkainensSword="Mordenkainen's Sword",e.PlaneShift="Plane Shift",e.PrismaticSpray="Prismatic Spray",e.ProjectImage="Project Image",e.Regenerate="Regenerate",e.Resurrection="Resurrection",e.ReverseGravity="Reverse Gravity",e.Sequester="Sequester",e.Simulacrum="Simulacrum",e.Symbol="Symbol",e.Teleport="Teleport",e.AnimalShapes="Animal Shapes",e.AntimagicField="Antimagic Field",e.AntipathySympathy="Antipathy/Sympathy",e.Clone="Clone",e.ControlWeather="Control Weather",e.Demiplane="Demiplane",e.DominateMonster="Dominate Monster",e.Earthquake="Earthquake",e.Feeblemind="Feeblemind",e.Glibness="Glibness",e.HolyAura="Holy Aura",e.IncendiaryCloud="Incendiary Cloud",e.Maze="Maze",e.MindBlank="Mind Blank",e.PowerWordStun="Power Word Stun",e.Sunburst="Sunburst",e.Telepathy="Telepathy",e.Tsunami="Tsunami",e.AstralProjection="Astral Projection",e.Foresight="Foresight",e.Gate="Gate",e.Imprisonment="Imprisonment",e.MassHeal="Mass Heal",e.MeteorSwarm="Meteor Swarm",e.PowerWordHeal="Power Word Heal",e.PowerWordKill="Power Word Kill",e.PrismaticWall="Prismatic Wall",e.Shapechange="Shapechange",e.StormOfVengeance="Storm of Vengeance",e.TimeStop="Time Stop",e.TruePolymorph="True Polymorph",e.TrueResurrection="True Resurrection",e.Weird="Weird",e.Wish="Wish"}(t.SpellName||(t.SpellName={}));class r{constructor(e,t,n,i,r,s,a,o,l,c){this.name=e,this.level=t,this.verbalRequirement=n,this.somaticRequirement=i,this.materialRequirement=r,this.castingTime=s,this.desc=a,this.duration=o,this.range=l,this.save=c}static fromJson(e){let t=new r(e.name,e.level,e.verbalRequirement,e.somaticRequirement,e.materialRequirement,e.castingTime,e.desc,e.duration,e.range,s.fromJson(e.save));return t.id=e.id,t}}t.Spell=r;class s{constructor(e,t,n,i){this.ability=e,this.toBeat=t,this.ifBeaten=n,this.ifLost=i}static fromJson(e){if(e)return new s(e.ability,e.toBeat,e.ifBeaten,e.ifLost)}}t.SpellSave=s},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,o)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),s=n(1),a=n(9),o=n(0),l=n(6),c=n(3),u=n(7);function h(e,t,n,r){return i(this,void 0,void 0,function*(){let i={classKind:t,name:n.name,level:n.level,shortDesc:n.shortDesc,longDesc:n.longDesc};n.levelValues&&(i.levelValues=n.levelValues),r&&(i.optionId=r);let s=yield e.classFeatures.put(i);if(n.options)for(let i of n.options){let n={featId:s,name:i.name,shortDesc:i.shortDesc,longDesc:i.longDesc},r=yield e.classFeatureOptions.put(n);if(i.features)for(let n of i.features)yield h(e,t,n,r)}})}function d(e){return i(this,void 0,void 0,function*(){if(!e)return;let t=[{kind:c.ClassKind.Bard,items:[{slots:[2],cantrips:2,spells:4},{slots:[3],cantrips:2,spells:5},{slots:[4,2],cantrips:2,spells:6},{slots:[4,3],cantrips:3,spells:7},{slots:[4,3,2],cantrips:3,spells:8},{slots:[4,3,3],cantrips:3,spells:9},{slots:[4,3,3,1],cantrips:3,spells:10},{slots:[4,3,3,2],cantrips:3,spells:11},{slots:[4,3,3,3,1],cantrips:3,spells:12},{slots:[4,3,3,3,2],cantrips:4,spells:14},{slots:[4,3,3,3,2],cantrips:4,spells:15},{slots:[4,3,3,3,2,1],cantrips:4,spells:15},{slots:[4,3,3,3,2,1,1],cantrips:4,spells:16},{slots:[4,3,3,3,2,1,1],cantrips:4,spells:18},{slots:[4,3,3,3,2,1,1,1],cantrips:4,spells:19},{slots:[4,3,3,3,2,1,1,1],cantrips:4,spells:19},{slots:[4,3,3,3,2,1,1,1,1],cantrips:4,spells:20},{slots:[4,3,3,3,3,1,1,1,1],cantrips:4,spells:22},{slots:[4,3,3,3,3,2,1,1,1],cantrips:4,spells:22},{slots:[4,3,3,3,3,2,2,1,1],cantrips:4,spells:22}]},{kind:c.ClassKind.Cleric,items:[{slots:[2],cantrips:3},{slots:[3],cantrips:3},{slots:[4,2],cantrips:3},{slots:[4,3],cantrips:4},{slots:[4,3,2],cantrips:4},{slots:[4,3,3],cantrips:4},{slots:[4,3,3,1],cantrips:4},{slots:[4,3,3,2],cantrips:4},{slots:[4,3,3,3,1],cantrips:4},{slots:[4,3,3,3,2],cantrips:5},{slots:[4,3,3,3,2,1],cantrips:5},{slots:[4,3,3,3,2,1],cantrips:5},{slots:[4,3,3,3,2,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1,1,1],cantrips:5},{slots:[4,3,3,3,3,1,1,1,1],cantrips:5},{slots:[4,3,3,3,3,2,1,1,1],cantrips:5},{slots:[4,3,3,3,3,2,2,1,1],cantrips:5}]},{kind:c.ClassKind.Druid,items:[{slots:[2,2],cantrips:2},{slots:[2,3],cantrips:2},{slots:[2,4,2],cantrips:2},{slots:[3,4,3],cantrips:3},{slots:[3,4,3,2],cantrips:3},{slots:[3,4,3,3],cantrips:3},{slots:[3,4,3,3,1],cantrips:3},{slots:[3,4,3,3,2],cantrips:3},{slots:[3,4,3,3,3,1],cantrips:3},{slots:[4,4,3,3,3,2],cantrips:4},{slots:[4,4,3,3,3,2,1],cantrips:4},{slots:[4,4,3,3,3,2,1],cantrips:4},{slots:[4,4,3,3,3,2,1,1],cantrips:4},{slots:[4,4,3,3,3,2,1,1],cantrips:4},{slots:[4,4,3,3,3,2,1,1,1],cantrips:4},{slots:[4,4,3,3,3,2,1,1,1],cantrips:4},{slots:[4,4,3,3,3,2,1,1,1,1],cantrips:4},{slots:[4,4,3,3,3,3,1,1,1,1],cantrips:4},{slots:[4,4,3,3,3,3,2,1,1,1],cantrips:4},{slots:[4,4,3,3,3,3,2,2,1,1],cantrips:4}]},{kind:c.ClassKind.Fighter,items:[{slots:[],cantrips:0,spells:0},{slots:[],cantrips:0,spells:0},{slots:[2],cantrips:0,spells:0},{slots:[3],cantrips:0,spells:0},{slots:[3],cantrips:0,spells:0},{slots:[3],cantrips:0,spells:0},{slots:[4,2],cantrips:0,spells:0},{slots:[4,2],cantrips:0,spells:0},{slots:[4,2],cantrips:0,spells:0},{slots:[5,4,2],cantrips:0,spells:0},{slots:[6,4,2],cantrips:0,spells:0},{slots:[6,4,2],cantrips:0,spells:0},{slots:[7,4,3],cantrips:0,spells:0},{slots:[8,4,3],cantrips:0,spells:0},{slots:[9,4,3,2],cantrips:0,spells:0},{slots:[10,4,3,2],cantrips:0,spells:0},{slots:[10,4,3,2],cantrips:0,spells:0},{slots:[11,4,3,3],cantrips:0,spells:0},{slots:[11,4,3,3],cantrips:0,spells:0},{slots:[11,4,3,3],cantrips:0,spells:0},{slots:[12,4,3,3,1],cantrips:0,spells:0},{slots:[13,4,3,3,1],cantrips:0,spells:0}]},{kind:c.ClassKind.Paladin,items:[{slots:[2]},{slots:[3]},{slots:[3]},{slots:[4,2]},{slots:[4,2]},{slots:[4,3]},{slots:[4,3]},{slots:[4,3,2]},{slots:[4,3,2]},{slots:[4,3,3]},{slots:[4,3,3]},{slots:[4,3,3,1]},{slots:[4,3,3,1]},{slots:[4,3,3,2]},{slots:[4,3,3,2]},{slots:[4,3,3,3,1]},{slots:[4,3,3,3,1]},{slots:[4,3,3,3,2]},{slots:[4,3,3,3,2]}]},{kind:c.ClassKind.Ranger,items:[{slots:[],spells:0},{slots:[2],spells:2},{slots:[3],spells:3},{slots:[3],spells:3},{slots:[4,2],spells:4},{slots:[4,2],spells:4},{slots:[4,3],spells:5},{slots:[4,3],spells:5},{slots:[4,3,2],spells:6},{slots:[4,3,2],spells:6},{slots:[4,3,3],spells:7},{slots:[4,3,3],spells:7},{slots:[4,3,3,1],spells:8},{slots:[4,3,3,1],spells:8},{slots:[4,3,3,2],spells:9},{slots:[4,3,3,2],spells:9},{slots:[4,3,3,3,1],spells:10},{slots:[4,3,3,3,1],spells:10},{slots:[4,3,3,3,2],spells:11},{slots:[4,3,3,3,2],spells:11}]},{kind:c.ClassKind.Rogue,items:[{slots:[],cantrips:0,spells:0},{slots:[],cantrips:0,spells:0},{slots:[2],cantrips:3,spells:3},{slots:[3],cantrips:3,spells:4},{slots:[3],cantrips:3,spells:4},{slots:[3],cantrips:3,spells:4},{slots:[4,2],cantrips:3,spells:5},{slots:[4,2],cantrips:4,spells:6},{slots:[4,2],cantrips:4,spells:6},{slots:[4,3],cantrips:4,spells:7},{slots:[4,3],cantrips:4,spells:8},{slots:[4,3],cantrips:4,spells:8},{slots:[4,3,2],cantrips:4,spells:9},{slots:[4,3,2],cantrips:4,spells:10},{slots:[4,3,2],cantrips:4,spells:10},{slots:[4,3,3],cantrips:4,spells:11},{slots:[4,3,3],cantrips:4,spells:11},{slots:[4,3,3],cantrips:4,spells:11},{slots:[4,3,3,1],cantrips:4,spells:12},{slots:[4,3,3,1],cantrips:4,spells:13}]},{kind:c.ClassKind.Sorcerer,items:[{slots:[2],cantrips:4,spells:2},{slots:[3],cantrips:4,spells:3},{slots:[4,2],cantrips:4,spells:4},{slots:[4,3],cantrips:5,spells:5},{slots:[4,3,2],cantrips:5,spells:6},{slots:[4,3,3],cantrips:5,spells:7},{slots:[4,3,3,1],cantrips:5,spells:8},{slots:[4,3,3,2],cantrips:5,spells:9},{slots:[4,3,3,3,1],cantrips:5,spells:10},{slots:[4,3,3,3,2],cantrips:5,spells:11},{slots:[4,3,3,3,2,1],cantrips:6,spells:12},{slots:[4,3,3,3,2,1],cantrips:6,spells:12},{slots:[4,3,3,3,2,1,1],cantrips:6,spells:13},{slots:[4,3,3,3,2,1,1],cantrips:6,spells:13},{slots:[4,3,3,3,2,1,1,1],cantrips:6,spells:14},{slots:[4,3,3,3,2,1,1,1],cantrips:6,spells:14},{slots:[4,3,3,3,2,1,1,1,1],cantrips:6,spells:15},{slots:[4,3,3,3,3,1,1,1,1],cantrips:6,spells:15},{slots:[4,3,3,3,3,2,1,1,1],cantrips:6,spells:15},{slots:[4,3,3,3,3,2,2,1,1],cantrips:6,spells:15}]},{kind:c.ClassKind.Warlock,items:[{slots:[1],cantrips:2,spells:2},{slots:[2],cantrips:2,spells:3},{slots:[null,2],cantrips:2,spells:4},{slots:[null,2],cantrips:3,spells:5},{slots:[null,null,2],cantrips:3,spells:6},{slots:[null,null,2],cantrips:3,spells:7},{slots:[null,null,null,2],cantrips:3,spells:8},{slots:[null,null,null,2],cantrips:3,spells:9},{slots:[null,null,null,null,2],cantrips:3,spells:10},{slots:[null,null,null,null,2],cantrips:4,spells:10},{slots:[null,null,null,null,3],cantrips:4,spells:11},{slots:[null,null,null,null,3],cantrips:4,spells:11},{slots:[null,null,null,null,3],cantrips:4,spells:12},{slots:[null,null,null,null,3],cantrips:4,spells:12},{slots:[null,null,null,null,3],cantrips:4,spells:13},{slots:[null,null,null,null,3],cantrips:4,spells:13},{slots:[null,null,null,null,4],cantrips:4,spells:14},{slots:[null,null,null,null,4],cantrips:4,spells:14},{slots:[null,null,null,null,4],cantrips:4,spells:15},{slots:[null,null,null,null,4],cantrips:4,spells:15}]},{kind:c.ClassKind.Wizard,items:[{slots:[2],cantrips:3},{slots:[3],cantrips:3},{slots:[4,2],cantrips:3},{slots:[4,3],cantrips:4},{slots:[4,3,2],cantrips:4},{slots:[4,3,3],cantrips:4},{slots:[4,3,3,1],cantrips:4},{slots:[4,3,3,2],cantrips:4},{slots:[4,3,3,3,1],cantrips:4},{slots:[4,3,3,3,2],cantrips:5},{slots:[4,3,3,3,2,1],cantrips:5},{slots:[4,3,3,3,2,1],cantrips:5},{slots:[4,3,3,3,2,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1,1],cantrips:5},{slots:[4,3,3,3,2,1,1,1,1],cantrips:5},{slots:[4,3,3,3,3,1,1,1,1],cantrips:5},{slots:[4,3,3,3,3,2,1,1,1],cantrips:5},{slots:[4,3,3,3,3,2,2,1,1],cantrips:5}]}];for(let i of t)for(var n=0;n<i.items.length;n++){let t=i.items[n];e.add(Object.assign(t,{classKind:i.kind,level:n+1,_knownSpells:[]}))}})}t.seed=function(e,t){return i(this,void 0,void 0,function*(){let n=yield fetch(window.location.href+"spellBook.json").then(e=>e.json()).catch(e=>console.error("Error in spells",e));console.info("seeding spells"),t&&(yield e.spells.count())>0&&(yield e.spells.clear()),yield e.spells.bulkPut(n);let f=yield fetch(window.location.href+"classes.json").then(e=>e.json()).catch(e=>console.error("Error in classes",e));console.info("seeding class info"),t&&(yield Promise.all([e.classFeatures.count(),e.classFeatureOptions.count()]).then(e=>e.reduce((e,t)=>e+t,0)))>0&&(yield e.classFeatureOptions.clear(),yield e.classFeatures.clear()),yield function(e,t){return i(this,void 0,void 0,function*(){for(let n in t)for(let i of t[n].features)yield h(e,n,i)})}(e,f),console.info("seeding characters"),t&&(yield e.characters.count())>0&&e.characters.clear();let p=yield function(e){return i(this,void 0,void 0,function*(){let t=yield e.getClassDetails(c.ClassKind.Rogue,8);t.chooseFeatureOption("Roguish Archetype",2);let n=new s.Character("Daggers",new o.AbilityScores([new o.AbilityScore(8,o.AbilityKind.Strength),new o.AbilityScore(15,o.AbilityKind.Dexterity),new o.AbilityScore(10,o.AbilityKind.Constitution),new o.AbilityScore(10,o.AbilityKind.Intelligence),new o.AbilityScore(14,o.AbilityKind.Wisdom),new o.AbilityScore(14,o.AbilityKind.Charisma)]),new l.Race(l.RaceKind.Human),new c.Class(c.ClassKind.Rogue,8,t,[[o.AbilityKind.Strength,0],[o.AbilityKind.Dexterity,4],[o.AbilityKind.Constitution,0],[o.AbilityKind.Intelligence,0],[o.AbilityKind.Wisdom,0],[o.AbilityKind.Charisma,0]],[r.SkillKind.Acrobatics,r.SkillKind.Perception,r.SkillKind.Persuasion,r.SkillKind.SleightOfHand],[r.SkillKind.Stealth,r.SkillKind.SleightOfHand]),u.Background.Criminal(),s.Alignment.TrueNeutral(),34e3,new s.Height(5,8),160,"Blue",2,new s.Armor(s.LightArmor.Leather,s.ArmorWeight.Light,2),null,new r.Skills,[new s.Weapon("Dagger",s.WeaponType.Melee,s.WeaponKind.Simple,s.WeaponDamageKind.Piercing,s.WeaponWeight.Light,s.WeaponHandedness.One,[1,4],new a.Range(5),1,new a.Range(20,60),!1,!0),new s.Weapon("Short Bow",s.WeaponType.Range,s.WeaponKind.Simple,s.WeaponDamageKind.Piercing,s.WeaponWeight.Light,s.WeaponHandedness.Two,[1,6],new a.Range(80,320),1,null,!0,!1)],new s.Wealth(0,0,0,3300,0),[s.NormalLanguage.Common,s.NormalLanguage.Draconic],0,0,[new s.MagicItem("Cloak of Elvenkind","Hood up: Preception checks to see you have disadvantage, stealth checks have advantage"),new s.MagicItem("Goggles of Night","Darkvision (60 feet)")],[new s.ExpendableItem(2,"Health Pot.","heal 2d4+2 Damage")]);return[n]})}(e);yield e.characters.bulkPut(p),console.info("seeding casterInfo"),t&&(yield e.classSpellSlots.count())>0&&(yield e.classSpellSlots.clear()),yield d(e.classSpellSlots),console.info("seeding seeds"),yield e.seeds.put({when:(new Date).toISOString(),version:e.verno})})},t.seedClassSpellSlots=d},,function(e,t,n){"use strict";n.r(t),function(e,n){var i=Object.keys,r=Array.isArray,s="undefined"!=typeof self?self:"undefined"!=typeof window?window:e;function a(e,t){return"object"!=typeof t?e:(i(t).forEach(function(n){e[n]=t[n]}),e)}var o=Object.getPrototypeOf,l={}.hasOwnProperty;function c(e,t){return l.call(e,t)}function u(e,t){"function"==typeof t&&(t=t(o(e))),i(t).forEach(function(n){d(e,n,t[n])})}var h=Object.defineProperty;function d(e,t,n,i){h(e,t,a(n&&c(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function f(e){return{from:function(t){return e.prototype=Object.create(t.prototype),d(e.prototype,"constructor",e),{extend:u.bind(null,e.prototype)}}}}var p=Object.getOwnPropertyDescriptor;var m=[].slice;function g(e,t,n){return m.call(e,t,n)}function y(e,t){return t(e)}function v(e){if(!e)throw new Error("Assertion Failed")}function b(e){s.setImmediate?n(e):setTimeout(e,0)}function w(e,t){return e.reduce(function(e,n,i){var r=t(n,i);return r&&(e[r[0]]=r[1]),e},{})}function S(e,t){return function(){try{e.apply(this,arguments)}catch(e){t(e)}}}function k(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}function C(e,t){if(c(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],i=0,r=t.length;i<r;++i){var s=C(e,t[i]);n.push(s)}return n}var a=t.indexOf(".");if(-1!==a){var o=e[t.substr(0,a)];return void 0===o?void 0:C(o,t.substr(a+1))}}function A(e,t,n){if(e&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){v("string"!=typeof n&&"length"in n);for(var i=0,r=t.length;i<r;++i)A(e,t[i],n[i])}else{var s=t.indexOf(".");if(-1!==s){var a=t.substr(0,s),o=t.substr(s+1);if(""===o)void 0===n?delete e[a]:e[a]=n;else{var l=e[a];l||(l=e[a]={}),A(l,o,n)}}else void 0===n?delete e[t]:e[t]=n}}function D(e){var t={};for(var n in e)c(e,n)&&(t[n]=e[n]);return t}var K=[].concat;function P(e){return K.apply([],e)}var W="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(P([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return s[e]}).map(function(e){return s[e]});function _(e){if(!e||"object"!=typeof e)return e;var t;if(r(e)){t=[];for(var n=0,i=e.length;n<i;++n)t.push(_(e[n]))}else if(W.indexOf(e.constructor)>=0)t=e;else for(var s in t=e.constructor?Object.create(e.constructor.prototype):{},e)c(e,s)&&(t[s]=_(e[s]));return t}function F(e,t,n,r){return n=n||{},r=r||"",i(e).forEach(function(i){if(c(t,i)){var s=e[i],a=t[i];"object"==typeof s&&"object"==typeof a&&s&&a&&""+s.constructor==""+a.constructor?F(s,a,n,r+i+"."):s!==a&&(n[r+i]=t[i])}else n[r+i]=void 0}),i(t).forEach(function(i){c(e,i)||(n[r+i]=t[i])}),n}var M="undefined"!=typeof Symbol&&Symbol.iterator,T=M?function(e){var t;return null!=e&&(t=e[M])&&t.apply(e)}:function(){return null},O={};function x(e){var t,n,i,s;if(1===arguments.length){if(r(e))return e.slice();if(this===O&&"string"==typeof e)return[e];if(s=T(e)){for(n=[];!(i=s.next()).done;)n.push(i.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var I="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function B(e,t){I=e,R=t}var R=function(){return!0},E=!new Error("").stack;function H(){if(E)try{throw H.arguments,new Error}catch(e){return e}return new Error}function L(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(R).map(function(e){return"\n"+e}).join("")):""}var N=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],j=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(N),G={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function J(e,t){this._e=H(),this.name=e,this.message=t}function V(e,t,n,i){this._e=H(),this.failures=t,this.failedKeys=i,this.successCount=n}function z(e,t){this._e=H(),this.name="BulkError",this.failures=t,this.message=function(e,t){return e+". Errors: "+t.map(function(e){return e.toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}(e,t)}f(J).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+L(this._e,2))}},toString:function(){return this.name+": "+this.message}}),f(V).from(J),f(z).from(J);var q=j.reduce(function(e,t){return e[t]=t+"Error",e},{}),U=J,Y=j.reduce(function(e,t){var n=t+"Error";function i(e,i){this._e=H(),this.name=n,e?"string"==typeof e?(this.message=e,this.inner=i||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=G[t]||n,this.inner=null)}return f(i).from(U),e[t]=i,e},{});Y.Syntax=SyntaxError,Y.Type=TypeError,Y.Range=RangeError;var $=N.reduce(function(e,t){return e[t+"Error"]=Y[t],e},{});var Q=j.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Y[t]),e},{});function Z(){}function X(e){return e}function ee(e,t){return null==e||e===X?t:function(n){return t(e(n))}}function te(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ne(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var i=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?te(i,this.onsuccess):i),r&&(this.onerror=this.onerror?te(r,this.onerror):r),void 0!==s?s:n}}function ie(e,t){return e===Z?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?te(n,this.onsuccess):n),i&&(this.onerror=this.onerror?te(i,this.onerror):i)}}function re(e,t){return e===Z?t:function(n){var i=e.apply(this,arguments);a(n,i);var r=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?te(r,this.onsuccess):r),s&&(this.onerror=this.onerror?te(s,this.onerror):s),void 0===i?void 0===o?void 0:o:a(i,o)}}function se(e,t){return e===Z?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ae(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var i=this,r=arguments.length,s=new Array(r);r--;)s[r]=arguments[r];return n.then(function(){return t.apply(i,s)})}return t.apply(this,arguments)}}Q.ModifyError=V,Q.DexieError=J,Q.BulkError=z;var oe={},le=100,ce=7,ue=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(t){var e=s.Promise;return e?[e.resolve(),e.prototype,e.resolve()]:[]}}(),he=ue[0],de=ue[1],fe=ue[2],pe=de&&de.then,me=he&&he.constructor,ge=ue[3],ye=!!fe,ve=!1,be=fe?function(){fe.then(Le)}:s.setImmediate?n.bind(null,Le):s.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){Le(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Le,0)},we=function(e,t){_e.push([e,t]),ke&&(be(),ke=!1)},Se=!0,ke=!0,Ce=[],Ae=[],De=null,Ke=X,Pe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ct,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{ct(e[0],e[1])}catch(e){}})}},We=Pe,_e=[],Fe=0,Me=[];function Te(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Z,this._lib=!1;var t=this._PSD=We;if(I&&(this._stackHolder=H(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==oe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ie(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,n){try{n(function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var i=t._lib&&Ne();n&&"function"==typeof n.then?e(t,function(e,t){n instanceof Te?n._then(e,t):n.then(e,t)}):(t._state=!0,t._value=n,Be(t)),i&&je()}},Ie.bind(null,t))}catch(e){Ie(t,e)}}(this,e)}var Oe={get:function(){var e=We,t=$e;function n(n,i){var r=this,s=!e.global&&(e!==We||t!==$e);s&&et();var a=new Te(function(t,a){Re(r,new xe(at(n,e,s),at(i,e,s),t,a,e))});return I&&He(a,this),a}return n.prototype=oe,n},set:function(e){d(this,"then",e&&e.prototype===oe?Oe:{get:function(){return e},set:Oe.set})}};function xe(e,t,n,i,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i,this.psd=r}function Ie(e,t){if(Ae.push(t),null===e._state){var n=e._lib&&Ne();t=Ke(t),e._state=!1,e._value=t,I&&null!==t&&"object"==typeof t&&!t._promise&&k(function(){var n=function e(t,n){var i;return p(t,n)||(i=o(t))&&e(i,n)}(t,"stack");t._promise=e,d(t,"stack",{get:function(){return ve?n&&(n.get?n.get.apply(t):n.value):e.stack}})}),function(e){Ce.some(function(t){return t._value===e._value})||Ce.push(e)}(e),Be(e),n&&je()}}function Be(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)Re(e,t[n]);var r=e._PSD;--r.ref||r.finalize(),0===Fe&&(++Fe,we(function(){0==--Fe&&Ge()},[]))}function Re(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Fe,we(Ee,[n,e,t])}else e._listeners.push(t)}function Ee(e,t,n){try{De=t;var i,r=t._value;t._state?i=e(r):(Ae.length&&(Ae=[]),i=e(r),-1===Ae.indexOf(r)&&function(e){var t=Ce.length;for(;t;)if(Ce[--t]._value===e._value)return void Ce.splice(t,1)}(t)),n.resolve(i)}catch(e){n.reject(e)}finally{De=null,0==--Fe&&Ge(),--n.psd.ref||n.psd.finalize()}}function He(e,t){var n=t?t._numPrev+1:0;n<le&&(e._prev=t,e._numPrev=n)}function Le(){Ne()&&je()}function Ne(){var e=Se;return Se=!1,ke=!1,e}function je(){var e,t,n;do{for(;_e.length>0;)for(e=_e,_e=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}}while(_e.length>0);Se=!0,ke=!0}function Ge(){var e=Ce;Ce=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=Me.slice(0),n=t.length;n;)t[--n]()}function Je(e){return new Te(oe,!1,e)}function Ve(e,t){var n=We;return function(){var i=Ne(),r=We;try{return it(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{it(r,!1),i&&je()}}}u(Te.prototype,{then:Oe,_then:function(e,t){Re(this,new xe(null,null,e,t,We))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):Je(e)}):this.then(null,function(e){return e&&e.name===t?n(e):Je(e)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),Je(t)})},stack:{get:function(){if(this._stack)return this._stack;try{ve=!0;var e=function e(t,n,i){if(n.length===i)return n;var r="";if(!1===t._state){var s,a,o=t._value;null!=o?(s=o.name||"Error",a=o.message||o,r=L(o,0)):(s=o,a=""),n.push(s+(a?": "+a:"")+r)}I&&((r=L(t._stackHolder,2))&&-1===n.indexOf(r)&&n.push(r),t._prev&&e(t._prev,n,i));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{ve=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Te(function(i,r){var s=setTimeout(function(){return r(new Y.Timeout(t))},e);n.then(i,r).finally(clearTimeout.bind(null,s))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Te.prototype,Symbol.toStringTag,"Promise"),Pe.env=rt(),u(Te,{all:function(){var e=x.apply(null,arguments).map(tt);return new Te(function(t,n){0===e.length&&t([]);var i=e.length;e.forEach(function(r,s){return Te.resolve(r).then(function(n){e[s]=n,--i||t(e)},n)})})},resolve:function(e){if(e instanceof Te)return e;if(e&&"function"==typeof e.then)return new Te(function(t,n){e.then(t,n)});var t=new Te(oe,!0,e);return He(t,De),t},reject:Je,race:function(){var e=x.apply(null,arguments).map(tt);return new Te(function(t,n){e.map(function(e){return Te.resolve(e).then(t,n)})})},PSD:{get:function(){return We},set:function(e){return We=e}},newPSD:Ze,usePSD:st,scheduler:{get:function(){return we},set:function(e){we=e}},rejectionMapper:{get:function(){return Ke},set:function(e){Ke=e}},follow:function(e,t){return new Te(function(n,i){return Ze(function(t,n){var i=We;i.unhandleds=[],i.onunhandled=n,i.finalize=te(function(){var e=this;!function(e){Me.push(function t(){e();Me.splice(Me.indexOf(t),1)}),++Fe,we(function(){0==--Fe&&Ge()},[])}(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},i.finalize),e()},t,n,i)})}});var ze={awaits:0,echoes:0,id:0},qe=0,Ue=[],Ye=0,$e=0,Qe=0;function Ze(e,t,n,i){var r=We,s=Object.create(r);s.parent=r,s.ref=0,s.global=!1,s.id=++Qe;var o=Pe.env;s.env=ye?{Promise:Te,PromiseProp:{value:Te,configurable:!0,writable:!0},all:Te.all,race:Te.race,resolve:Te.resolve,reject:Te.reject,nthen:ot(o.nthen,s),gthen:ot(o.gthen,s)}:{},t&&a(s,t),++r.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=st(s,e,n,i);return 0===s.ref&&s.finalize(),l}function Xe(){return ze.id||(ze.id=++qe),++ze.awaits,ze.echoes+=ce,ze.id}function et(e){!ze.awaits||e&&e!==ze.id||(0==--ze.awaits&&(ze.id=0),ze.echoes=ze.awaits*ce)}function tt(e){return ze.echoes&&e&&e.constructor===me?(Xe(),e.then(function(e){return et(),e},function(e){return et(),ut(e)})):e}function nt(){var e=Ue[Ue.length-1];Ue.pop(),it(e,!1)}function it(e,t){var n,i=We;if((t?!ze.echoes||Ye++&&e===We:!Ye||--Ye&&e===We)||(n=t?function(e){++$e,ze.echoes&&0!=--ze.echoes||(ze.echoes=ze.id=0),Ue.push(We),it(e,!0)}.bind(null,e):nt,pe.call(he,n)),e!==We&&(We=e,i===Pe&&(Pe.env=rt()),ye)){var r=Pe.env.Promise,a=e.env;de.then=a.nthen,r.prototype.then=a.gthen,(i.global||e.global)&&(Object.defineProperty(s,"Promise",a.PromiseProp),r.all=a.all,r.race=a.race,r.resolve=a.resolve,r.reject=a.reject)}}function rt(){var e=s.Promise;return ye?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:e.all,race:e.race,resolve:e.resolve,reject:e.reject,nthen:de.then,gthen:e.prototype.then}:{}}function st(e,t,n,i,r){var s=We;try{return it(e,!0),t(n,i,r)}finally{it(s,!1)}}function at(e,t,n){return"function"!=typeof e?e:function(){var i=We;n&&Xe(),it(t,!0);try{return e.apply(this,arguments)}finally{it(i,!1)}}}function ot(e,t){return function(n,i){return e.call(this,at(n,t,!1),at(i,t,!1))}}var lt="unhandledrejection";function ct(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var i,r={promise:t,reason:e};if(s.document&&document.createEvent?((i=document.createEvent("Event")).initEvent(lt,!0,!0),a(i,r)):s.CustomEvent&&a(i=new CustomEvent(lt,{detail:r}),r),i&&s.dispatchEvent&&(dispatchEvent(i),!s.PromiseRejectionEvent&&s.onunhandledrejection))try{s.onunhandledrejection(i)}catch(e){}i.defaultPrevented||console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var ut=Te.reject;function ht(e){var t={},n=function(n,i){if(i){for(var r=arguments.length,s=new Array(r-1);--r;)s[r-1]=arguments[r];return t[n].subscribe.apply(null,s),e}if("string"==typeof n)return t[n]};n.addEventType=o;for(var s=1,a=arguments.length;s<a;++s)o(arguments[s]);return n;function o(e,s,a){if("object"!=typeof e){var l;s||(s=se),a||(a=Z);var c={subscribers:[],fire:a,subscribe:function(e){-1===c.subscribers.indexOf(e)&&(c.subscribers.push(e),c.fire=s(c.fire,e))},unsubscribe:function(e){c.subscribers=c.subscribers.filter(function(t){return t!==e}),c.fire=c.subscribers.reduce(s,a)}};return t[e]=n[e]=c,c}i(l=e).forEach(function(e){var t=l[e];if(r(t))o(e,l[e][0],l[e][1]);else{if("asap"!==t)throw new Y.InvalidArgument("Invalid event config");var n=o(e,X,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach(function(e){b(function(){e.apply(null,t)})})})}})}}var dt,ft=String.fromCharCode(65535),pt=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return ft}}(),mt=-1/0,gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",yt="String expected.",vt=[],bt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=bt,St=bt,kt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function Ct(e,t){var n,o,l,h,f,p=Ct.dependencies,m=a({addons:Ct.addons,autoOpen:!0,indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange},t),b=m.addons,K=m.autoOpen,W=m.indexedDB,M=m.IDBKeyRange,T=this._dbSchema={},B=[],R=[],E={},N=null,j=null,G=!1,J=null,q=!1,U="readwrite",$=this,Q=new Te(function(e){n=e}),te=new Te(function(e,t){o=t}),se=!0,oe=!!xt(W);function le(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function ce(e,t,n){var r=$._createTransaction(U,R,T);r.create(t),r._completion.catch(n);var s=r._reject.bind(r);Ze(function(){We.trans=r,0===e?(i(T).forEach(function(e){ue(t,e,T[e].primKey,T[e].indexes)}),Te.follow(function(){return $.on.populate.fire(r)}).catch(s)):function(e,t,n){var r=[],s=B.filter(function(t){return t._cfg.version===e})[0];if(!s)throw new Y.Upgrade("Dexie specification of currently installed DB version is missing");T=$._dbSchema=s._cfg.dbschema;var a=!1;return B.filter(function(t){return t._cfg.version>e}).forEach(function(e){r.push(function(){var i=T,r=e._cfg.dbschema;Oe(i,n),Oe(r,n),T=$._dbSchema=r;var s=function(e,t){var n={del:[],add:[],change:[]};for(var i in e)t[i]||n.del.push(i);for(i in t){var r=e[i],s=t[i];if(r){var a={name:i,def:s,recreate:!1,del:[],add:[],change:[]};if(r.primKey.src!==s.primKey.src)a.recreate=!0,n.change.push(a);else{var o=r.idxByName,l=s.idxByName;for(var c in o)l[c]||a.del.push(c);for(c in l){var u=o[c],h=l[c];u?u.src!==h.src&&a.change.push(h):a.add.push(h)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([i,s])}return n}(i,r);if(s.add.forEach(function(e){ue(n,e[0],e[1].primKey,e[1].indexes)}),s.change.forEach(function(e){if(e.recreate)throw new Y.Upgrade("Not yet support for changing primary key");var t=n.objectStore(e.name);e.add.forEach(function(e){he(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),he(t,e)}),e.del.forEach(function(e){t.deleteIndex(e)})}),e._cfg.contentUpgrade)return a=!0,Te.follow(function(){e._cfg.contentUpgrade(t)})}),r.push(function(t){a&&wt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var i=t.db.objectStoreNames[n];null==e[i]&&t.db.deleteObjectStore(i)}}(e._cfg.dbschema,t)})}),function e(){return r.length?Te.resolve(r.shift()(t.idbtrans)).then(e):Te.resolve()}().then(function(){!function(e,t){i(e).forEach(function(n){t.db.objectStoreNames.contains(n)||ue(t,n,e[n].primKey,e[n].indexes)})}(T,n)})}(e,r,t).catch(s)})}function ue(e,t,n,i){var r=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(e){he(r,e)}),r}function he(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function de(e,t,n){this.name=e,this.schema=t,this._tx=n,this.hook=E[e]?E[e].hook:ht(null,{creating:[ne,Z],reading:[ee,X],updating:[re,Z],deleting:[ie,Z]})}function fe(e,t,n){return(n?Wt:Kt)(function(n){e.push(n),t&&t()})}function pe(e,t,n,i,r){return new Te(function(s,a){var o=n.length,l=o-1;if(0===o)return s();if(i){var c,u=Wt(a),h=Dt(null);k(function(){for(var i=0;i<o;++i){c={onsuccess:null,onerror:null};var a=n[i];r.call(c,a[0],a[1],t);var d=e.delete(a[0]);d._hookCtx=c,d.onerror=u,d.onsuccess=i===l?Dt(s):h}},function(e){throw c.onerror&&c.onerror(e),e})}else for(var d=0;d<o;++d){var f=e.delete(n[d]);f.onerror=Kt(a),d===l&&(f.onsuccess=Ve(function(){return s()}))}})}function ye(e,t,n,i){var r=this;this.db=$,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=ht(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Te(function(e,t){r._resolve=e,r._reject=t}),this._completion.then(function(){r.active=!1,r.on.complete.fire()},function(e){var t=r.active;return r.active=!1,r.on.error.fire(e),r.parent?r.parent._reject(e):t&&r.idbtrans&&r.idbtrans.abort(),ut(e)})}function ve(e,t,n){this._ctx={table:e,index:":id"===t?null:t,or:n}}function be(e,t){var n=null,i=null;if(t)try{n=t()}catch(e){i=e}var r=e._ctx,s=r.table;this._ctx={table:s,index:r.index,isPrimKey:!r.index||s.schema.primKey.keyPath&&r.index===s.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:r.or,valueMapper:s.hook.reading.fire}}function we(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Se(e,t){return e._cfg.version-t._cfg.version}function ke(e,t,n){t.forEach(function(t){var i=n[t];e.forEach(function(e){t in e||(e===ye.prototype||e instanceof ye?d(e,t,{get:function(){return this.table(t)}}):e[t]=new de(t,i))})})}function Ce(e,t,n,i,r,s){var a=Ve(s?function(e,t,i){return n(s(e),t,i)}:n,r);e.onerror||(e.onerror=Kt(r)),e.onsuccess=S(t?function(){var n=e.result;if(n){var s=function(){n.continue()};t(n,function(e){s=e},i,r)&&a(n.value,n,function(e){s=e}),s()}else i()}:function(){var t=e.result;if(t){var n=function(){t.continue()};a(t.value,t,function(e){n=e}),n()}else i()},r)}function Ae(e,t){return W.cmp(e,t)}function De(e,t){return Ae(e,t)>0?e:t}function Ke(e,t){return W.cmp(e,t)}function Pe(e,t){return W.cmp(t,e)}function _e(e,t){return e<t?-1:e===t?0:1}function Fe(e,t){return e>t?-1:e===t?0:1}function Me(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function Oe(e,t){for(var n=t.db.objectStoreNames,i=0;i<n.length;++i){var r=n[i],a=t.objectStore(r);l="getAll"in a;for(var o=0;o<a.indexNames.length;++o){var c=a.indexNames[o],u=a.index(c).keyPath,h="string"==typeof u?u:"["+g(u).join("+")+"]";if(e[r]){var d=e[r].idxByName[h];d&&(d.name=c)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l=!1)}function xe(e){$.on("blocked").fire(e),vt.filter(function(e){return e.name===$.name&&e!==$&&!e._vcFired}).map(function(t){return t.on("versionchange").fire(e)})}this.version=function(e){if(N||G)throw new Y.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=B.filter(function(t){return t._cfg.version===e})[0];return t||(t=new le(e),B.push(t),B.sort(Se),se=!1,t)},a(le.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,e):e;var t={};B.forEach(function(e){a(t,e._cfg.storesSource)});var n=this._cfg.dbschema={};return this._parseStoresSpec(t,n),T=$._dbSchema=n,[E,$,ye.prototype].forEach(function(e){for(var t in e)e[t]instanceof de&&delete e[t]}),ke([E,$,ye.prototype,this._cfg.tables],i(n),n),R=i(n),this},upgrade:function(e){return this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){i(e).forEach(function(n){if(null!==e[n]){var i={},s=function(e){var t=[];return e.split(",").forEach(function(e){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;t.push(new Mt(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),r(i),/\./.test(e)))}),t}(e[n]),a=s.shift();if(a.multi)throw new Y.Schema("Primary key cannot be multi-valued");a.keyPath&&A(i,a.keyPath,a.auto?0:a.keyPath),s.forEach(function(e){if(e.auto)throw new Y.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Y.Schema("Index must have a name and cannot be an empty string");A(i,e.keyPath,e.compound?e.keyPath.map(function(){return""}):"")}),t[n]=new Tt(n,a,s,i)}})}}),this._allTables=E,this._createTransaction=function(e,t,n,i){return new ye(e,t,n,i)},this._whenReady=function(e){return q||We.letThrough?e():new Te(function(e,t){if(!G){if(!K)return void t(new Y.DatabaseClosed);$.open().catch(Z)}Q.then(e,t)}).then(e)},this.verno=0,this.open=function(){if(G||N)return Q.then(function(){return j?ut(j):$});I&&(te._stackHolder=H()),G=!0,j=null,q=!1;var t=n,r=null;return Te.race([te,new Te(function(t,n){if(!W)throw new Y.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var s=se?W.open(e):W.open(e,Math.round(10*$.verno));if(!s)throw new Y.MissingAPI("IndexedDB API not available");s.onerror=Kt(n),s.onblocked=Ve(xe),s.onupgradeneeded=Ve(function(t){if(r=s.transaction,se&&!$._allowEmptyDB){s.onerror=_t,r.abort(),s.result.close();var i=W.deleteDatabase(e);i.onsuccess=i.onerror=Ve(function(){n(new Y.NoSuchDatabase("Database "+e+" doesnt exist"))})}else{r.onerror=Kt(n),ce((t.oldVersion>Math.pow(2,62)?0:t.oldVersion)/10,r,n)}},n),s.onsuccess=Ve(function(){if(r=null,N=s.result,vt.push($),se)!function(){if($.verno=N.version/10,$._dbSchema=T={},0===(R=g(N.objectStoreNames,0)).length)return;var e=N.transaction(Ot(R),"readonly");R.forEach(function(t){for(var n=e.objectStore(t),i=n.keyPath,r=i&&"string"==typeof i&&-1!==i.indexOf("."),s=new Mt(i,i||"",!1,!1,!!n.autoIncrement,i&&"string"!=typeof i,r),a=[],o=0;o<n.indexNames.length;++o){var l=n.index(n.indexNames[o]);i=l.keyPath,r=i&&"string"==typeof i&&-1!==i.indexOf(".");var c=new Mt(l.name,i,!!l.unique,!!l.multiEntry,!1,i&&"string"!=typeof i,r);a.push(c)}T[t]=new Tt(t,s,a,{})}),ke([E],i(T),T)}();else if(N.objectStoreNames.length>0)try{Oe(T,N.transaction(Ot(N.objectStoreNames),"readonly"))}catch(e){}N.onversionchange=Ve(function(e){$._vcFired=!0,$.on("versionchange").fire(e)}),oe||"__dbnames"===e||dt.dbnames.put({name:e}).catch(Z),t()},n)})]).then(function(){return J=[],Te.resolve(Ct.vip($.on.ready.fire)).then(function e(){if(J.length>0){var t=J.reduce(ae,Z);return J=[],Te.resolve(Ct.vip(t)).then(e)}})}).finally(function(){J=null}).then(function(){return G=!1,$}).catch(function(e){try{r&&r.abort()}catch(e){}return G=!1,$.close(),ut(j=e)}).finally(function(){q=!0,t()})},this.close=function(){var e=vt.indexOf($);if(e>=0&&vt.splice(e,1),N){try{N.close()}catch(e){}N=null}K=!1,j=new Y.DatabaseClosed,G&&o(j),Q=new Te(function(e){n=e}),te=new Te(function(e,t){o=t})},this.delete=function(){var t=arguments.length>0;return new Te(function(n,i){if(t)throw new Y.InvalidArgument("Arguments not allowed in db.delete()");function r(){$.close();var t=W.deleteDatabase(e);t.onsuccess=Ve(function(){oe||dt.dbnames.delete(e).catch(Z),n()}),t.onerror=Kt(i),t.onblocked=xe}G?Q.then(r):r()})},this.backendDB=function(){return N},this.isOpen=function(){return null!==N},this.hasBeenClosed=function(){return j&&j instanceof Y.DatabaseClosed},this.hasFailed=function(){return null!==j},this.dynamicallyOpened=function(){return se},this.name=e,u(this,{tables:{get:function(){return i(E).map(function(e){return E[e]})}}}),this.on=ht(this,"populate","blocked","versionchange",{ready:[ae,Z]}),this.on.ready.subscribe=y(this.on.ready.subscribe,function(e){return function(t,n){Ct.vip(function(){q?(j||Te.resolve().then(t),n&&e(t)):J?(J.push(t),n&&e(t)):(e(t),n||e(function e(){$.on.ready.unsubscribe(t),$.on.ready.unsubscribe(e)}))})}}),this.transaction=function(){var e=function(e,t,n){var i=arguments.length;if(i<2)throw new Y.InvalidArgument("Too few arguments");var r=new Array(i-1);for(;--i;)r[i-1]=arguments[i];n=r.pop();var s=P(r);return[e,s,n]}.apply(this,arguments);return this._transaction.apply(this,e)},this._transaction=function(e,t,n){var i=We.trans;i&&i.db===$&&-1===e.indexOf("!")||(i=null);var r=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{var s=t.map(function(e){var t=e instanceof de?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t});if("r"==e||"readonly"==e)e="readonly";else{if("rw"!=e&&e!=U)throw new Y.InvalidArgument("Invalid transaction mode: "+e);e=U}if(i){if("readonly"===i.mode&&e===U){if(!r)throw new Y.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach(function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!r)throw new Y.SubTransaction("Table "+e+" not included in parent transaction.");i=null}}),r&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,n){n(e)}):ut(e)}return i?i._promise(e,a,"lock"):We.trans?st(We.transless,function(){return $._whenReady(a)}):$._whenReady(a);function a(){return Te.resolve().then(function(){var t,r=We.transless||We,a=$._createTransaction(e,s,T,i),o={trans:a,transless:r};i?a.idbtrans=i.idbtrans:a.create(),n.constructor===ge&&Xe();var l=Te.follow(function(){if(t=n.call(a,a))if(t.constructor===me){var e=et.bind(null,null);t.then(e,e)}else"function"==typeof t.next&&"function"==typeof t.throw&&(t=Ft(t))},o);return(t&&"function"==typeof t.then?Te.resolve(t).then(function(e){return a.active?e:ut(new Y.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):l.then(function(){return t})).then(function(e){return i&&a._resolve(),a._completion.then(function(){return e})}).catch(function(e){return a._reject(e),ut(e)})})}},this.table=function(e){if(!c(E,e))throw new Y.InvalidTable("Table "+e+" does not exist");return E[e]},u(de.prototype,{_trans:function(e,t,n){var i=this._tx||We.trans;return i&&i.db===$?i===We.trans?i._promise(e,t,n):Ze(function(){return i._promise(e,t,n)},{trans:i,transless:We.transless||We}):function e(t,n,i){if(q||We.letThrough){var r=$._createTransaction(t,n,T);try{r.create()}catch(e){return ut(e)}return r._promise(t,function(e,t){return Ze(function(){return We.trans=r,i(e,t,r)})}).then(function(e){return r._completion.then(function(){return e})})}if(!G){if(!K)return ut(new Y.DatabaseClosed);$.open().catch(Z)}return Q.then(function(){return e(t,n,i)})}(e,[this.name],t)},_idbstore:function(e,t,n){var i=this.name;return this._trans(e,function(e,n,r){if(-1===r.storeNames.indexOf(i))throw new Y.NotFound("Table"+i+" not part of transaction");return t(e,n,r.idbtrans.objectStore(i),r)},n)},get:function(e,t){if(e&&e.constructor===Object)return this.where(e).first(t);var n=this;return this._idbstore("readonly",function(t,i,r){var s=r.get(e);s.onerror=Kt(i),s.onsuccess=Ve(function(){t(n.hook.reading.fire(s.result))},i)}).then(t)},where:function(e){if("string"==typeof e)return new ve(this,e);if(r(e))return new ve(this,"["+e.join("+")+"]");var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){return e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})&&e.keyPath.every(function(e){return t.indexOf(e)>=0})})[0];if(n&&pt!==ft)return this.where(n.name).equals(n.keyPath.map(function(t){return e[t]}));n||console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var s=this.schema.idxByName,a=t.reduce(function(t,n){return[t[0]||s[n],t[0]||!s[n]?Me(t[1],function(t){return""+C(t,n)==""+e[n]}):t[1]]},[null,null]),o=a[0];return o?this.where(o.name).equals(e[o.keyPath]).filter(a[1]):n?this.filter(a[1]):this.where(t).equals("")},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new be(new ve(this,r(e)?"["+e.join("+")+"]":e))},toCollection:function(){return new be(new ve(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var n=Object.create(e.prototype);t&&At(n,t),this.schema.instanceTemplate=n;var i=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var i in t)if(c(t,i))try{n[i]=t[i]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),e},defineClass:function(e){return this.mapToClass(Ct.defineClass(e),e)},bulkDelete:function(e){return this.hook.deleting.fire===Z?this._idbstore(U,function(t,n,i,r){t(pe(i,r,e,!1,Z))}):this.where(":id").anyOf(e).delete().then(function(){})},bulkPut:function(e,t){var n=this;return this._idbstore(U,function(i,r,s){if(!s.keyPath&&!n.schema.primKey.auto&&!t)throw new Y.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(s.keyPath&&t)throw new Y.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();var a,o,l=function(e){0===c.length?i(e):r(new z(n.name+".bulkPut(): "+c.length+" of "+u+" operations failed",c))},c=[],u=e.length,h=n;if(n.hook.creating.fire===Z&&n.hook.updating.fire===Z){o=fe(c);for(var d=0,f=e.length;d<f;++d)(a=t?s.put(e[d],t[d]):s.put(e[d])).onerror=o;a.onerror=fe(c,l),a.onsuccess=Pt(l)}else{var p=t||s.keyPath&&e.map(function(e){return C(e,s.keyPath)}),m=p&&w(p,function(t,n){return null!=t&&[t,e[n]]});(p?h.where(":id").anyOf(p.filter(function(e){return null!=e})).modify(function(){this.value=m[this.primKey],m[this.primKey]=null}).catch(V,function(e){c=e.failures}).then(function(){for(var n=[],i=t&&[],r=p.length-1;r>=0;--r){var s=p[r];(null==s||m[s])&&(n.push(e[r]),t&&i.push(s),null!=s&&(m[s]=null))}return n.reverse(),t&&i.reverse(),h.bulkAdd(n,i)}).then(function(e){var t=p[p.length-1];return null!=t?t:e}):h.bulkAdd(e)).then(l).catch(z,function(e){c=c.concat(e.failures),l()}).catch(r)}},"locked")},bulkAdd:function(e,t){var n=this,i=this.hook.creating.fire;return this._idbstore(U,function(r,s,a,o){if(!a.keyPath&&!n.schema.primKey.auto&&!t)throw new Y.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(a.keyPath&&t)throw new Y.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new Y.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return r();function l(e){0===d.length?r(e):s(new z(n.name+".bulkAdd(): "+d.length+" of "+f+" operations failed",d))}var c,u,h,d=[],f=e.length;if(i!==Z){var p,m=a.keyPath;u=fe(d,null,!0),h=Dt(null),k(function(){for(var n=0,r=e.length;n<r;++n){p={onerror:null,onsuccess:null};var s=t&&t[n],l=e[n],d=t?s:m?C(l,m):void 0,f=i.call(p,d,l,o);null==d&&null!=f&&(m?A(l=_(l),m,f):s=f),(c=null!=s?a.add(l,s):a.add(l))._hookCtx=p,n<r-1&&(c.onerror=u,p.onsuccess&&(c.onsuccess=h))}},function(e){throw p.onerror&&p.onerror(e),e}),c.onerror=fe(d,l,!0),c.onsuccess=Dt(l)}else{u=fe(d);for(var g=0,y=e.length;g<y;++g)(c=t?a.add(e[g],t[g]):a.add(e[g])).onerror=u;c.onerror=fe(d,l),c.onsuccess=Pt(l)}})},add:function(e,t){var n=this.hook.creating.fire;return this._idbstore(U,function(i,r,s,a){var o={onsuccess:null,onerror:null};if(n!==Z){var l=null!=t?t:s.keyPath?C(e,s.keyPath):void 0,c=n.call(o,l,e,a);null==l&&null!=c&&(s.keyPath?A(e,s.keyPath,c):t=c)}try{var u=null!=t?s.add(e,t):s.add(e);u._hookCtx=o,u.onerror=Wt(r),u.onsuccess=Dt(function(t){var n=s.keyPath;n&&A(e,n,t),i(t)})}catch(e){throw o.onerror&&o.onerror(e),e}})},put:function(e,t){var n=this,i=this.hook.creating.fire,r=this.hook.updating.fire;if(i!==Z||r!==Z){var s=this.schema.primKey.keyPath,a=void 0!==t?t:s&&C(e,s);return null==a?this.add(e):(e=_(e),this._trans(U,function(){return n.where(":id").equals(a).modify(function(){this.value=e}).then(function(i){return 0===i?n.add(e,t):a})},"locked"))}return this._idbstore(U,function(n,i,r){var s=void 0!==t?r.put(e,t):r.put(e);s.onerror=Kt(i),s.onsuccess=Ve(function(t){var i=r.keyPath;i&&A(e,i,t.target.result),n(s.result)})})},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore(U,function(t,n,i){var r=i.delete(e);r.onerror=Kt(n),r.onsuccess=Ve(function(){t(r.result)})})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(U,function(e,t,n){var i=n.clear();i.onerror=Kt(t),i.onsuccess=Ve(function(){e(i.result)})})},update:function(e,t){if("object"!=typeof t||r(t))throw new Y.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||r(e))return this.where(":id").equals(e).modify(t);i(t).forEach(function(n){A(e,n,t[n])});var n=C(e,this.schema.primKey.keyPath);return void 0===n?ut(new Y.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)}}),u(ye.prototype,{_lock:function(){return v(!We.global),++this._reculock,1!==this._reculock||We.global||(We.lockOwnerFor=this),this},_unlock:function(){if(v(!We.global),0==--this._reculock)for(We.global||(We.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{st(e[1],e[0])}catch(e){}}return this},_locked:function(){return this._reculock&&We.lockOwnerFor!==this},create:function(e){var t=this;if(!this.mode)return this;if(v(!this.idbtrans),!e&&!N)switch(j&&j.name){case"DatabaseClosedError":throw new Y.DatabaseClosed(j);case"MissingAPIError":throw new Y.MissingAPI(j.message,j);default:throw new Y.OpenFailed(j)}if(!this.active)throw new Y.TransactionInactive;return v(null===this._completion._state),(e=this.idbtrans=e||N.transaction(Ot(this.storeNames),this.mode)).onerror=Ve(function(n){_t(n),t._reject(e.error)}),e.onabort=Ve(function(n){_t(n),t.active&&t._reject(new Y.Abort(e.error)),t.active=!1,t.on("abort").fire(n)}),e.oncomplete=Ve(function(){t.active=!1,t._resolve()}),this},_promise:function(e,t,n){var i=this;if(e===U&&this.mode!==U)return ut(new Y.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new Y.TransactionInactive);if(this._locked())return new Te(function(r,s){i._blockedFuncs.push([function(){i._promise(e,t,n).then(r,s)},We])});if(n)return Ze(function(){var e=new Te(function(e,n){i._lock();var r=t(e,n,i);r&&r.then&&r.then(e,n)});return e.finally(function(){return i._unlock()}),e._lib=!0,e});var r=new Te(function(e,n){var r=t(e,n,i);r&&r.then&&r.then(e,n)});return r._lib=!0,r},_root:function(){return this.parent?this.parent._root():this},waitFor:function(e){var t=this._root();if(e=Te.resolve(e),t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return e});else{t._waitingFor=e,t._waitingQueue=[];var n=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Te(function(n,r){e.then(function(e){return t._waitingQueue.push(Ve(n.bind(null,e)))},function(e){return t._waitingQueue.push(Ve(r.bind(null,e)))}).finally(function(){t._waitingFor===i&&(t._waitingFor=null)})})},abort:function(){this.active&&this._reject(new Y.Abort),this.active=!1},tables:{get:(h="Transaction.tables",f=function(){return E},function(){return console.warn(h+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+L(H(),1)),f.apply(this,arguments)})},table:function(e){return new de(e,$.table(e).schema,this)}}),u(ve.prototype,function(){function e(e,t,n){var i=e instanceof ve?new be(e):e;return i._ctx.error=n?new n(t):new TypeError(t),i}function t(e){return new be(e,function(){return M.only("")}).limit(0)}function n(e,t,n,i,r,s){for(var a=Math.min(e.length,i.length),o=-1,l=0;l<a;++l){var c=t[l];if(c!==i[l])return r(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):r(e[l],i[l])<0?e.substr(0,l)+i[l]+n.substr(l+1):o>=0?e.substr(0,o)+t[o]+n.substr(o+1):null;r(e[l],c)<0&&(o=l)}return a<i.length&&"next"===s?e+n.substr(e.length):a<e.length&&"prev"===s?e.substr(0,n.length):o<0?null:e.substr(0,o)+i[o]+n.substr(o+1)}function i(t,i,r,s){var a,o,l,c,u,h,d,f=r.length;if(!r.every(function(e){return"string"==typeof e}))return e(t,yt);function p(e){a=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),l="next"===e?_e:Fe;var t=r.map(function(e){return{lower:o(e),upper:a(e)}}).sort(function(e,t){return l(e.lower,t.lower)});c=t.map(function(e){return e.upper}),u=t.map(function(e){return e.lower}),h=e,d="next"===e?"":s}p("next");var m=new be(t,function(){return M.bound(c[0],u[f-1]+s)});m._ondirectionchange=function(e){p(e)};var g=0;return m._addAlgorithm(function(e,t,r){var s=e.key;if("string"!=typeof s)return!1;var a=o(s);if(i(a,u,g))return!0;for(var p=null,m=g;m<f;++m){var y=n(s,a,c[m],u[m],l,h);null===y&&null===p?g=m+1:(null===p||l(p,y)>0)&&(p=y)}return t(null!==p?function(){e.continue(p+d)}:r),!1}),m}return{between:function(n,i,r,s){r=!1!==r,s=!0===s;try{return Ae(n,i)>0||0===Ae(n,i)&&(r||s)&&(!r||!s)?t(this):new be(this,function(){return M.bound(n,i,!r,!s)})}catch(t){return e(this,gt)}},equals:function(e){return new be(this,function(){return M.only(e)})},above:function(e){return new be(this,function(){return M.lowerBound(e,!0)})},aboveOrEqual:function(e){return new be(this,function(){return M.lowerBound(e)})},below:function(e){return new be(this,function(){return M.upperBound(e,!0)})},belowOrEqual:function(e){return new be(this,function(){return M.upperBound(e)})},startsWith:function(t){return"string"!=typeof t?e(this,yt):this.between(t,t+ft,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):i(this,function(e,t){return 0===e.indexOf(t[0])},[e],ft)},equalsIgnoreCase:function(e){return i(this,function(e,t){return e===t[0]},[e],"")},anyOfIgnoreCase:function(){var e=x.apply(O,arguments);return 0===e.length?t(this):i(this,function(e,t){return-1!==t.indexOf(e)},e,"")},startsWithAnyOfIgnoreCase:function(){var e=x.apply(O,arguments);return 0===e.length?t(this):i(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,ft)},anyOf:function(){var n=x.apply(O,arguments),i=Ke;try{n.sort(i)}catch(t){return e(this,gt)}if(0===n.length)return t(this);var r=new be(this,function(){return M.bound(n[0],n[n.length-1])});r._ondirectionchange=function(e){i="next"===e?Ke:Pe,n.sort(i)};var s=0;return r._addAlgorithm(function(e,t,r){for(var a=e.key;i(a,n[s])>0;)if(++s===n.length)return t(r),!1;return 0===i(a,n[s])||(t(function(){e.continue(n[s])}),!1)}),r},notEqual:function(e){return this.inAnyRange([[mt,e],[e,pt]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=x.apply(O,arguments);if(0===t.length)return new be(this);try{t.sort(Ke)}catch(t){return e(this,gt)}var n=t.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[mt,t]]},null);return n.push([t[t.length-1],pt]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,i){if(0===n.length)return t(this);if(!n.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&Ke(e[0],e[1])<=0}))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Y.InvalidArgument);var r=!i||!1!==i.includeLowers,s=i&&!0===i.includeUppers;var a,o=Ke;function l(e,t){return o(e[0],t[0])}try{(a=n.reduce(function(e,t){for(var n=0,i=e.length;n<i;++n){var r=e[n];if(Ae(t[0],r[1])<0&&Ae(t[1],r[0])>0){r[0]=(s=r[0],a=t[0],Ae(s,a)<0?s:a),r[1]=De(r[1],t[1]);break}}var s,a;return n===i&&e.push(t),e},[])).sort(l)}catch(t){return e(this,gt)}var c=0,u=s?function(e){return Ke(e,a[c][1])>0}:function(e){return Ke(e,a[c][1])>=0},h=r?function(e){return Pe(e,a[c][0])>0}:function(e){return Pe(e,a[c][0])>=0};var d=u,f=new be(this,function(){return M.bound(a[0][0],a[a.length-1][1],!r,!s)});return f._ondirectionchange=function(e){"next"===e?(d=u,o=Ke):(d=h,o=Pe),a.sort(l)},f._addAlgorithm(function(e,t,n){for(var i=e.key;d(i);)if(++c===a.length)return t(n),!1;return!!function(e){return!u(e)&&!h(e)}(i)||0!==Ae(i,a[c][1])&&0!==Ae(i,a[c][0])&&(t(function(){o===Ke?e.continue(a[c][0]):e.continue(a[c][1])}),!1)}),f},startsWithAnyOf:function(){var n=x.apply(O,arguments);return n.every(function(e){return"string"==typeof e})?0===n.length?t(this):this.inAnyRange(n.map(function(e){return[e,e+ft]})):e(this,"startsWithAnyOf() only works with strings")}}}),u(be.prototype,function(){function e(e,t){e.filter=Me(e.filter,t)}function t(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return Me(i(),t())}:t,e.justLimit=n&&!i}function n(e,t){if(e.isPrimKey)return t;var n=e.table.schema.idxByName[e.index];if(!n)throw new Y.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(n.name)}function r(e,t){var i=n(e,t);return e.keysOnly&&"openKeyCursor"in i?i.openKeyCursor(e.range||null,e.dir+e.unique):i.openCursor(e.range||null,e.dir+e.unique)}function s(e,t,n,i,s){var a=e.replayFilter?Me(e.filter,e.replayFilter()):e.filter;e.or?function(){var o={},l=0;function u(){2==++l&&n()}function h(e,n,r){if(!a||a(n,r,u,i)){var s=n.primaryKey,l=""+s;"[object ArrayBuffer]"===l&&(l=""+new Uint8Array(s)),c(o,l)||(o[l]=!0,t(e,n,r))}}e.or._iterate(h,u,i,s),Ce(r(e,s),e.algorithm,h,u,i,!e.keysOnly&&e.valueMapper)}():Ce(r(e,s),Me(e.algorithm,a),t,n,i,!e.keysOnly&&e.valueMapper)}return{_read:function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ut.bind(null,n.error)):n.table._idbstore("readonly",e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,ut.bind(null,t.error)):t.table._idbstore(U,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=Me(t.algorithm,e)},_iterate:function(e,t,n,i){return s(this._ctx,e,t,n,i)},clone:function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&a(n,e),t._ctx=n,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;return this._read(function(n,i,r){s(t,e,n,i,r)})},count:function(e){var t=this._ctx;if(we(t,!0))return this._read(function(e,i,r){var s=n(t,r),a=t.range?s.count(t.range):s.count();a.onerror=Kt(i),a.onsuccess=function(n){e(Math.min(n.target.result,t.limit))}},e);var i=0;return this._read(function(e,n,r){s(t,function(){return++i,!1},function(){e(i)},n,r)},e)},sortBy:function(e,t){var n=e.split(".").reverse(),i=n[0],r=n.length-1;function s(e,t){return t?s(e[n[t]],t-1):e[i]}var a="next"===this._ctx.dir?1:-1;function o(e,t){var n=s(e,r),i=s(t,r);return n<i?-a:n>i?a:0}return this.toArray(function(e){return e.sort(o)}).then(t)},toArray:function(e){var t=this._ctx;return this._read(function(e,i,r){if(l&&"next"===t.dir&&we(t,!0)&&t.limit>0){var a=t.table.hook.reading.fire,o=n(t,r),c=t.limit<1/0?o.getAll(t.range,t.limit):o.getAll(t.range);c.onerror=Kt(i),c.onsuccess=Pt(a===X?e:function(t){try{e(t.map(a))}catch(e){i(e)}})}else{var u=[];s(t,function(e){u.push(e)},function(){e(u)},i,r)}},e)},offset:function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,we(n)?t(n,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):t(n,function(){var t=e;return function(){return--t<0}}),this)},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,function(){var t=e;return function(e,n,i){return--t<=0&&n(i),t>=0}},!0),this},until:function(t,n){return e(this._ctx,function(e,i,r){return!t(e.value)||(i(r),n)}),this},first:function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){var n,i;return e(this._ctx,function(e){return t(e.value)}),n=this._ctx,i=t,n.isMatch=Me(n.isMatch,i),this},and:function(e){return this.filter(e)},or:function(e){return new ve(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},primaryKeys:function(e){var t=this._ctx;if(l&&"next"===t.dir&&we(t,!0)&&t.limit>0)return this._read(function(e,i,r){var s=n(t,r),a=t.limit<1/0?s.getAllKeys(t.range,t.limit):s.getAllKeys(t.range);a.onerror=Kt(i),a.onsuccess=Pt(e)}).then(e);t.keysOnly=!t.isMatch;var i=[];return this.each(function(e,t){i.push(t.primaryKey)}).then(function(){return i}).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var i={};return e(this._ctx,function(e){var t=e.primaryKey.toString(),n=c(i,t);return i[t]=!0,!n}),this},modify:function(e){var t=this,n=this._ctx.table.hook,r=n.updating.fire,s=n.deleting.fire;return this._write(function(n,o,l,u){var h;if("function"==typeof e)h=r===Z&&s===Z?e:function(t){var n=_(t);if(!1===e.call(this,t,this))return!1;if(c(this,"value")){var a=F(n,this.value),o=r.call(this,a,this.primKey,n,u);o&&(t=this.value,i(o).forEach(function(e){A(t,e,o[e])}))}else s.call(this,this.primKey,t,u)};else if(r===Z){var d=i(e),f=d.length;h=function(t){for(var n=!1,i=0;i<f;++i){var r=d[i],s=e[r];C(t,r)!==s&&(A(t,r,s),n=!0)}return n}}else{var p=e;e=D(p),h=function(t){var n=!1,s=r.call(this,e,this.primKey,_(t),u);return s&&a(e,s),i(e).forEach(function(i){var r=e[i];C(t,i)!==r&&(A(t,i,r),n=!0)}),s&&(e=D(p)),n}}var m=0,g=0,y=!1,v=[],b=[],w=null;function S(e){return e&&(v.push(e),b.push(w)),o(new V("Error modifying one or more objects",v,g,b))}function K(){y&&g+v.length===m&&(v.length>0?S():n(g))}t.clone().raw()._iterate(function(e,t){w=t.primaryKey;var n={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};function i(e){return v.push(e),b.push(n.primKey),K(),!0}if(!1!==h.call(n,e,n)){var r=!c(n,"value");++m,k(function(){var e=r?t.delete():t.update(n.value);e._hookCtx=n,e.onerror=Wt(i),e.onsuccess=Dt(function(){++g,K()})},i)}else n.onsuccess&&n.onsuccess(n.value)},function(){y=!0,K()},S,l)})},delete:function(){var e=this,t=this._ctx,n=t.range,i=t.table.hook.deleting.fire,r=i!==Z;if(!r&&we(t)&&(t.isPrimKey&&!St||!n))return this._write(function(e,t,i){var r=Kt(t),s=n?i.count(n):i.count();s.onerror=r,s.onsuccess=function(){var a=s.result;k(function(){var t=n?i.delete(n):i.clear();t.onerror=r,t.onsuccess=function(){return e(a)}},function(e){return t(e)})}});var s=r?2e3:1e4;return this._write(function(n,a,o,l){var c=0,u=e.clone({keysOnly:!t.isMatch&&!r}).distinct().limit(s).raw(),h=[],d=function(){return u.each(r?function(e,t){h.push([t.primaryKey,t.value])}:function(e,t){h.push(t.primaryKey)}).then(function(){return r?h.sort(function(e,t){return Ke(e[0],t[0])}):h.sort(Ke),pe(o,l,h,r,i)}).then(function(){var e=h.length;return c+=e,h=[],e<s?c:d()})};n(d())})}}}),a(this,{Collection:be,Table:de,Transaction:ye,Version:le,WhereClause:ve}),$.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+$.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+$.name+"'. Closing db now to resume the delete request."),$.close()}),$.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+$.name+"') was blocked"):console.warn("Upgrade '"+$.name+"' blocked by other connection holding version "+e.oldVersion/10)}),b.forEach(function(e){e($)})}function At(e,t){return i(t).forEach(function(n){var i=function e(t){if("function"==typeof t)return new t;if(r(t))return[e(t[0])];if(t&&"object"==typeof t){var n={};return At(n,t),n}return t}(t[n]);e[n]=i}),e}function Dt(e){return Ve(function(t){var n=t.target,i=n._hookCtx,r=i.value||n.result,s=i&&i.onsuccess;s&&s(r),e&&e(r)},e)}function Kt(e){return Ve(function(t){return _t(t),e(t.target.error),!1})}function Pt(e){return Ve(function(t){e(t.target.result)})}function Wt(e){return Ve(function(t){var n=t.target,i=n.error,r=n._hookCtx,s=r&&r.onerror;return s&&s(i),_t(t),e(i),!1})}function _t(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function Ft(e){var t=function(t){return e.next(t)},n=s(t),i=s(function(t){return e.throw(t)});function s(e){return function(t){var s=e(t),a=s.value;return s.done?a:a&&"function"==typeof a.then?a.then(n,i):r(a)?Te.all(a).then(n,i):n(a)}}return s(t)()}function Mt(e,t,n,i,r,s,a){this.name=e,this.keyPath=t,this.unique=n,this.multi=i,this.auto=r,this.compound=s,this.dotted=a;var o="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(n?"&":"")+(i?"*":"")+(r?"++":"")+o}function Tt(e,t,n,i){this.name=e,this.primKey=t||new Mt,this.indexes=n||[new Mt],this.instanceTemplate=i,this.mappedClass=null,this.idxByName=w(n,function(e){return[e.name,e]})}function Ot(e){return 1===e.length?e[0]:e}function xt(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}B(I,kt),u(Ct,Q),u(Ct,{delete:function(e){var t=new Ct(e),n=t.delete();return n.onblocked=function(e){return t.on("blocked",e),this},n},exists:function(e){return new Ct(e).open().then(function(e){return e.close(),!0}).catch(Ct.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(e){var t=xt(Ct.dependencies.indexedDB);return t?new Te(function(e,n){var i=t();i.onsuccess=function(t){e(g(t.target.result,0))},i.onerror=Kt(n)}).then(e):dt.dbnames.toCollection().primaryKeys(e)},defineClass:function(){return function(e){e&&a(this,e)}},applyStructure:At,ignoreTransaction:function(e){return We.trans?st(We.transless,e):e()},vip:function(e){return Ze(function(){return We.letThrough=!0,e()})},async:function(e){return function(){try{var t=Ft(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Te.resolve(t)}catch(e){return ut(e)}}},spawn:function(e,t,n){try{var i=Ft(e.apply(n,t||[]));return i&&"function"==typeof i.then?i:Te.resolve(i)}catch(e){return ut(e)}},currentTransaction:{get:function(){return We.trans||null}},waitFor:function(e,t){var n=Te.resolve("function"==typeof e?Ct.ignoreTransaction(e):e).timeout(t||6e4);return We.trans?We.trans.waitFor(n):n},Promise:Te,debug:{get:function(){return I},set:function(e){B(e,"dexie"===e?function(){return!0}:kt)}},derive:f,extend:a,props:u,override:y,Events:ht,getByKeyPath:C,setByKeyPath:A,delByKeyPath:function(e,t){"string"==typeof t?A(e,t,void 0):"length"in t&&[].map.call(t,function(t){A(e,t,void 0)})},shallowClone:D,deepClone:_,getObjectDiff:F,asap:b,maxKey:pt,minKey:mt,addons:[],connections:vt,MultiModifyError:Y.Modify,errnames:q,IndexSpec:Mt,TableSchema:Tt,dependencies:function(){try{return{indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"{version}",version:"{version}".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)}),default:Ct,Dexie:Ct}),Te.rejectionMapper=function(e,t){if(!e||e instanceof J||e instanceof TypeError||e instanceof SyntaxError||!e.name||!$[e.name])return e;var n=new $[e.name](t||e.message,e);return"stack"in e&&d(n,"stack",{get:function(){return this.inner.stack}}),n},(dt=new Ct("__dbnames")).version(1).stores({dbnames:"name"}),function(){try{void 0!==typeof localStorage&&void 0!==s.document&&(JSON.parse(localStorage.getItem("Dexie.DatabaseNames")||"[]").forEach(function(e){return dt.dbnames.put({name:e}).catch(Z)}),localStorage.removeItem("Dexie.DatabaseNames"))}catch(e){}}(),t.default=Ct}.call(this,n(8),n(17).setImmediate)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function s(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new s(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new s(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(18),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(8))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,s,a,o,l=1,c={},u=!1,h=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){p(e.data)},i=function(e){s.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(e){var t=h.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),i=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[l]=r,i(l),l++},d.clearImmediate=f}function f(e){delete c[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(8),n(19))},function(e,t){var n,i,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=o(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||u||o(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}]);
//# sourceMappingURL=seeder.js.map