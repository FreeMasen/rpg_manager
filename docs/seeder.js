!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=33)}([,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.scores=e||[new r(8,a.Strength),new r(8,a.Dexterity),new r(8,a.Constitution),new r(8,a.Intelligence),new r(8,a.Wisdom),new r(8,a.Charisma)]}static Empty(){return new i([new r(0,a.Strength),new r(0,a.Dexterity),new r(0,a.Constitution),new r(0,a.Intelligence),new r(0,a.Wisdom),new r(0,a.Charisma)])}map(e){return this.scores.map(e)}reduce(e,t){return this.scores.reduce(e,t)}modifier(e){return this.scores.find(t=>t.kind==e).modifier}clone(){return i.fromJson(this)}set(e,t){let n=this.scores.findIndex(t=>t.kind==e);n<0||(this.scores[n].value=t)}add(e){return new i([new r(this.scores[0].value+e.scores[0].value,this.scores[0].kind),new r(this.scores[1].value+e.scores[1].value,this.scores[1].kind),new r(this.scores[2].value+e.scores[2].value,this.scores[2].kind),new r(this.scores[3].value+e.scores[3].value,this.scores[3].kind),new r(this.scores[4].value+e.scores[4].value,this.scores[4].kind),new r(this.scores[5].value+e.scores[5].value,this.scores[5].kind)])}static fromJson(e){return new i(e.scores.map(r.fromJson))}}t.AbilityScores=i;class r{constructor(e,t){this.value=e,this.kind=t}get modifier(){return Math.floor((this.value-10)/2)}static fromJson(e){return new r(e.value,e.kind)}}var a;t.AbilityScore=r,function(e){e.Strength="Strength",e.Dexterity="Dexterity",e.Constitution="Constitution",e.Intelligence="Intelligence",e.Wisdom="Wisdom",e.Charisma="Charisma"}(a=t.AbilityKind||(t.AbilityKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(11),r=n(25),a=n(19),o=n(13),s=n(20),l=n(15),c=n(26);class u{constructor(e=u.nextName(),t=new i.AbilityScores,n=new a.Race,r=new o.Class(o.ClassKind.Fighter,1),c=new s.Background(s.BackgroundKind.Criminal),d=w.ChaoticGood(),f=0,g=new S,m=160,p="grey",y=0,v=null,b=null,k=new l.Skills,A=[new C],K=new D,P=[h.Common],W=[],T=0,_=0,x=[],B=[]){this.name=e,this.abilityScores=t,this.race=n,this.characterClass=r,this.background=c,this.alignment=d,this.experience=f,this.height=g,this.weight=m,this.eyeColor=p,this.inspiration=y,this.skills=k,this.weapons=A,this.wealth=K,this.languages=P,this.notes=W,this.damage=T,this.tempHp=_,this.magicItems=x,this.expendables=B,this.shield=b,this.armor=v,this.background.skills.map(e=>{this.skills.set(e,!0)})}resetSkills(){this.skills=new l.Skills,this.background.skills.map(e=>{this.skills.set(e,!0)})}get proficiencyBonus(){return this.characterClass.proficiencyBonus()}get proficiency(){let e=this.characterClass.armorProfs.map(e=>`${e} Armor`);return e.push(...this.characterClass.weaponProfs.map(e=>g[e.replace(/\s/g,"")]?e:`${e} Weapons`)),e.push(...this.characterClass.miscProfs),this.background.toolProficiencies.forEach(t=>{Array.isArray(t)||e.push(t)}),this.background.languages.length>0&&(0==this.background.languages.filter(e=>null!=e).length?e.push(`${this.background.languages.length} languages of your choice`):e.push(...this.background.languages)),e}static nextName(){let e="Carl";return u.counter>0&&(e+=` ${u.counter}`),u.counter++,e}get saves(){let e=this.abilityScores.map(e=>{let t=new i.AbilityScore(e.value,e.kind),n=this.race.abilityModifiers.find(e=>e[0]==t.kind);n&&(t.value+=n[1]);let r=this.characterClass.bonusAbilityScores.find(e=>e[0]==t.kind);return r&&(t.value+=r[1]),t}),t=this.characterClass.savingThrows;return e.map(e=>{let n=t.indexOf(e.kind)>-1,i=n?e.modifier+this.proficiencyBonus:e.modifier;return new k(e.kind,n,i)})}get rawSkills(){let e=this.modifiedAbilityScores().reduce((e,t)=>(e[t.kind]=t.modifier,e),{});return this.skills.map(t=>{let n=e[t.modifier],i=0,r=t.enabled||this.characterClass.selectedSkills.indexOf(t.kind)>-1;if(r?i=this.proficiencyBonus:this.characterClass.name===o.ClassKind.Bard&&this.level>1&&(i=Math.floor(this.proficiencyBonus/2)),this.characterClass.name==o.ClassKind.Rogue||this.characterClass.name===o.ClassKind.Bard){this.characterClass.classDetails.expertise.indexOf(t.kind)>-1&&(i*=2)}let a=n+i;return[t.kind,a,r]})}modifiedAbilityScores(){let e=this.abilityScores.map(e=>{let{kind:t,value:n}=e,r=this.race.abilityModifiers.find(e=>e[0]==t);r&&(n+=r[1]);let a=this.characterClass.bonusAbilityScores.find(e=>e[0]==t);return a&&(n+=a[1]),new i.AbilityScore(n,t)});return new i.AbilityScores(e)}get passiveWisdom(){return this.abilityScores.modifier(i.AbilityKind.Wisdom)+this.proficiencyBonus}get initiative(){return this.abilityScores.modifier(i.AbilityKind.Dexterity)}armorClass(){let e=this.abilityScores.modifier(i.AbilityKind.Dexterity),t=0;return this.armor?(t=this.armor.bonus,this.armor.dexLimit&&this.armor.dexLimit<e&&(e=this.armor.dexLimit)):this.characterClass.name==o.ClassKind.Barbarian&&(t=this.abilityScores.modifier(i.AbilityKind.Constitution)),this.shield&&(t+=this.shield.bonus),10+t+e}get level(){let e=r.Data.levelForExp(this.experience);return this.characterClass.level!=e&&(this.characterClass.level=e),e}addExperience(e){this.experience+=e}get expToNextLevel(){switch(this.level){case 1:return 300-this.experience;case 2:return 900-this.experience;case 3:return 2700-this.experience;case 4:return 6500-this.experience;case 5:return 14e3-this.experience;case 6:return 23e3-this.experience;case 7:return 34e3-this.experience;case 8:return 48e3-this.experience;case 9:return 64e3-this.experience;case 10:return 85e3-this.experience;case 11:return 1e5-this.experience;case 12:return 12e4-this.experience;case 13:return 14e4-this.experience;case 14:return 165e3-this.experience;case 15:return 195e3-this.experience;case 16:return 225e3-this.experience;case 17:return 265e3-this.experience;case 18:return 305e3-this.experience;case 19:return 355e3-this.experience}}needsLevelUp(){return 1===this.level&&this.experience>300||2===this.level&&this.experience>900||3===this.level&&this.experience>2700||4===this.level&&this.experience>6500||5===this.level&&this.experience>14e3||6===this.level&&this.experience>23e3||7===this.level&&this.experience>34e3||8===this.level&&this.experience>48e3||9===this.level&&this.experience>64e3||10===this.level&&this.experience>85e3||10===this.level&&this.experience>1e5||11===this.level&&this.experience>12e4||12===this.level&&this.experience>14e4||13===this.level&&this.experience>165e3||15===this.level&&this.experience>195e3||16===this.level&&this.experience>225e3||17===this.level&&this.experience>265e3||18===this.level&&this.experience>305e3||19===this.level&&this.experience>355e3}hitPoints(){let e=this.abilityScores.modifier(i.AbilityKind.Constitution),t=this.characterClass.hitDie+e,n=r.Data.averageHpFor(this.characterClass.name);for(let i=0;i<this.level;i++)t+=n+e;return t}currentHealth(){return this.hitPoints()+this.tempHp-this.damage}get speed(){return this.characterClass.name==o.ClassKind.Barbarian&&this.level>4?this.race.speed+10:this.race.speed}static fromJson(e){let t=new u(e.name,i.AbilityScores.fromJson(e.abilityScores),a.Race.fromJson(e.race),o.Class.fromJson(e.characterClass),s.Background.fromJson(e.background),w.fromJson(e.alignment),e.experience,S.fromJson(e.height),e.weight,e.eyeColor,e.inspiration,A.fromJson(e.armor),A.fromJson(e.shield),l.Skills.fromJson(e.skills),e.weapons.map(C.fromJson),D.fromJson(e.wealth),e.languages,e.notes,e.damage,e.tempHp,e.magicItems.map(K.fromJson),e.expendables.map(P.fromJson));return e.id&&(t.id=e.id),t}}var h,d,f,g,m,p,y,v,b;u.counter=0,t.Character=u,function(e){e.Common="Common",e.Dwarvish="Dwarvish",e.Elvish="Elvish",e.Halfling="Halfling",e.Draconic="Draconic",e.Gnomish="Gnomish",e.Orc="Orc",e.Infernal="Infernal"}(h=t.NormalLanguage||(t.NormalLanguage={})),function(e){e.ThievesCant="Thieves' Cant",e.Druidic="Druidic"}(t.ClassLanguage||(t.ClassLanguage={})),function(e){e.Small="Small",e.Medium="Medium",e.Large="Large"}(t.CharacterSize||(t.CharacterSize={}));class w{constructor(e,t){this.major=e,this.minor=t}toString(){return this.major==d.Neutral&&this.minor==f.Neutral?"True Neutral":`${this.major} ${this.minor}`}static LawfulGood(){return new w(d.Lawful,f.Good)}static LawfulNeutral(){return new w(d.Lawful,f.Neutral)}static LawfulEvil(){return new w(d.Lawful,f.Evil)}static NeutralGood(){return new w(d.Neutral,f.Good)}static TrueNeutral(){return new w(d.Neutral,f.Neutral)}static NeutralEvil(){return new w(d.Neutral,f.Evil)}static ChaoticGood(){return new w(d.Chaotic,f.Good)}static ChaoticNeutral(){return new w(d.Chaotic,f.Neutral)}static ChaoticEvil(){return new w(d.Chaotic,f.Evil)}static fromJson(e){return new w(e.major,e.minor)}}t.Alignment=w,function(e){e.Lawful="Lawful",e.Neutral="Neutral",e.Chaotic="Chaotic"}(d=t.AlignmentMajor||(t.AlignmentMajor={})),function(e){e.Good="Good",e.Neutral="Neutral",e.Evil="Evil"}(f=t.AlignmentMinor||(t.AlignmentMinor={}));class S{constructor(e=5,t=9){this.feet=e,this.inches=t}toString(){return`${this.feet}' ${this.inches}"`}static fromJson(e){return new S(e.feet,e.inches)}}t.Height=S;class k{constructor(e,t,n){this.kind=e,this.enabled=t,this.value=n}static fromJson(e){return new k(e.kind,e.enabled,e.value)}}t.Save=k;class A{constructor(e,t,n,i=null){this.name=e,this.kind=t,this.bonus=n,this.dexLimit=i}static fromJson(e){return e?new A(e.kind,e.bonus,e.dexLimit):null}}t.Armor=A,function(e){e.Padded="Padded",e.Leather="Leather",e.StuddedLeather="StuddedLeather"}(t.LightArmor||(t.LightArmor={})),function(e){e.Hide="Hide",e.ChainShirt="ChainShirt",e.ScaleMail="ScaleMail",e.BreastPlate="BreastPlate",e.HalfPlate="HalfPlate"}(t.MediumArmor||(t.MediumArmor={})),function(e){e.RingMail="RingMail",e.ChainMail="ChainMail",e.Splint="Splint",e.Plate="Plate"}(t.HeavyArmor||(t.HeavyArmor={})),function(e){e.Light="Light",e.Medium="Medium",e.Heavy="Heavy",e.Shield="Shield"}(t.ArmorWeight||(t.ArmorWeight={}));class C{constructor(e="Daggar",t=m.Melee,n=p.Simple,i=y.Piercing,r=v.Light,a=b.One,o=[1,4],s=new c.Range(5),l=1,u=new c.Range(20,60),h=!1,d=!0,f=""){this.name=e,this.weaponType=t,this.kind=n,this.damageKind=i,this.weight=r,this.handedness=a,this.hitDie=o,this.range=s,this.carryWeight=l,this.thrown=u,this.isRanged=h,this.isFinesse=d,this.notes=f}miscString(){let e=`${this.damageKind.substr(0,1)}`;return this.handedness&&(e+=`/${this.handedness.substr(0,1)}`),this.weight&&(e+=`/${this.weight.substr(0,1).toLocaleLowerCase()}`),this.isRanged&&(e+="/R"),this.thrown&&(e+="/T"),this.isFinesse&&(e+="/F"),e+="/"+this.range.metaString()}static fromJson(e){return new C(e.name,e.weaponType,e.kind,e.damageKind,e.weight,e.handedness,e.hitDie,c.Range.fromJson(e.range),e.carryWeight,c.Range.fromJson(e.thrown),e.isRanged,e.isFinesse,e.notes)}}t.Weapon=C,function(e){e.Battleaxe="Battleaxe",e.HandAxe="Hand Axe",e.ThrowingHammer="Throwing Hammer",e.WarHammer="War Hammer",e.LongSword="Long Sword",e.ShortSword="Short Sword",e.ShortBow="Short Bow",e.LongBow="Long Bow",e.Rapier="Rapier",e.HandCrossbow="Hand Crossbow",e.Club="Club",e.Dagger="Dagger",e.Dart="Dart",e.Javelin="Javelin",e.Mace="Mace",e.QuarterStaff="Quarter Staff",e.Scimitar="Scimitar",e.Sickle="Sickle",e.Sling="Sling",e.LightCrossbow="LightCrossbow",e.Spear="Spear"}(g=t.StdWeaponName||(t.StdWeaponName={})),function(e){e.Melee="Melee",e.Range="Range"}(m=t.WeaponType||(t.WeaponType={})),function(e){e.Simple="Simple",e.Martial="Martial",e.Natural="Natural"}(p=t.WeaponKind||(t.WeaponKind={})),function(e){e.Piercing="Piercing",e.Slashing="Slashing",e.Bludgeoning="Bludgeoning",e.Acid="Acid",e.Fire="Fire",e.Lightening="Lightening",e.Cold="Cold",e.Poison="Poison"}(y=t.WeaponDamageKind||(t.WeaponDamageKind={})),function(e){e.Light="Light",e.Heavy="Heavy"}(v=t.WeaponWeight||(t.WeaponWeight={})),function(e){e.One="One",e.Two="Two",e.Versatile="Versatile"}(b=t.WeaponHandedness||(t.WeaponHandedness={}));class D{constructor(e=0,t=0,n=0,i=0,r=0){this.copper=e,this.silver=t,this.electrum=n,this.gold=i,this.platinum=r,this.balance()}balance(){this.roundUp(),this.roundDown()}clone(){return D.fromJson(this)}add(e){return new D(this.copper+e.copper,this.silver+e.silver,this.electrum+e.electrum,this.gold+e.gold,this.platinum+e.platinum)}mul(e){return new D(this.copper*e,this.silver*e,this.electrum*e,this.gold*e,this.platinum*e)}roundUp(){for(;this.copper>99;)this.copper-=100,this.silver++;for(;this.silver>99;)this.silver-=100,this.electrum++;for(;this.electrum>99;)this.electrum-=100,this.gold++;for(;this.gold>99;)this.gold-=100,this.platinum+=1}roundDown(){for(;this.copper<-100;)this.silver--,this.copper+=100;for(;this.silver<-100;)this.electrum--,this.silver+=100;for(;this.electrum<-100;)this.gold--,this.electrum+=100;for(;this.gold<-100;)this.platinum--,this.gold+=100}static fromJson(e){return new D(e.copper||0,e.silver||0,e.electrum||0,e.gold||0,e.platinum||0)}}t.Wealth=D;class K{constructor(e,t){this.name=e,this.buf=t}static fromJson(e){return new K(e.name,e.buf)}}t.MagicItem=K;class P{constructor(e,t,n){this.quantity=e,this.name=t,this.desc=n}static fromJson(e){return new P(e.quantity,e.name,e.desc)}}t.ExpendableItem=P},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(11),r=n(12),a=n(15),o=n(30),s=n(25);t.DEFAULT_BONUS_ABILITY_SCORES=[[i.AbilityKind.Strength,0],[i.AbilityKind.Dexterity,0],[i.AbilityKind.Constitution,0],[i.AbilityKind.Intelligence,0],[i.AbilityKind.Wisdom,0],[i.AbilityKind.Charisma,0]];class l{constructor(e,n,i=t.DEFAULT_BONUS_ABILITY_SCORES,r=[]){switch(this.name=e,this._level=n,this.bonusAbilityScores=i,this.selectedSkills=r,this.numberOfPrimaryAbilities=1,this.savingThrows=[],this.weaponProfs=[],this.armorProfs=[],this.canUseShield=!1,this.features=[],this.numberOfSkills=0,this.availableSkills=[],this.miscProfs=[],e){case c.Barbarian:this.barbarianCtor();break;case c.Bard:this.bardCtor();break;case c.Cleric:this.clericCtor();break;case c.Druid:this.druidCtor();case c.Fighter:this.fighterCtor();break;case c.Monk:this.monkCtor();break;case c.Paladin:this.paladinCtor();break;case c.Ranger:this.rangerCtor();break;case c.Rogue:this.rogueCtor();break;case c.Sorcerer:this.sorcererCtor();break;case c.Warlock:this.warlockCtor();break;case c.Wizard:this.wizardCtor()}}get level(){return this._level}set level(e){this._level=e,this.classDetails.level&&(this.classDetails.level=e)}proficiencyBonus(){return s.Data.proficiencyBonusFor(this.level)}barbarianCtor(e=new o.BarbarianDetails(this._level,null,null)){this.desc="A fierce warrior of primitive background who can enter a battle rage",this.classDetails=e,this.hitDie=12,this.primaryAbility=[i.AbilityKind.Strength,i.AbilityKind.Constitution],this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Constitution],this.weaponProfs=[r.WeaponKind.Martial,r.WeaponKind.Simple],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium,r.ArmorWeight.Heavy],this.canUseShield=!0,this.numberOfSkills=2,this.availableSkills=[a.SkillKind.AnimalHandling,a.SkillKind.Athletics,a.SkillKind.Intimidation,a.SkillKind.Nature,a.SkillKind.Perception,a.SkillKind.Survival]}bardCtor(e=new o.BardDetails(this._level,null,[])){this.desc="An inspiring magician whose power echoes the music of creation",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Charisma],this.savingThrows=[i.AbilityKind.Charisma,i.AbilityKind.Dexterity],this.weaponProfs=[r.WeaponKind.Simple,r.StdWeaponName.HandCrossbow,r.StdWeaponName.LongSword,r.StdWeaponName.Rapier,r.StdWeaponName.ShortSword],this.armorProfs=[r.ArmorWeight.Light],this.numberOfSkills=3,this.availableSkills=Object.getOwnPropertyNames(a.SkillKind).map(e=>a.SkillKind[e]),this.classDetails.bardCollege===o.BardCollege.Valor&&this._level>2&&(this.weaponProfs.push(r.WeaponKind.Martial),this.armorProfs.push(r.ArmorWeight.Medium),this.canUseShield=!0),this.miscProfs=["Musical Instrument"]}clericCtor(e=new o.ClericDetails(this._level,null)){this.desc="A priestly champion who wields divine magic in service of a higher power",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Wisdom],this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Charisma],this.weaponProfs=[r.WeaponKind.Simple],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.History,a.SkillKind.Insight,a.SkillKind.Medicine,a.SkillKind.Persuasion,a.SkillKind.Religion],this.canUseShield=!0}druidCtor(e=new o.DruidDetails(this._level,null)){this.desc="A priest of the Old Faith, wielding lhe powers of nature-moonlight and plant growth, fire and lightning-and adopting animal forms",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Wisdom],this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Intelligence],this.weaponProfs=[r.StdWeaponName.Club,r.StdWeaponName.Dagger,r.StdWeaponName.Dart,r.StdWeaponName.Javelin,r.StdWeaponName.Mace,r.StdWeaponName.QuarterStaff,r.StdWeaponName.Scimitar,r.StdWeaponName.Sickle,r.StdWeaponName.Spear],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Arcana,a.SkillKind.AnimalHandling,a.SkillKind.Insight,a.SkillKind.Medicine,a.SkillKind.Nature,a.SkillKind.Perception,a.SkillKind.Religion,a.SkillKind.Survival],this.canUseShield=!0}fighterCtor(e=new o.FighterDetails(this._level,null)){this.desc="A master of martial combat, skilled with a variety of weapons and armor",this.classDetails=e,this.hitDie=10,this.primaryAbility=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium,r.ArmorWeight.Heavy],this.weaponProfs=[r.WeaponKind.Simple,r.WeaponKind.Martial],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Acrobatics,a.SkillKind.AnimalHandling,a.SkillKind.Athletics,a.SkillKind.History,a.SkillKind.Insight,a.SkillKind.Intimidation,a.SkillKind.Perception,a.SkillKind.Survival],this.canUseShield=!0}monkCtor(e=new o.MonkDetails(this._level)){this.desc="An master of martial arts, harnessing the power of lhe body in pursuit of physical and spiritual perfection",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Dexterity,i.AbilityKind.Wisdom],this.numberOfPrimaryAbilities=2,this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[],this.weaponProfs=[r.WeaponKind.Simple,r.StdWeaponName.ShortSword],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Acrobatics,a.SkillKind.Athletics,a.SkillKind.History,a.SkillKind.Insight,a.SkillKind.Religion,a.SkillKind.Stealth]}paladinCtor(e=new o.PaladinDetails(this._level,null,null)){this.desc="A holy warrior bound to a sacred oath",this.classDetails=e,this.hitDie=10,this.primaryAbility=[i.AbilityKind.Strength,i.AbilityKind.Charisma],this.numberOfPrimaryAbilities=2,this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Charisma],this.canUseShield=!0,this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium,r.ArmorWeight.Heavy],this.weaponProfs=[r.WeaponKind.Martial,r.WeaponKind.Simple],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Athletics,a.SkillKind.Insight,a.SkillKind.Intimidation,a.SkillKind.Medicine,a.SkillKind.Persuasion,a.SkillKind.Religion]}rangerCtor(e=new o.RangerDetails(this._level,null)){this.desc="A warrior who uses martial prowess and nature magic lo combat threats on lhe edges of civilization",this.classDetails=e,this.hitDie=10,this.primaryAbility=[i.AbilityKind.Dexterity,i.AbilityKind.Wisdom],this.numberOfPrimaryAbilities=2,this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.canUseShield=!0,this.weaponProfs=[r.WeaponKind.Simple,r.WeaponKind.Martial],this.numberOfSkills=3,this.availableSkills=[a.SkillKind.AnimalHandling,a.SkillKind.Athletics,a.SkillKind.Insight,a.SkillKind.Investigation,a.SkillKind.Nature,a.SkillKind.Perception,a.SkillKind.Stealth,a.SkillKind.Survival]}rogueCtor(e=new o.RogueDetails(this.level,null,[])){this.desc="A scoundrel who uses stealth and trickery to overcome obstacles and enemies",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Dexterity],this.savingThrows=[i.AbilityKind.Strength,i.AbilityKind.Dexterity],this.armorProfs=[r.ArmorWeight.Light,r.ArmorWeight.Medium],this.canUseShield=!0,this.weaponProfs=[r.WeaponKind.Simple,r.StdWeaponName.HandCrossbow,r.StdWeaponName.LongSword,r.StdWeaponName.Rapier,r.StdWeaponName.ShortSword],this.numberOfSkills=4,this.availableSkills=[a.SkillKind.Acrobatics,a.SkillKind.Athletics,a.SkillKind.Deception,a.SkillKind.Insight,a.SkillKind.Intimidation,a.SkillKind.Investigation,a.SkillKind.Perception,a.SkillKind.Performance,a.SkillKind.Persuasion,a.SkillKind.SleightOfHand,a.SkillKind.Stealth]}sorcererCtor(e=new o.SorcererDetails(this._level,null,null)){this.desc="A spell caster who draws on inherent magic from a gift or bloodline",this.classDetails=e,this.hitDie=6,this.primaryAbility=[i.AbilityKind.Charisma],this.savingThrows=[i.AbilityKind.Constitution,i.AbilityKind.Charisma],this.weaponProfs=[r.StdWeaponName.Dagger,r.StdWeaponName.Sling,r.StdWeaponName.Dart,r.StdWeaponName.QuarterStaff,r.StdWeaponName.LightCrossbow],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Arcana,a.SkillKind.Deception,a.SkillKind.Insight,a.SkillKind.Intimidation,a.SkillKind.Persuasion,a.SkillKind.Religion]}warlockCtor(e=new o.WarlockDetails(this._level,null)){this.desc="A wielder of magic that is derived from a bargain with an extra-planar entity",this.classDetails=e,this.hitDie=8,this.primaryAbility=[i.AbilityKind.Charisma],this.savingThrows=[i.AbilityKind.Wisdom,i.AbilityKind.Charisma],this.armorProfs=[r.ArmorWeight.Light],this.weaponProfs=[r.WeaponKind.Simple],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Arcana,a.SkillKind.Deception,a.SkillKind.History,a.SkillKind.Intimidation,a.SkillKind.Investigation,a.SkillKind.Nature,a.SkillKind.Religion]}wizardCtor(e=new o.WizardDetails(this._level,null)){this.desc="A scholarly magic-user capable of manipulating lhe structures of reality",this.classDetails=e,this.hitDie=6,this.primaryAbility=[i.AbilityKind.Intelligence],this.savingThrows=[i.AbilityKind.Intelligence,i.AbilityKind.Wisdom],this.weaponProfs=[r.StdWeaponName.Dagger,r.StdWeaponName.Dart,r.StdWeaponName.Sling,r.StdWeaponName.QuarterStaff,r.StdWeaponName.LightCrossbow],this.armorProfs=[],this.numberOfSkills=2,this.availableSkills=[a.SkillKind.Arcana,a.SkillKind.History,a.SkillKind.Insight,a.SkillKind.Investigation,a.SkillKind.Medicine,a.SkillKind.Religion]}addLevel(){this.level+=1}static fromJson(e){let t=new l(null,e._level,e.bonusAbilityScores,e.availableSkills);switch(t.name=e.name,e.name){case c.Barbarian:t.barbarianCtor(o.BarbarianDetails.fromJson(e.classDetails));break;case c.Bard:t.bardCtor(o.BardDetails.fromJson(e.classDetails));break;case c.Cleric:t.clericCtor(o.ClericDetails.fromJson(e.classDetails));break;case c.Druid:t.druidCtor(o.DruidDetails.fromJson(e.classDetails));break;case c.Fighter:t.fighterCtor(o.FighterDetails.fromJson(e.classDetails));break;case c.Monk:t.monkCtor(o.MonkDetails.fromJson(e.classDetails));break;case c.Paladin:t.paladinCtor(o.PaladinDetails.fromJson(e.classDetails));break;case c.Ranger:t.rangerCtor(o.RangerDetails.fromJson(e.classDetails));break;case c.Rogue:t.rogueCtor(o.RogueDetails.fromJson(e.classDetails));break;case c.Sorcerer:t.sorcererCtor(o.SorcererDetails.fromJson(e.classDetails));break;case c.Warlock:t.warlockCtor(o.WarlockDetails.fromJson(e.classDetails));break;case c.Wizard:t.wizardCtor(o.WizardDetails.fromJson(e.classDetails))}return t}}var c;t.Class=l,function(e){e.Barbarian="Barbarian",e.Bard="Bard",e.Cleric="Cleric",e.Druid="Druid",e.Fighter="Fighter",e.Monk="Monk",e.Paladin="Paladin",e.Ranger="Ranger",e.Rogue="Rogue",e.Sorcerer="Sorcerer",e.Warlock="Warlock",e.Wizard="Wizard"}(c=t.ClassKind||(t.ClassKind={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(11);class r{constructor(e=[new a(o.Acrobatics,!1,i.AbilityKind.Dexterity),new a(o.AnimalHandling,!1,i.AbilityKind.Wisdom),new a(o.Athletics,!1,i.AbilityKind.Strength),new a(o.Arcana,!1,i.AbilityKind.Intelligence),new a(o.Deception,!1,i.AbilityKind.Charisma),new a(o.History,!1,i.AbilityKind.Intelligence),new a(o.Insight,!1,i.AbilityKind.Wisdom),new a(o.Intimidation,!1,i.AbilityKind.Charisma),new a(o.Investigation,!1,i.AbilityKind.Intelligence),new a(o.Medicine,!1,i.AbilityKind.Wisdom),new a(o.Nature,!1,i.AbilityKind.Intelligence),new a(o.Perception,!1,i.AbilityKind.Wisdom),new a(o.Performance,!1,i.AbilityKind.Charisma),new a(o.Persuasion,!1,i.AbilityKind.Charisma),new a(o.Religion,!1,i.AbilityKind.Intelligence),new a(o.SleightOfHand,!1,i.AbilityKind.Dexterity),new a(o.Stealth,!1,i.AbilityKind.Dexterity),new a(o.Survival,!1,i.AbilityKind.Wisdom)]){this.skills=e}isEnabled(e){if(!this.skills)return!1;let t=this.skills.filter(t=>t.kind==e);return t.length>0&&t[0].enabled}map(e){return this.skills.map(e)}set(e,t){let n=this.skills.findIndex(t=>t.kind==e);n>-1&&(this.skills[n].enabled=t)}static fromJson(e){return new r(e.skills.map(a.fromJson))}}t.Skills=r;class a{constructor(e,t,n){this.kind=e,this.enabled=t,this.modifier=n}static from(e){return new a(e.kind,e.enabled,e.modifier)}get desc(){switch(this.kind){case o.Acrobatics:return`Dealing with difficult physical situations like tumbling or balancing on a ledge, modified by ${this.modifier}`;case o.AnimalHandling:return`Your ability to communicate with animals like calming your mount or interpreting your dog's needs, modified by ${this.modifier}`;case o.Arcana:return`This represents your knowledge about all things magic, modified by ${this.modifier}`;case o.Athletics:return`Physical situations that might be an olympic individual competition like long/high jump or swimming, modified by ${this.modifier}`;case o.Deception:return`Your ability to hide information from someone else, modified by ${this.modifier}`;case o.History:return`Your ability to recall important things from the past, modified by ${this.modifier}`;case o.Insight:return`Your ability to see through deception, modified by ${this.modifier}`;case o.Intimidation:return`Your ability to scare someone into doing what you want, modified by ${this.modifier}`;case o.Investigation:return`Your ability to discern the information you need from the resources in front of you, modified by ${this.modifier}`;case o.Medicine:return`Your ability to stabilize someone who's below 0 HP, modified by ${this.modifier}`;case o.Nature:return`You knowledge of the natural world, modified by ${this.modifier}`;case o.Perception:return`Your ability to notice something in your current environment, modified by ${this.modifier}`;case o.Performance:return`Your ability to entertain a crowd, modified by ${this.modifier}`;case o.Persuasion:return`Your ability to influence someone else's decision, modified by ${this.modifier}`;case o.Religion:return`Your knowledge about the gods and their worshipers, modified by ${this.modifier}`;case o.SleightOfHand:return`When you want to do something with your hands discretely enough that someone else doesn't see/feel it like card tricks or pick pocketing, modified by ${this.modifier}`;case o.Stealth:return`When you want to remain hidden, modified by ${this.modifier}`;case o.Survival:return`Anything Bear Grills would need to do to survive, modified by ${this.modifier}`;default:return""}}copy(){return a.from(this)}static fromJson(e){return new a(e.kind,e.enabled,e.modifier)}}var o;t.Skill=a,function(e){e.Acrobatics="Acrobatics",e.AnimalHandling="Animal Handling",e.Arcana="Arcana",e.Athletics="Athletics",e.Deception="Deception",e.History="History",e.Insight="Insight",e.Intimidation="Intimidation",e.Investigation="Investigation",e.Medicine="Medicine",e.Nature="Nature",e.Perception="Perception",e.Performance="Performance",e.Persuasion="Persuasion",e.Religion="Religion",e.SleightOfHand="Sleight Of Hand",e.Stealth="Stealth",e.Survival="Survival"}(o=t.SkillKind||(t.SkillKind={}))},,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(12),r=n(26),a=n(11),o=n(28);class s{constructor(e=l.Human,t=null){switch(this.name=e,this.size=i.CharacterSize.Medium,this.speed=30,this.weaponProfs=[],this.toolProfs=[],this.languages=[],this.armorProfs=[],this.miscBenefits=[],this.bonusLanguages=0,this.naturalWeapons=[new i.Weapon("Left Fist",i.WeaponType.Melee,i.WeaponKind.Martial,i.WeaponDamageKind.Bludgeoning,i.WeaponWeight.Light,i.WeaponHandedness.One,[1,4]),new i.Weapon("Right Fist",i.WeaponType.Melee,i.WeaponKind.Martial,i.WeaponDamageKind.Bludgeoning,i.WeaponWeight.Light,i.WeaponHandedness.One,[1,4])],e==l.Dragonborn&&null==t&&(t=f.Black),this.checkSubRace(t),this.subRace=t,e){case l.Dwarf:this.dwarfCtor();break;case l.Elf:this.elfCtor();break;case l.Halfling:this.halflingCtor();break;case l.Human:this.humanCtor();break;case l.Dragonborn:this.dragonbornCtor();break;case l.Gnome:this.gnomeCtor();break;case l.HalfElf:this.halfElfCtor();break;case l.HalfOrc:this.halfOrcCtor();break;case l.Tiefling:this.tieflingCtor()}}dwarfCtor(){this.abilityModifiers=[[a.AbilityKind.Constitution,2]],this.subRace==c.Hill&&this.abilityModifiers.push([a.AbilityKind.Wisdom,1]),this.subRace==c.Mountain&&this.abilityModifiers.push([a.AbilityKind.Strength,2]),this.ageRange=[50,350],this.preferredAlignment=new i.Alignment(i.AlignmentMajor.Lawful,i.AlignmentMinor.Good),this.heightRange=[new i.Height(4,0),new i.Height(5,0)],this.size=i.CharacterSize.Medium,this.avgWeight=150,this.speed=25,this.darkVision=new r.Range(60),this.weaponProfs=[i.StdWeaponName.Battleaxe,i.StdWeaponName.HandAxe,i.StdWeaponName.ThrowingHammer,i.StdWeaponName.WarHammer],this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Dwarvish],this.miscBenefits=["Your speed is not reduced by wearing heavy armor","Stonecunning: +1 on Int (History) checks about Stonework"],this.subRace==c.Hill&&this.miscBenefits.push("+1 max HP at each level"),this.subRace==c.Mountain&&(this.armorProfs=[i.ArmorWeight.Light,i.ArmorWeight.Medium])}elfCtor(){this.abilityModifiers=[[a.AbilityKind.Dexterity,2]],this.subRace==u.High&&this.abilityModifiers.push([a.AbilityKind.Intelligence,1]),this.subRace==u.Wood&&this.abilityModifiers.push([a.AbilityKind.Wisdom,1]),this.subRace==u.Drow&&this.abilityModifiers.push([a.AbilityKind.Charisma,1]),this.ageRange=[100,750],this.preferredAlignment=new i.Alignment(i.AlignmentMajor.Chaotic,this.subRace==u.Drow?i.AlignmentMinor.Evil:i.AlignmentMinor.Good),this.heightRange=[new i.Height(5,0),new i.Height(6,0)],this.avgWeight=130,this.size=i.CharacterSize.Medium,this.speed=30,this.darkVision=new r.Range(60),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Elvish],this.miscBenefits=["Keen Senses: Proficiency in perception","Fey Ancestry: Advantage against being charmed and magic cannot be put to sleep","Trance: Instead of sleeping you meditate for 4 hours"],this.subRace==u.High&&(this.weaponProfs=[i.StdWeaponName.LongBow,i.StdWeaponName.LongSword,i.StdWeaponName.ShortBow,i.StdWeaponName.ShortSword],this.miscBenefits.push("Cantrip: You know one Cantrip of your choice from lhe wizard spell list"),this.bonusLanguages=1),this.subRace==u.Wood&&(this.weaponProfs=[i.StdWeaponName.LongBow,i.StdWeaponName.LongSword,i.StdWeaponName.ShortBow,i.StdWeaponName.ShortSword],this.speed=35,this.miscBenefits.push("Mask of the Wild: You can attempt to hide even when you are only lightly obscured by foliage, heavy rain, falling snow, mist, and other natural phenomena.")),this.subRace==u.Drow&&(this.darkVision=new r.Range(120),this.miscBenefits.push("Sun Light Sensitivity: You have disadvantage on attack rolls and on Wisdom (Perception) checks that rely on sight when you, the target of your attack, or whatever you are trying to perceive is in direct sunlight"),this.miscBenefits.push("Drow Magic: You know the dancing lights Cantrip. At level 3 you can cas Faerie Fire once per day, at level 5 you can cast Darkness once per day Charisma is your spell casting ability"),this.weaponProfs=[i.StdWeaponName.ShortSword,i.StdWeaponName.Rapier,i.StdWeaponName.HandCrossbow])}halflingCtor(){this.abilityModifiers=[[a.AbilityKind.Dexterity,2]],this.heightRange=[new i.Height(2,6),new i.Height(3,6)],this.avgWeight=40,this.preferredAlignment=i.Alignment.LawfulGood(),this.speed=25,this.size=i.CharacterSize.Small,this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Halfling],this.ageRange=[20,175],this.miscBenefits=["Lucky: When you roll a 1 on an attack roll, ability check, or saving throw, you can reroll the die and must use the new roll","Brave: Vou have advantage on saving throws against being frightened","Halfling Nimbleness: You can move through the space of any creature that is of a size larger than yours"],this.subRace==h.Lightfoot&&(this.abilityModifiers.push([a.AbilityKind.Charisma,1]),this.miscBenefits.push("Naturally Stealthy: You can attempt to hide even when you are obscured only by a creature that is at least one size larger than you")),this.subRace==h.Stout&&(this.abilityModifiers.push([a.AbilityKind.Constitution,1]),this.miscBenefits.push("Stout Resilience: You have advantage on saving throws against poison, and you have resistance against poison damage"))}humanCtor(){this.abilityModifiers=[[a.AbilityKind.Strength,1],[a.AbilityKind.Dexterity,1],[a.AbilityKind.Constitution,1],[a.AbilityKind.Intelligence,1],[a.AbilityKind.Wisdom,1],[a.AbilityKind.Charisma,1]],this.ageRange=[16,90],this.preferredAlignment=i.Alignment.TrueNeutral(),this.heightRange=[new i.Height(5,0),new i.Height(7,0)],this.avgWeight=150,this.speed=30,this.languages=[i.NormalLanguage.Common],this.bonusLanguages=1}dragonbornCtor(){let e,t,n;switch(this.abilityModifiers=[[a.AbilityKind.Strength,2]],this.ageRange=[15,80],this.preferredAlignment=i.Alignment.NeutralGood(),this.heightRange=[new i.Height(6,0),new i.Height(9,0)],this.avgWeight=250,this.size=i.CharacterSize.Medium,this.speed=30,this.subRace){case f.Black:case f.Copper:t=new r.Range(30),this.damageResistance=e=i.WeaponDamageKind.Acid,n="Dex save";break;case f.Blue:case f.Bronze:t=new r.Range(30),this.damageResistance=e=i.WeaponDamageKind.Lightening,n="Dex save";break;case f.Brass:case f.Gold:case f.Red:t=this.subRace==f.Brass?new r.Range(30):new r.Range(15),this.damageResistance=e=i.WeaponDamageKind.Fire,n="Dex save";break;case f.Green:t=new r.Range(15),this.damageResistance=e=i.WeaponDamageKind.Poison,n="Con save";break;case f.Silver:case f.White:t=new r.Range(15),this.damageResistance=e=i.WeaponDamageKind.Cold,n="Con save"}this.naturalWeapons.push(new i.Weapon("Breath Weapon",i.WeaponType.Melee,i.WeaponKind.Natural,e,null,null,[2,6],t,0,null,!1,n)),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Draconic]}gnomeCtor(){this.abilityModifiers=[[a.AbilityKind.Intelligence,2]],"Forest"==this.subRace&&this.abilityModifiers.push([a.AbilityKind.Dexterity,1]),"Rock"==this.subRace&&this.abilityModifiers.push([a.AbilityKind.Constitution,1]),this.ageRange=[17,500],this.preferredAlignment=i.Alignment.NeutralGood(),this.heightRange=[new i.Height(3,0),new i.Height(4,0)],this.avgWeight=40,this.size=i.CharacterSize.Small,this.speed=25,this.darkVision=new r.Range(60),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Gnomish],this.miscBenefits=["Gnome Cunning: You have advantage on all Int, Wis, & Cha saving throws against magic"],this.subRace==d.Forest&&this.miscBenefits.push("Natural Illusionist: You know the minor illusion Cantrip. Intelligence is your spell casting ability","Speak with Small Beasts: You can communicate with small or smaller beasts"),this.subRace==d.Rock&&(this.toolProfs=[o.ArtisanTools.Tinker],this.miscBenefits.push("Artificer's Lore: Whenever you make an Intelligence (History) check related to magic items, alchemical objects, ar technological devices, you can add twice your proficiency bonus, instead of any proficiency bonus you normally appIy","Tinker: You can create 1 clockwork device (AC5, 1hp) it takes 1 hour and 10 gp. \nClockwork Toy: animal, monster or person (i.e. mouse, dragon, soldier). It moves 5 feet each turn and makes noises appropriate to the creature it represents\nFire Starter: A lighter\nMusic Box: When opened it plays a single song an moderate volume, stops when song ends/is closed\n"))}halfElfCtor(){this.abilityModifiers=[[a.AbilityKind.Charisma,2]],this.ageRange=[20,180],this.preferredAlignment=i.Alignment.ChaoticGood(),this.heightRange=[new i.Height(5,0),new i.Height(6,0)],this.avgWeight=160,this.size=i.CharacterSize.Medium,this.speed=25,this.darkVision=new r.Range(60),this.bonusLanguages=1,this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Elvish],this.miscBenefits=["Skill Versatility: You gain proficiency in two skills of your choice","Fey Ancestry: Advantage against being charmed and magic cannot be put to sleep"]}halfOrcCtor(){this.abilityModifiers=[[a.AbilityKind.Strength,2],[a.AbilityKind.Constitution,1]],this.ageRange=[14,75],this.preferredAlignment=i.Alignment.ChaoticGood(),this.heightRange=[new i.Height(5,0),new i.Height(8,0)],this.avgWeight=200,this.size=i.CharacterSize.Medium,this.speed=30,this.darkVision=new r.Range(60),this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Orc],this.miscBenefits=["Menacing: You gain proficiency in the Intimidation skill","Savage Attacks: When you score a critical hit with a melee weapon attack you add 1 hit die to the damage role as bonus damage"]}tieflingCtor(){this.abilityModifiers=[[a.AbilityKind.Intelligence,1],[a.AbilityKind.Charisma,2]],this.ageRange=[16,120],this.preferredAlignment=i.Alignment.ChaoticEvil(),this.heightRange=[new i.Height(5,0),new i.Height(7,0)],this.avgWeight=160,this.speed=30,this.darkVision=new r.Range(60),this.damageResistance=i.WeaponDamageKind.Fire,this.languages=[i.NormalLanguage.Common,i.NormalLanguage.Infernal],this.miscBenefits=["Infernal Legacy: You know the thaumaturgy cantrip. Once you reach 3rd level, you can cast the hellish rebuke spell once per day as a 2nd-level spell. Once you reach 5th level, you can also cast the darkness spell once per day. Charisma is your spell casting ability for these spells."]}checkSubRace(e){if((e==d.Rock||e==d.Forest)&&this.name!=l.Gnome||(e==u.Drow||e==u.High||e==u.Wood)&&this.name!=l.Elf||(e==c.Hill||e==c.Mountain)&&this.name!=l.Dwarf||(e==h.Lightfoot||e==h.Stout)&&this.name!=l.Halfling||(e==f.Black||e==f.Blue||e==f.Brass||e==f.Bronze||e==f.Copper||e==f.Gold||e==f.Green||e==f.Red||e==f.Silver||e==f.White)&&this.name!=l.Dragonborn)throw new Error(`Subrace ${e} isn't compatible with ${this.name}`);if(!e&&this.name==l.Dragonborn)throw new Error("Dragonborn must pick an ancestry")}static fromJson(e){return new s(e.name,e.subRace)}}var l,c,u,h,d,f;t.Race=s,function(e){e.Dwarf="Dwarf",e.Elf="Elf",e.Halfling="Halfling",e.Human="Human",e.Dragonborn="Dragonborn",e.Gnome="Gnome",e.HalfElf="Half-Elf",e.HalfOrc="Half-Orc",e.Tiefling="Tiefling"}(l=t.RaceKind||(t.RaceKind={})),function(e){e.Hill="Hill",e.Mountain="Mountain"}(c=t.Dwarf||(t.Dwarf={})),function(e){e.Drow="Drow",e.Wood="Wood",e.High="High"}(u=t.Elf||(t.Elf={})),function(e){e.Stout="Stout",e.Lightfoot="Lightfoot"}(h=t.Halfling||(t.Halfling={})),function(e){e.Forest="Forest",e.Rock="Rock"}(d=t.Gnome||(t.Gnome={})),function(e){e.Black="Black",e.Blue="Blue",e.Brass="Brass",e.Bronze="Bronze",e.Copper="Copper",e.Gold="Gold",e.Green="Green",e.Red="Red",e.Silver="Silver",e.White="White"}(f=t.Dragon||(t.Dragon={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15),r=n(28),a=Object.getOwnPropertyNames(r.GamingSet).map(e=>r.GamingSet[e]),o=Object.getOwnPropertyNames(r.Instrument).map(e=>r.Instrument[e]),s=Object.getOwnPropertyNames(r.ArtisanTools).map(e=>r.ArtisanTools[e]),l=Object.getOwnPropertyNames(r.Mount).map(e=>r.Mount[e]).concat(Object.getOwnPropertyNames(r.Vehicle).map(e=>r.Vehicle[e])).concat(Object.getOwnPropertyNames(r.Boat).map(e=>r.Boat[e]));class c{constructor(e,t=[],n=[],i=[],r=[]){this.kind=e,this.skills=t,this.languages=n,this.toolProficiencies=i,this.toolOptions=r}static Acolyte(){return new c(u.Acolyte,[i.SkillKind.Insight,i.SkillKind.Religion],[null,null],[],[])}static Charlatan(){return new c(u.Charlatan,[i.SkillKind.Deception,i.SkillKind.SleightOfHand],[],[r.MiscTools.Disguise,r.MiscTools.Forgery])}static Criminal(){return new c(u.Criminal,[i.SkillKind.Deception,i.SkillKind.Stealth],[],[r.MiscTools.Thieves,null],[null,a])}static Entertainer(){return new c(u.Entertainer,[i.SkillKind.Acrobatics,i.SkillKind.Performance],[],[r.MiscTools.Disguise,null],[null,o])}static FolkHero(){return new c(u.FolkHero,[i.SkillKind.AnimalHandling,i.SkillKind.Survival],[],[null,null],[s,l])}static GuildArtisan(){return new c(u.GuildArtisan,[i.SkillKind.Insight,i.SkillKind.Persuasion],[null],[null],[s])}static Hermit(){return new c(u.Hermit,[i.SkillKind.Medicine,i.SkillKind.Religion],[null],[r.MiscTools.Herbalism],[])}static Noble(){return new c(u.Noble,[i.SkillKind.History,i.SkillKind.Persuasion],[null],[null],[a])}static Outlander(){return new c(u.Outlander,[i.SkillKind.Athletics,i.SkillKind.Survival],[null],[null],[o])}static Sage(){return new c(u.Sage,[i.SkillKind.Arcana,i.SkillKind.History],[null,null],[],[])}static Sailor(){return new c(u.Sailor,[i.SkillKind.Athletics,i.SkillKind.Perception],[],[r.MiscTools.Navigator,null],[null,Object.getOwnPropertyNames(r.Boat).map(e=>r.Boat[e])])}static Soldier(){return new c(u.Soldier,[i.SkillKind.Athletics,i.SkillKind.Intimidation],[],[null,null],[a,Object.getOwnPropertyNames(r.Vehicle).map(e=>r.Vehicle[e])])}static Urchin(){return new c(u.Urchin,[i.SkillKind.SleightOfHand,i.SkillKind.Stealth],[],[r.MiscTools.Disguise,r.MiscTools.Thieves],[])}static fromJson(e){return new c(e.kind,e.skills,e.languages,e.toolProficiencies,e.toolOptions)}}var u;t.Background=c,function(e){e.Acolyte="Acolyte",e.Charlatan="Charlatan",e.Criminal="Criminal",e.Entertainer="Entertainer",e.FolkHero="Folk Hero",e.GuildArtisan="Guild Artisan",e.Hermit="Hermit",e.Noble="Noble",e.Outlander="Outlander",e.Sage="Sage",e.Sailor="Sailor",e.Soldier="Soldier",e.Urchin="Urchin"}(u=t.BackgroundKind||(t.BackgroundKind={})),t.ACOLYTE_TRAITS=["I idolize a particular hero of my faith, and constantly refer to that person's deeds and example,","I can find common ground between lhe fiercest enemies, empathizing with them and always working toward peace.","I see omens in every event and action. The gods try to speak to us we just need lo listen","Nothing can shake my optimistic attitude.","I quote (or misquote) sacred texts and proverbs in almost every situation.","I am tolerant (or intolerant) of other faiths and respect (or condemn) the worship of other gods.","I've enjoyed fine food, drink, and high society among my temple's elite. Rough living grates on me.","I've spent so long in the tem pie that I have little practical experience dealing with people in the outside world."],t.ACOLYTE_IDEALS=["Tradition. lhe ancient traditions of worship and sacrifice must be preserved and upheld. (Lawful)","Charily. I always try to help those in need, no matter what the personal cost. (Good)","Change. We must help bring about the changes lhe gods are constantly working in the world. (Chaotic)","Power. I hope to one day rise to the top of my faith's religious hierarchy. (Lawful)","Faith. I trust that my deity will guide my actions. I have faith that if I work hard, things will go well. (Lawful)","Aspiration. I seek lo prove myself worthy of my god's favor by matching my actions against his or her teachings. (Any)"],t.ACOLYTE_BONDS=["I would die to recover an ancient relic of my faith that was lost long ago.","I will someday get revenge on the corrupt temple hierarchy who branded me a heretic.","I owe my life to the priest who took me in when my parents died.","Everything I do is for the common people.","I will do anything lo protect the tem pie where I served.","I seek to preserve a sacred text that my enemies consider heretical and seek to destroy."],t.ACOLYTE_FLAWS=["I judge others harshly, and myself even more severely.","I put roo much trust in those who wield power within my temple's hierarchy.","My piety sometimes leads me lo blindly trust those that profess faith in my god.","I am inflexible in my thinking.","I am suspicious af strangers and expect the worst of them.","Once I pick a goal, I become obsessed with it to the detriment of everything else in my life."],t.CHARLATAN_TRAITS=[],t.CHARLATAN_IDEALS=[],t.CHARLATAN_BONDS=[],t.CHARLATAN_FLAWS=[],t.ALL_BACKGROUNDS=[c.Acolyte(),c.Charlatan(),c.Criminal(),c.Entertainer(),c.FolkHero(),c.GuildArtisan(),c.Hermit(),c.Noble(),c.Outlander(),c.Sage(),c.Sailor(),c.Soldier(),c.Urchin()]},,,,,function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,s)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),a=n(19),o=n(13),s=n(20),l=n(39),c=n(40);t.Data=class{constructor(){this.db=new u}getCharacters(){return i(this,void 0,void 0,function*(){return this.db.ready||(yield this.db.init()),yield this.db.allCharacters()})}addCharacter(e){return i(this,void 0,void 0,function*(){yield this.db.addCharacter(e)})}saveCharacter(e){return i(this,void 0,void 0,function*(){yield this.db.saveCharacters([e])})}saveCharacters(e){return i(this,void 0,void 0,function*(){return this.db.ready||(yield this.db.init()),yield this.db.saveCharacters(e)})}getSpellsForClass(e){return i(this,void 0,void 0,function*(){return this.db.spellsForClass(e)})}static getAllClasses(){return Object.getOwnPropertyNames(o.ClassKind).map(e=>o.ClassKind[e])}static getAllRaces(){return Object.getOwnPropertyNames(a.RaceKind).map(e=>a.RaceKind[e])}static subRaceFor(e){switch(e){case a.RaceKind.Elf:return Object.getOwnPropertyNames(a.Elf).map(e=>a.Elf[e]);case a.RaceKind.Dwarf:return Object.getOwnPropertyNames(a.Dwarf).map(e=>a.Dwarf[e]);case a.RaceKind.Gnome:return Object.getOwnPropertyNames(a.Gnome).map(e=>a.Gnome[e]);case a.RaceKind.Halfling:return Object.getOwnPropertyNames(a.Halfling).map(e=>a.Halfling[e]);case a.RaceKind.Dragonborn:return Object.getOwnPropertyNames(a.Dragon).map(e=>a.Dragon[e]);default:return null}}static getAllBackground(){return[s.Background.Acolyte(),s.Background.Charlatan(),s.Background.Criminal(),s.Background.Entertainer(),s.Background.FolkHero(),s.Background.GuildArtisan(),s.Background.Hermit(),s.Background.Noble(),s.Background.Outlander(),s.Background.Sage(),s.Background.Sailor(),s.Background.Soldier(),s.Background.Urchin()]}static levelForExp(e){return e<300?1:e<900?2:e<2700?3:e<6500?4:e<14e3?5:e<23e3?6:e<34e3?7:e<48e3?8:e<64e3?9:e<85e3?10:e<1e5?11:e<12e4?12:e<14e4?13:e<165e3?14:e<195e3?15:e<225e3?16:e<265e3?17:e<305e3?18:e<355e3?19:20}static proficiencyBonusFor(e){return e<5?2:e<9?3:e<13?4:e<17?5:6}static averageHpFor(e){switch(e){case o.ClassKind.Barbarian:return 7;case o.ClassKind.Fighter:case o.ClassKind.Paladin:case o.ClassKind.Ranger:return 6;case o.ClassKind.Bard:case o.ClassKind.Cleric:case o.ClassKind.Druid:case o.ClassKind.Rogue:case o.ClassKind.Warlock:return 5;case o.ClassKind.Sorcerer:case o.ClassKind.Wizard:return 4}}static startingWealthFor(e){let t=10,n=0;switch(e){case o.ClassKind.Barbarian:case o.ClassKind.Druid:n=2;break;case o.ClassKind.Sorcerer:n=3;break;case o.ClassKind.Rogue:case o.ClassKind.Warlock:case o.ClassKind.Wizard:n=4;break;default:n=5;case o.ClassKind.Monk:t=1}let i=0;for(var a=0;a<n;a++)i+=Math.floor(4*Math.random())+1;return new r.Wealth(0,0,0,i*t,0)}};class u extends c.default{constructor(){super("DnDCharacterManager"),this.ready=!1,this.version(1).stores({seeds:"++id",characters:"++id,name",bardSpells:"++id,name",clericSpells:"++id,name",druidSpells:"++id,name",paladinSpells:"++id,name",rangerSpells:"++id,name",rogueSpells:"++id,name",sorcererSpells:"++id,name",warlockSpells:"++id,name",wizardSpells:"++id,name"})}init(){return i(this,void 0,void 0,function*(){console.info("checking for seeds"),0===(yield this.seeds.count())&&(console.info("no seeds... seeding"),yield this.seed()),this.ready=!0})}seed(){return i(this,void 0,void 0,function*(){try{let e=yield Promise.resolve().then(()=>n(33));yield e.seed(this)}catch(e){throw console.error("error seeding",e),e}})}allCharacters(){return i(this,void 0,void 0,function*(){return(yield this.characters.toArray()).map(r.Character.fromJson)})}addCharacter(e){return i(this,void 0,void 0,function*(){try{yield this.characters.add(e)}catch(t){console.error("failed to add character",t,e)}})}saveCharacters(e){return i(this,void 0,void 0,function*(){try{yield this.characters.bulkPut(e)}catch(t){console.error("Failed to save characters",t,e)}})}spellsForClass(e){return i(this,void 0,void 0,function*(){try{switch(e){case o.ClassKind.Bard:return(yield this.bardSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Cleric:return(yield this.clericSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Druid:return(yield this.druidSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Paladin:return(yield this.paladinSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Ranger:return(yield this.rangerSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Rogue:return(yield this.rogueSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Sorcerer:return(yield this.sorcererSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Warlock:return(yield this.warlockSpells.toArray()).map(l.Spell.fromJson);case o.ClassKind.Wizard:return(yield this.wizardSpells.toArray()).map(l.Spell.fromJson);default:return[]}}catch(t){console.error("failed to get spells for ",e,t)}})}}t.Database=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t=null){this.first=e,this.second=t}metaString(){return this.second?`${this.first}/${this.second}`:this.first.toString()}static fromJson(e){return e?new i(e.first||0,e.second):null}}t.Range=i},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Alchemist="Alchemist's Supplies",e.Brewer="Brewer's Supplies ",e.Calligrapher="Calligrapher's Supplies ",e.Carpenter="Carpenter's Tools",e.Cartographer="Cartographer's Tools",e.Cobbler="Cobbler's Tools",e.Cook="Cook's Utensils ",e.Glassblower="Glassblower's Tools",e.Jeweler="Jeweler's Tools",e.Leatherworker="Leatherworker's Tools",e.Mason="Mason's Tools",e.Painter="Painter's Supplies",e.Potter="Potter's Tools",e.Smith="Smith's Tools",e.Tinker="Tinker's Tools",e.Weaver="Weaver's Tools",e.Woodcarver="Woodcarver's Tools"}(t.ArtisanTools||(t.ArtisanTools={})),function(e){e.Dice="Dice Set",e.Dragonchess="Dragonchess Set",e.PlayingCards="Playing Card Set",e.ThreeDragonAnte="Three-Dragon Ante Set"}(t.GamingSet||(t.GamingSet={})),function(e){e.Bagpipes="Bagpipes",e.Drum="Drum",e.Dulcimer="Dulcimer",e.Flute="Flute",e.Lute="Lute ",e.Lyre="Lyre",e.Horn="Horn",e.Pan="Pan Flute",e.Shawm="Shawm",e.Viol="Viol"}(t.Instrument||(t.Instrument={})),function(e){e.Disguise="Disguise Kit",e.Forgery="Forgery Kit",e.Herbalism="Herbalism Kit",e.Navigator="Navigator's Tools",e.Poisoner="Poisoner's Kit",e.Thieves="Thieves' Tools"}(t.MiscTools||(t.MiscTools={})),function(e){e.Camel="Camel",e.Donkey="Donkey",e.Elephant="Elephant",e.DraftHorse="Horse (draft)",e.Horse="Horse (riding)",e.Mastiff="Mastiff",e.Pony="Pony",e.Warhorse="Warhorse"}(t.Mount||(t.Mount={})),function(e){e.Carriage="Carriage",e.Cart="Cart",e.Chariot="Chariot",e.Sled="Sled",e.Wagon="Wagon"}(t.Vehicle||(t.Vehicle={})),function(e){e.Galley="Galley",e.Keelboat="Keelboat",e.Longship="Longship",e.Rowboat="Rowboat",e.Sailing="Sailing",e.Warship="Warship"}(t.Boat||(t.Boat={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(13),r=n(38);class a{constructor(e,t=null,n=[]){this.level=e,this.primalPath=t,this.totem=n}static fromJson(e){return new a(e.level,e.primalPath,e.totem)}notes(e){e||(e=this.level);let t=[new r.Note("Rage",`${this.dailyRages} times daily, you rage for 1 minute (10 rounds)`,`You can enter into a rage a certain number of times depending on your level. \n            During that time you have the following benefits.\n            - Advantage on Strength Checks,\n            - +${this.rageDamage} damage on Strength based attacks,\n            - Resistance to bludgeoning, piercing and slashing damage (halve damage)\n            A rage last for 1 minute which is 10 round of combat, you can be forced to end your rage early in one of the following situations.\n            - You do not attempt to attack an opponent on your turn\n            - You are knocked unconscious\n            Rages are only regained after a long rest`),new r.Note("Unarmored Defense","When not wearing armor your AC = 10 + DEX + CON (can use shield)","When not wearing any armor your calculate your Armor Class by adding your dexterity and constitution modifiers to 10.\n                    If you are carrying a shield add the bonus from that as well.")];return e>1&&(t.push(new r.Note("Reckless Attack","Your first attack on a turn can be declared reckless giving you advantage on attack rolls that use strength but attack rolls against you have the advantage until the rest of your turn","")),t.push(new r.Note("Danger Sense","You have the advantage on DEX saving throws against effects you an see",""))),e>2&&(t.push(new r.Note("Primal Path",this.pathDesc(),"")),this.primalPath&&t.push(...this.pathNotes())),e>3&&e<8&&t.push(new r.Note("Bonus Ability Scores","2","")),e>7&&e<12&&t.push(new r.Note("Bonus Ability Scores","4","")),e>11&&e<16&&t.push(new r.Note("Bonus Ability Scores","6","")),e>15&&e<19&&t.push(new r.Note("Bonus Ability Scores","8","")),e>18&&t.push(new r.Note("Bonus Ability Scores","10","")),e>4&&(t.push(new r.Note("Extra Attack","You can attack twice on your turn","")),t.push(new r.Note("Fast Movement","Add 10 to your movement speed",""))),e>6&&t.push(new r.Note("Feral Instinct","Advantage on Initiative rolls, if surprised at the beginning of combat you act normally on your first turn if you immediately rage","")),e>8&&t.push(new r.Note("Brutal Critical",`Add ${this.brutalCriticalDice} to your critical damage rolls`,"")),e>10&&t.push(new r.Note("Relentless Rage","If you drop to 0HP you can make a CON save to drop to 1, DC starts at 10 and goes up by 5 for each attempt per day","")),e>14&&t.push(new r.Note("Persistent Rage","Rage no longer ends early if you don't attack an enemy your turn","")),e>17&&t.push(new r.Note("Indomitable Might","If your total for a STR check is less than your STR score you can use your STR score instead","")),e>19&&t.push(new r.Note("Primal Champion","Add 4 to your STR and CON scores (max 24)","")),t}pathDesc(){return this.primalPath?this.primalPath:"Choose between Berserker or Totem Warrior"}pathNotes(){let e=[];switch(this.primalPath){case o.Berserker:this.level>2&&e.push(new r.Note("Frenzy","While raging you can go into a frenzy, each turn after you get a single melee attack as a bonus action. (1 level of Exhaustion when rage ends see PHB 291)","")),this.level>5&&e.push(new r.Note("Mindless Rage","Can't be charmed or frightened while raging","")),this.level>9&&e.push(new r.Note("Intimidating Presence","Can use action to frighten someone DC 8 + proficiency bonus + CHA, failed attempt you can't use this again for 24 hours","")),this.level>13&&e.push(new r.Note("Retaliation","When you take damage from a creature within 5 feet of you you can make a melee weapon attack against that target",""));break;case o.TotemWarrior:return this.totemNotes()}return e}totemNotes(){let e=[];if(e.push("- Spirit Seeker: cast Beast Sense and Speak with Animals as Rituals"),this.totem.length>0)for(let t=0;t<this.totem.length;t++)switch(this.totem[t]){case s.Bear:e.push(this.bearNotes(t+1));break;case s.Eagle:e.push(this.eagleNotes(t+1));break;case s.Wolf:e.push(this.wolfNotes(t+1))}if(this.level>9){let t=this.totem[0]===this.totem[1]?this.totem[0]:`${this.totem[0]} or ${this.totem[1]}`;e.push(`- Spirit Walker You can cast commune with nature as a ritual (spirit will be ${t})`)}return e}bearNotes(e){return 1===e?new r.Note("Spirit Totem (Bear)","While raging you have resistance to all damage but psychic",""):2===e?new r.Note("Aspect of the Beast (Bear)","You double your carrying capacity and have advantage on STR checks to push, pull, lift or break objects",""):3===e?new r.Note("Totemic Attunement (Bear)","While raging enemies withing 5 feet of you have disadvantage on attack rolls against others (enemy must be able to see you can be frightened)",""):void 0}eagleNotes(e){return 1===e?new r.Note("Spirit Totem (Eagle)","While raging you can Dash as bonus action, enemies have disadvantage on opportunity attacks",""):2===e?new r.Note("Aspect of the Beast (Eagle)","You can see up to 1 mile with no difficulty as though it were 100 ft, dim light doesn't impose a disadvantage on perception checks",""):3===e?new r.Note("Totemic Attunement (Eagle)","While raging you have a flying speed equal to your current walking speed, if you end your turn in the air you fall",""):void 0}wolfNotes(e){return 1===e?new r.Note("Spirit Totem (Wolf)","While raging your friends have advantage on attack rolls against any creature within 5 ft of you",""):2===e?new r.Note("Aspect of the Beast (Wolf)","You can track at a fast pace, can move stealthily at normal pace",""):3===e?new r.Note("Totemic Attunement (Wolf)","While raging you can use a bonus action to knock a large (or smaller) creature prone after a successful hit with a melee weapon attack",""):void 0}get dailyRages(){return this.level<3?2:this.level<6?3:this.level<12?4:this.level<17?5:this.level<20?6:1/0}get rageDamage(){return this.level<9?2:this.level<16?3:4}get brutalCriticalDice(){return this.level<9?0:this.level<13?1:this.level<17?2:3}}var o,s,l,c,u;t.BarbarianDetails=a,function(e){e.Berserker="Berserker",e.TotemWarrior="Totem Warrior"}(o=t.PrimalPath||(t.PrimalPath={})),function(e){e.Bear="Bear",e.Eagle="Eagle",e.Wolf="Wolf"}(s=t.Totem||(t.Totem={}));class h{constructor(e,t=null,n=[]){this.level=e,this.bardCollege=t,this.expertise=n}notes(){let e=[new r.Note("Spell Casting","Your music and/or voice is imbued with magic","Your music and/or voice is imbued with magic.\n                    This magic can support and inspire allies or deflate and hurt foes."),new r.Note("Bardic Inspiration",`You can bestow a 1d${this.bardicInspirationDie} on any ally equal to your DEX mod per day, this die can be used to augment and skill, attack or saving roll before or after the roll. Must be declared before DM says it was successful or not, must be used within 10 minutes`,"You can doll out inspiration like a currency boosting the dice rolls of your allies.\n                    The number of times you can do this and how powerful the effect is increases as you level.\n                    Any inspired ally must use this effect within 10 minutes.\n                    You regain this ability after a long rest.")];return this.level>1&&(e.push(new r.Note("Jack of All Trades","Add half your proficiency bonus (rounded down) to any ability check that doesn't include your proficiency bonus","")),e.push(new r.Note("Song of Rest",`You can sing/orate during a short rest, all allies gain an additional ${this.songOfRestDice} HP`,""))),this.level>2&&(e.push(new r.Note("Bard College",this.collegeDesc(),"")),e.push(...this.collegeNotes()),e.push(new r.Note("Expertise","Double your proficiency bonus on 2 skills",""))),this.level>3&&this.level<8&&e.push(new r.Note("Bonus Ability Scores","2","")),this.level>7&&this.level<12&&e.push(new r.Note("Bonus Ability Scores","4","")),this.level>11&&this.level<16&&e.push(new r.Note("Bonus Ability Scores","6","")),this.level>15&&this.level<19&&e.push(new r.Note("Bonus Ability Scores","8","")),this.level>18&&e.push(new r.Note("Bonus Ability Scores","10","")),this.level>4&&e.push(new r.Note("Font of Inspiration","You regain all expended uses of Bardic Inspiration when you finish a short of long rest","")),this.level>5&&e.push(new r.Note("Counter-charm","You can use music or words to disrupt mind-influencing effects as an action on your turn, during which you and any allies within 30 ft have the advantage on saving throws again fear or charm","")),this.level>9&&e.push(new r.Note("Magical Secrets",`You can choose to add ${this.magicalSecrets} spells from any spell book to your know spells so long as it meets your caster level`,"")),this.level>19&&e.push(new r.Note("Superior Inspiration","When your roll initiative and have no Bardic Inspiration left you regain one","")),e}get bardicInspirationDie(){return this.level<5?6:this.level>10?8:this.level<15?10:12}get magicalSecrets(){let e=0;return this.level>5&&this.bardCollege===l.Lore&&(e+=2),this.level>9&&(e+=2),this.level>13&&(e+=2),this.level>17&&(e+=2),e}collegeDesc(){return this.bardCollege?this.bardCollege:"Choose between the College of Lore or Valor"}collegeNotes(){let e=[];switch(this.bardCollege){case l.Lore:this.level>2&&(e.push(new r.Note("Bonus Proficiencies","Become proficient in 3 additional skills","")),e.push(new r.Note("Cutting Words","When an enemy within 30 feet makes an attack roll you can use a Bardic Inspiration roll to remove that number of points from their roll",""))),this.level>5&&e.push(new r.Note("Additional Magical Secrets","You gain 2 new spells from any spell book, these do not count against your known spells","")),this.level>13&&e.push(new r.Note("Peerless Skill","You can use Bardic Inspiration on yourself",""));case l.Valor:this.level>2&&e.push(new r.Note("Bonus Proficiencies","Become proficient in Medium Armor, Shields, and Martial Weapons","")),this.level>5&&e.push(new r.Note("Extra Attack","If you attack on your action you can attack twice","")),this.level>13&&e.push(new r.Note("Battle Magic","When you use a bard spell on your action you can attack as a bonus action",""))}return e}get songOfRestDice(){return 1===this.level?"no":this.level<9?"1d6":this.level<13?"1d8":this.level<17?"1d10":"1d12"}cantripsKnown(){return this.level<4?2:this.level<10?3:4}spellsKnown(){if(this.level<10)return this.level+3;switch(this.level){case 10:return 14;case 11:case 12:return 15;case 13:return 16;case 14:return 18;case 15:case 16:return 19;case 17:return 20;default:return 22}}spellSlots(){switch(this.level){case 1:return[2,0,0,0,0,0,0,0,0];case 2:return[3,0,0,0,0,0,0,0,0];case 3:return[4,2,0,0,0,0,0,0,0];case 4:return[4,3,0,0,0,0,0,0,0];case 5:return[4,3,2,0,0,0,0,0,0];case 6:return[4,3,3,0,0,0,0,0,0];case 7:return[4,3,3,1,0,0,0,0,0];case 8:return[4,3,3,2,0,0,0,0,0];case 9:return[4,3,3,3,1,0,0,0,0];case 10:return[4,3,3,3,2,0,0,0,0];case 11:case 12:return[4,3,3,3,2,1,0,0,0];case 13:case 14:return[4,3,3,3,2,1,1,0,0];case 15:case 16:return[4,3,3,3,2,1,1,1,0];case 17:return[4,3,3,3,2,1,1,1,1];case 18:return[4,3,3,3,3,1,1,1,1];case 19:return[4,3,3,3,3,2,1,1,1];case 20:return[4,3,3,3,3,2,2,1,1]}}static fromJson(e){return new h(e.level,e.barbCollege,e.expertise)}}t.BardDetails=h,function(e){e.Lore="College of Lore",e.Valor="College of Valor"}(l=t.BardCollege||(t.BardCollege={}));class d{constructor(e,t){this.level=e,this.domain=t}notes(){let e=[new r.Note("Spell Casting","Your religious pursuits have enable you to wield magic","Your god has betrothed you the ability to wield magic, this gift does not come unchecked, your available spells are restricted by the god you worship."),new r.Note("Divine Domain",this.domainDesc(),this.longDomainDesc())];return this.level>2&&(e.push(new r.Note("Channel Divinity",`You can channel energy directly from your god ${this.channels} times before resting`,"Your connection to the divine is so strong that you are able to act as a conduit for your god's will.\n                    A certain number of times per day between long or short rests you can invoke a prayer that will impact the world around you.")),e.push(...this.availableChannels())),this.level>3&&this.level<8&&e.push(new r.Note("Bonus Ability Scores","2","")),this.level>7&&this.level<12&&e.push(new r.Note("Bonus Ability Scores","4","")),this.level>11&&this.level<16&&e.push(new r.Note("Bonus Ability Scores","6","")),this.level>15&&this.level<19&&e.push(new r.Note("Bonus Ability Scores","8","")),this.level>18&&e.push(new r.Note("Bonus Ability Scores","10","")),e}get channels(){return this.level<6?1:this.level<18?2:3}availableChannels(){let e=[new r.Note("Channel Divinity - Turn Undead","Each undead that can hear you within 30 feet will spend the next 1 minute trying to get as far away from you as possible","")];return e.push(...this.domainChannels()),this.level>4&&e.push(new r.Note("Channel Divinity - Destroy Undead",`Successfully turning undead with a challenge ranting of ${this.destroyUndeadCR()} or lower destroys that creature`,"")),this.level>9&&e.push(new r.Note("Channel Divinity - Divine Intervention","You can choose to call on your deity for extreme intervention, roll your percentile dice, if the value is below your cleric level your deity intervenes (DM chooses the nature of the intervention) on success you must wait 7 days before using again on failure you must rest","")),e}destroyUndeadCR(){return this.level<8?.5:this.level<11?1:this.level<14?2:this.level<16?3:4}domainChannels(){switch(this.domain){case c.Knowledge:case c.Life:case c.Light:case c.Nature:case c.Tempest:case c.Trickery:case c.War:}return[]}domainDesc(){return this.domain?this.domain:"Choose between Knowledge, Life, Light, Nature, Tempest, Trickery, or War"}longDomainDesc(){switch(this.domain){case c.Knowledge:return"The gods of knowledge-including Gilean, Aureon,                     and Thoth-value learning and understanding above all.                     Some teach that knowledge is to be gathered and                     shared in libraries and universities, or promote                     the practical knowledge of craft and invention.                     Some deities hoard knowledge and keep its secrets                     to themselves. And some promise their followers                     that they will gain tremendous power if they                     unlock the secrets of the multiverse. Followers                     of these gods study esoteric lore, collect old                     tomes, delve into the secret places of the earth,                     and learn all they can to Some gods of knowledge                     promote the practical knowledge of craft and invention,                     including smith deities like Gond, Reorx, Onatar,                     Moradin, Hephaestus, and Goibhniu.";case c.Life:return"The Life domain focuses on the vibrant positive energy-one of the fundamental                     forces of the universe-that sustains all ife. The gods of life promote vitality and                     health through healing the sick and wounded, caring for those in need, and driving away                     the forces of death and undeath. Almost any non-evil deity can claim influence over this                     domain, particularly agricultural deities (such as Chauntea, Arawai, and Demeter), sun gods                     (such as Lathander, Pelor, and Re-Horakhty), gods of healing or endurance (such as IlIllatcr,                     Mishakal, Apollo, and Diancecht), and gods of home and community (such as Hestia, Hathor, and Boldrei).";case c.Light:return"Gods of light-including Helm, Lathander, Pholtus, Branchala, the Silver Flame, Belenus, Apollo, and Re-Horakty-                    promote the ideals of rebirth and renewal, truth, vigilance, adn beauty, often using the symbol of the sun. Some                     of these gods are portrayed as the sun itself or as a charioteer who guides the sun across the sky. Others                     are tireless sentinels whose eyes pierce every shadow and see through ever deception. Some are deities of beauty and                     artistry, who teach that art is a vehicle for the soul's improvement. Clerics of a god of light are enlightened souls                     infused with radiance and the power of their god's discerning vision, charged with chasing away lies and burning                     away darkness.";case c.Nature:return"Gods of nature are as varied as the natural world                     itself, from illscrutable gods of the deep forests (such                     as Silvanus, Obad-Hai, Chislev, Balinor, and Pan) to friendly                     deities associated with particular springs and groves (such as Eldath).                     Druids revere nature as a whole and might serve one of these deities,                     practicing mysterious rites and reciting all-but-forgotten prayers in                     their own secret tongue. But many of these gods have clerics as well,                     champions who take a more active role in advancing the interests of a                     particular nature god. These clerics might hunt the evil monstrosities                     that despoil the woodlands, bless the harvest of the faithful, or                     wither the crops of those who anger their gods.";case c.Tempest:return"Gods whose portfolios include the Tempest domain- including                     Talos, Umberlee, Kord, Zeboim, the Devourer, Zeus, and Thor-govern                     storms, sea, and sky. They include gods of lightning and thunder, gods                     of earthquakes, some tire gods, and certain gods of violence, physical                     strength, and courage. In some pantheons, a god of this domain rules over                     other deities and is known for swift justice delivered by thunderbolts.                     In the pantheons of seafaring people, gods of this domain are ocean                     deities and the patrons of sailors. Tempest gods send their clerics to                     inspire fear in the common folk, either to keep those folk on the path of                     righteousness or to encourage them to offer sacrifices of propitiation to                     ward off divine wrath.";case c.Trickery:return"Gods of trickery-such as Tymora, Beshaba, Olidammara, the Traveler,                     Garl Glittergold, and Loki-are mischief-makers and instigators who stand                     as a constant challenge to the accepted order among both gods and mortais.                     They're patrons of thieves, scoundrels, gamblers, rebels, and liberators.                     Their clerics are a disruptive force in the world, puncturing pride,                     mocking tyrants, stealing from the rich, freeing captives, and                     flouting hollow traditions. They prefer subterfuge, pranks, deception,                     and theft rather than direct confrontation.";case c.War:return"War has many manifestations. It can make heroes of ordinary people.                     It can be desperate and horrific, with acts of cruelty and cowardice                     eclipsing instances of excellence and courage. In either case,                     the gods of war watch over warriors and reward them for their great                     deeds. The clerics of such gods excel in battle, inspiring others                     to fight the good fight or offering acts of violence as prayers.                     Gods of war include champions of honor and chivalry (such as                     Torm, Heironeous, and Kiri-Jolith) as well as gods of                     destruction and pillage (such as Erythnul, the Fury,                     Gruumsh, and Ares) and gods of conquest and domination                     (such as Bane, Hextor, and Maglubiyet). Other war gods                     (such as Tempus, Nike, and Nuada) take a more neutral stance, promoting war                    in all its manifestations and supporting warriors in any circumstance.";default:return""}}domainNotes(){let e=[];switch(this.domain){case c.Knowledge:e.push(new r.Note("Knowledge Domain","You gain knowledge of 2 additional languages","")),this.level>7&&e.push(new r.Note("Potent Spellcasting","Add your WIS modifier cantrip spell damage","")),this.level>16&&e.push(new r.Note("Visions of the Past","",""))}return e}cantripsKnown(){return this.level<4?3:this.level<10?4:5}spellSlots(){switch(this.level){case 1:return[2,0,0,0,0,0,0,0,0];case 2:return[3,0,0,0,0,0,0,0,0];case 3:return[4,2,0,0,0,0,0,0,0];case 4:return[4,3,0,0,0,0,0,0,0];case 5:return[4,3,2,0,0,0,0,0,0];case 6:return[4,3,3,0,0,0,0,0,0];case 7:return[4,3,3,1,0,0,0,0,0];case 8:return[4,3,3,2,0,0,0,0,0];case 9:return[4,3,3,3,1,0,0,0,0];case 10:return[4,3,3,3,2,0,0,0,0];case 11:case 12:return[4,3,3,3,2,1,0,0,0];case 13:case 14:return[4,3,3,3,2,1,1,0,0];case 15:case 16:return[4,3,3,3,2,1,1,1,0];case 17:return[4,3,3,3,2,1,1,1,1];case 18:return[4,3,3,3,3,2,1,1,1];case 19:return[4,3,3,3,3,2,2,1,1]}}static fromJson(e){return new d(e.level,e.domain)}}t.ClericDetails=d,function(e){e.Knowledge="Knowledge",e.Life="Life",e.Light="Light",e.Nature="Nature",e.Tempest="Tempest",e.Trickery="Trickery",e.War="War"}(c=t.ClericDomain||(t.ClericDomain={}));class f{constructor(e,t){this.level=e,this.circle=t}notes(){let e=[new r.Note("Spell Casting","Your relationship with nature has enable you to wield magic.","Your relationship with nature has reach a point that allows you to manipulate the world around in extraordinary ways.")];return this.level>1&&new r.Note("Wild Shape",`You can turn into a beast with a challenge rating ${this.maxWildShapeCR()} or less 2 times between rests for up to ${this.maxWildShapeHours()} hours`,`You can turn into a beast with a challenge rating ${this.maxWildShapeCR()} or less 2 times between rests for up to ${this.maxWildShapeHours()} hours.\n                Transforming take an action.\n                ${this.wildShapeRestrictions()}\n                You take on the attributes and abilities of the beast except for the following.\n                - Alignment\n                - Personality\n                - Intelligence\n                - Wisdom\n                - Charisma\n                - You cannot use any legendary or lair actions of this beast.\n                You're are forced to revert if knocked unconscious.\n                While in beast form you cannot cast spells.\n                You can choose between the following three options for the items your are wearing.\n                - They drop where you transformed\n                - They merge into the beast\n                - The beast will be wearing them (note: the DM gets final vote on the practicality of this)`),e}maxWildShapeCR(){return this.level<4?.25:this.level<8?.5:1}maxWildShapeHours(){return Math.floor(this.level/2)}wildShapeRestrictions(){return this.level<4?"The beast cannot have a swim or flying speed":this.level<8?"The beast cannot have a flying speed":"No additional restrictions on the beast"}static fromJson(e){return new f(e.level,e.circle)}}t.DruidDetails=f,function(e){e.Land="Land",e.Moon="Moon"}(t.DruidCircle||(t.DruidCircle={}));class g{constructor(e,t){this.level=e,this.fightingStyle=t}notes(){return[]}static fromJson(e){return new g(e.level,e.fightingStyle)}}t.FighterDetails=g,function(e){e.Archery="Archery",e.Defense="Defense",e.Dueling="Dueling",e.GreatWeapon="Great Weapon Fighting",e.Protection="Protection",e.TwoWeapon="Two Weapon Fighting"}(t.FighterStyle||(t.FighterStyle={}));class m{constructor(e){this.level=e}notes(){return[]}static fromJson(e){return new m(e.level)}}t.MonkDetails=m;class p{constructor(e,t,n){this.level=e,this.fightingStyle=t,this.oath=n}notes(){return[]}static fromJson(e){return new p(e.level,e.fightingStyle,e.oath)}}t.PaladinDetails=p,function(e){e.Defense="Defense",e.Dueling="Dueling",e.GreatWeapon="Great Weapon Fighting",e.Protection="Protection"}(t.PaladinStyle||(t.PaladinStyle={})),function(e){e.Ancients="Ancients",e.Devotion="Devotion",e.Vengeance="Vengeance"}(t.PaladinOath||(t.PaladinOath={}));class y{constructor(e,t){this.level=e,this.favoredEnemy=t}notes(){return[]}static fromJson(e){return new y(e.level,e.favoredEnemy)}}t.RangerDetails=y,function(e){e.Aberration="Aberration",e.Beast="Beast",e.Celestial="Celestial",e.Construct="Construct",e.Dragon="Dragon",e.Elemental="Elemental",e.Fey="Fey",e.Fiend="Fiend",e.Giant="Giant",e.Monstrosity="Monstrosity",e.Ooze="Ooze",e.Plant="Plant",e.Undead="Undead"}(t.RangerEnemy||(t.RangerEnemy={}));class v{constructor(e=1,t,n=[],r=i.DEFAULT_BONUS_ABILITY_SCORES){this.level=e,this.archType=t,this.expertise=n,this.bonusAbilityScores=r}notes(){let e=[];return e.push(new r.Note("Expertise",`Double ${this.expertiseNumber()} proficiency bonus`,"")),e.push(new r.Note("Sneak Attack",`Add ${this.sneakAttackDice()}d6 to DMG rolls with advantage or another aly within 5 feet of enemy`,"")),e.push(new r.Note("Thieves Cant","Secret rogue slang language","")),this.level>2&&(e.push(new r.Note("Cunning Action","Bonus action of Dash, Disengage, or Hide on any combat turn","")),e.push(new r.Note("Roguish ArchType",`${this.archTypeDesc()}`,"")),e.push(...this.archTypeDetails())),this.level>3&&this.level<8&&e.push(new r.Note("Bonus Ability Scores","2","")),this.level>7&&this.level<12&&e.push(new r.Note("Bonus Ability Scores","4","")),this.level>11&&this.level<16&&e.push(new r.Note("Bonus Ability Scores","6","")),this.level>15&&this.level<19&&e.push(new r.Note("Bonus Ability Scores","8","")),this.level>18&&e.push(new r.Note("Bonus Ability Scores:","0","")),this.level>4&&e.push(new r.Note("Uncanny Dodge","you can use your reaction to halve the attack's damage against you (must be able to see attacker)","")),this.level>6&&e.push(new r.Note("Evasion","AOEs that a dex save would halve damage, you take no damage on success and half if failed","")),this.level>10&&e.push(new r.Note("Reliable Talent","On skills that include proficiency bonus any roll 9 or less is counted as 10","")),this.level>13&&e.push(new r.Note("Blind Sense","If you can hear you are aware of any hidden or invisible creature within 10 feet","")),this.level>17&&e.push(new r.Note("Elusive","No attack roll has advantage against you unless incapacitated","")),this.level>19&&e.push(new r.Note("Stroke of Luck","Once a day you can convert any failed skill roll into a 20 or missed attack into a hit","")),e}expertiseNumber(){return this.level<6?2:4}archTypeDesc(){return this.archType?this.archType:"Choose between Thief, Assassin, and Arcane Trickster"}archTypeDetails(){let e=[];switch(this.archType){case u.Thief:this.level>2&&(e.push("- Bonus Cunning Actions: Disarm Trap, Open Lock, Use Object"),e.push("- Second Story Work: Climb without movement penalty")),this.level>8&&e.push("- Supreme Sneak: Advantage on Stealth when moving 1/2 your speed"),this.level>12&&e.push("- Use Magic Device: Ignore all Class, Race and Level requirements when using a magic item"),this.level>16&&e.push("- Thief's Reflexes: You take 2 turns on the first round of combat (Second turn at Initiative - 10, cannot use when surprised)");break;case u.Assassin:this.level>2&&(e.push("- Bonus Proficiencies: Poisoner's and Disguise Kit"),e.push("- Assassinate: Advantage against enemies who have not taken a turn; surprise always crits")),this.level>8&&e.push("- Infiltration Expertise: You can unfailingly create false identities (see PH:97 for details)"),this.level>12&&e.push("- Imposter: Unerringly mimic another person's speech, writing, and behavior (see PH:97 for details)"),this.level>16&&e.push("- Death Strike: Surprised Attacks must also make a CON save (8 + DEX + Prof), failed saves double damage");break;case u.ArcaneTrickster:}return e}sneakAttackDice(){return Math.ceil(this.level/2)}allowedBonusAbilityScores(){return this.level<4?0:this.level<8?2:this.level<10?4:this.level<12?6:this.level<16?8:this.level<19?10:12}static fromJson(e){return new v(e.level,e.archType,e.expertise,e.bonusAbilityScores)}}t.RogueDetails=v;class b{constructor(e,t,n){this.level=e,this.metaMagic=t,this.origins=n}notes(){return[]}static fromJson(e){return new b(e.level,e.metaMagic,e.origins)}}t.SorcererDetails=b,function(e){e.Carful="Carful",e.Distant="Distant",e.Empowered="Empowered",e.Extended="Extended",e.Heightened="Heightened",e.Quickened="Quickened",e.Subtle="Subtle",e.Twinned="Twinned"}(t.MetaMagic||(t.MetaMagic={})),function(e){e.DraconicAncestor="DraconicAncestor",e.Wild="Wild"}(t.SorcererOrigins||(t.SorcererOrigins={}));class w{constructor(e,t){this.level=e,this.patron=t}notes(){return[]}static fromJson(e){return new w(e.level,e.patron)}}t.WarlockDetails=w,function(e){e[e.ArchFey=0]="ArchFey",e[e.Fiend=1]="Fiend",e[e.GreatOldOne=2]="GreatOldOne"}(t.OtherworldlyPatron||(t.OtherworldlyPatron={}));class S{constructor(e,t){this.level=e,this.arcaneTradition=t}notes(){return[]}static fromJson(e){return new S(e.level,e.arcaneTradition)}}t.WizardDetails=S,function(e){e.Abjuration="Abjuration",e.Conjuration="Conjuration",e.Divination="Divination",e.Enchantment="Enchantment",e.Evocation="Evocation",e.Illusion="Illusion",e.Necromancy="Necromancy",e.Transmutation="Transmutation"}(t.ArcaneTradition||(t.ArcaneTradition={})),function(e){e.Thief="Thief",e.Assassin="Assassin",e.ArcaneTrickster="Arcane Trickster"}(u=t.RoguishArchType||(t.RoguishArchType={}))},,function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=s(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new g(e,t)),1!==c.length||u||s(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,s)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=n(30),a=n(15),o=n(12),s=n(26),l=n(11),c=n(19),u=n(13),h=n(20),d=n(28);t.seed=function(e){return i(this,void 0,void 0,function*(){let t=yield fetch(window.location.href+"spellBook.json").then(e=>e.text()).then(e=>JSON.parse(e));console.info("seeding characters"),yield e.characters.bulkPut(function(){let e=new o.Character("Daggers",new l.AbilityScores([new l.AbilityScore(8,l.AbilityKind.Strength),new l.AbilityScore(15,l.AbilityKind.Dexterity),new l.AbilityScore(8,l.AbilityKind.Constitution),new l.AbilityScore(8,l.AbilityKind.Intelligence),new l.AbilityScore(9,l.AbilityKind.Wisdom),new l.AbilityScore(15,l.AbilityKind.Charisma)]),new c.Race(c.RaceKind.Human),new u.Class(u.ClassKind.Rogue,4,[[l.AbilityKind.Strength,0],[l.AbilityKind.Dexterity,2],[l.AbilityKind.Constitution,0],[l.AbilityKind.Intelligence,0],[l.AbilityKind.Wisdom,0],[l.AbilityKind.Charisma,0]],[a.SkillKind.Acrobatics,a.SkillKind.SleightOfHand,a.SkillKind.Persuasion,a.SkillKind.Perception]),new h.Background(h.BackgroundKind.Criminal,[a.SkillKind.Stealth,a.SkillKind.Deception],[],[d.MiscTools.Thieves,d.GamingSet.Dragonchess]),o.Alignment.TrueNeutral(),5116,new o.Height(5,8),160,"Blue",0,new o.Armor(o.LightArmor.Leather,o.ArmorWeight.Light,2),null,new a.Skills,[new o.Weapon("Dagger",o.WeaponType.Melee,o.WeaponKind.Simple,o.WeaponDamageKind.Piercing,o.WeaponWeight.Light,o.WeaponHandedness.One,[1,4],new s.Range(5),1,new s.Range(20,60),!1,!0),new o.Weapon("Short Bow",o.WeaponType.Range,o.WeaponKind.Simple,o.WeaponDamageKind.Piercing,o.WeaponWeight.Light,o.WeaponHandedness.Two,[1,6],new s.Range(80,320),1,null,!0,!1)],new o.Wealth(0,0,0,3450,0),[o.NormalLanguage.Common],[],0,0,[new o.MagicItem("Cloak of Elvenkind","Hood up: Preception checks to see you have disadvantage, stealth checks have advantage"),new o.MagicItem("Goggles of Night","Darkvision (60 feet)")],[new o.ExpendableItem(1,"Health Pot.","heal 2d4+2 Damage")]),t=e.characterClass.classDetails;return t.archType=r.RoguishArchType.Thief,t.expertise.push(a.SkillKind.Deception,a.SkillKind.Stealth),[e]}()),console.info("seeding bard spells"),yield e.clericSpells.bulkPut(t.bard),console.info("seeding cleric spells"),yield e.clericSpells.bulkPut(t.cleric),console.info("seeding druid spells"),yield e.druidSpells.bulkPut(t.druid),console.info("seeding paladin spells"),yield e.paladinSpells.bulkPut(t.paladin),console.info("seeding ranger spells"),yield e.rangerSpells.bulkPut(t.ranger),console.info("seeding rogue spells"),yield e.rogueSpells.bulkPut(t.rogue),console.info("seeding sorcerer spells"),yield e.sorcererSpells.bulkPut(t.sorcerer),console.info("seeding warlock spells"),yield e.warlockSpells.bulkPut(t.warlock),console.info("seeding wizard spells"),yield e.wizardSpells.bulkPut(t.wizard),console.info("seeding seeds"),yield e.seeds.put({when:(new Date).toISOString()})})}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Note=class{constructor(e,t,n){this.name=e,this.shortDesc=t,this.longDesc=n}toString(){return`${this.name}: ${this.shortDesc}`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=[]){this.spells=e}map(e){return this.spells.map(e)}static fromJson(e){return new i(e.spells.map(r.fromJson))}}t.Spells=i,function(e){e.AcidSplash="Acid Splash",e.BladeWard="Blade Ward",e.ChillTouch="Chill Touch",e.DancingLights="Dancing Lights",e.Druidcraft="Druidcraft",e.EldritchBlast="Eldritch Blast",e.FireBolt="Fire Bolt",e.Friends="Friends",e.Guidance="Guidance",e.Light="Light",e.MageHand="Mage Hand",e.Mending="Mending",e.Message="Message",e.MinorIllusion="Minor Illusion",e.PoisonSpray="Poison Spray",e.Prestidigitation="Prestidigitation",e.ProduceFlame="Produce Flame",e.RayOfFrost="Ray of Frost",e.Resistance="Resistance",e.SacredFlame="Sacred Flame",e.Shillelagh="Shillelagh",e.ShockingGrasp="Shocking Grasp",e.SpareTheDying="Spare the Dying",e.Thaumaturgy="Thaumaturgy",e.ThornWhip="Thorn Whip",e.TrueStrike="True Strike",e.ViciousMockery="Vicious Mockery",e.Alarm="Alarm",e.AnimalFriendship="Animal Friendship",e.ArmorOfAgathys="Armor of Agathys",e.ArmsOfHadar="Arms of Hadar",e.Bane="Bane",e.Bless="Bless",e.BurningHands="Burning Hands",e.CharmPerson="Charm Person",e.ChromaticOrb="Chromatic Orb",e.ColorSpray="Color Spray",e.Command="Command",e.CompelledDuel="Compelled Duel",e.ComprehendLanguages="Comprehend Languages",e.CreateOrDestroyWater="Create or Destroy Water",e.CureWounds="Cure Wounds",e.DetectEvilAndGood="Detect Evil and Good",e.DetectMagic="Detect Magic",e.DetectPoisonAndDisease="Detect Poison and Disease",e.DisguiseSelf="Disguise Self",e.DissonantWhispers="Dissonant Whispers",e.DivineFavor="Divine Favor",e.EnsnaringStrike="Ensnaring Strike",e.Entangle="Entangle",e.ExpeditiousRetreat="Expeditious Retreat",e.FaerieFire="Faerie Fire",e.FalseLife="False Life",e.FeatherFall="Feather Fall",e.FindFamiliar="Find Familiar",e.FogCloud="Fog Cloud",e.Goodberry="Goodberry",e.Grease="Grease",e.GuidingBolt="Guiding Bolt",e.HailOfThorns="Hail of Thorns",e.HealingWord="Healing Word",e.HellishRebuke="Hellish Rebuke",e.Heroism="Heroism",e.Hex="Hex",e.HuntersMark="Hunter's Mark",e.Identify="Identify",e.IllusoryScript="Illusory Script",e.InflictWounds="Inflict Wounds",e.Jump="Jump",e.Longstrider="Longstrider",e.MageArmor="Mage Armor",e.MagicMissile="Magic Missile",e.ProtectionFromEvilAndGood="Protection from Evil and Good",e.PurifyFoodAndDrink="Purify Food and Drink",e.RayOfSickness="Ray of Sickness",e.Sanctuary="Sanctuary",e.SearingSmite="Searing Smite",e.Shield="Shield",e.ShieldOfFaith="Shield of Faith",e.SilentImage="Silent Image",e.Sleep="Sleep",e.SpeakWithAnimals="Speak with Animals",e.TashasHideousLaughter="Tasha's Hideous Laughter",e.TensersFloatingDisk="Tenser's Floating Disk",e.ThunderousSmite="Thunderous Smite",e.Thunderwave="Thunderwave",e.UnseenServant="Unseen Servant",e.WitchBolt="Witch Bolt",e.WrathfulSmite="Wrathful Smite",e.Aid="Aid",e.AlterSelf="Alter Self",e.AnimalMessenger="Animal Messenger",e.ArcaneLock="Arcane Lock",e.Augury="Augury",e.Barkskin="Barkskin",e.BeastSense="Beast Sense",e.BlindnessDeafness="Blindness/Deafness",e.Blur="Blur",e.BrandingSmite="Branding Smite",e.CalmEmotions="Calm Emotions",e.CloudOfDaggers="Cloud of Daggers",e.ContinualFlame="Continual Flame",e.CordonOfArrows="Cordon of Arrows",e.CrownOfMadness="Crown of Madness",e.Darkness="Darkness",e.Darkvision="Darkvision",e.DetectThoughts="Detect Thoughts",e.EnhanceAbility="Enhance Ability",e.EnlargeReduce="Enlarge/Reduce",e.Enthrall="Enthrall",e.FindSteed="Find Steed",e.FindTraps="Find Traps",e.FlameBlade="Flame Blade",e.FlamingSphere="Flaming Sphere",e.GentleRepose="Gentle Repose",e.GustOfWind="Gust of Wind",e.HeatMetal="Heat Metal",e.HoldPerson="Hold Person",e.Invisibility="Invisibility",e.Knock="Knock",e.LesserRestoration="Lesser Restoration",e.Levitate="Levitate",e.LocateAnimalsOrPlants="Locate Animals or Plants",e.LocateObject="Locate Object",e.MagicMouth="Magic Mouth",e.MagicWeapon="Magic Weapon",e.MelfsAcidArrow="Melf's Acid Arrow",e.MirrorImage="Mirror Image",e.MistyStep="Misty Step",e.Moonbeam="Moonbeam",e.NystulsMagicAura="Nystul's Magic Aura",e.PassWithoutTrace="Pass Without Trace",e.PhantasmalForce="Phantasmal Force",e.PrayerOfHealing="Prayer of Healing",e.ProtectionFromPoison="Protection from Poison",e.RayOfEnfeeblement="Ray of Enfeeblement",e.RopeTrick="Rope Trick",e.ScorchingRay="Scorching Ray",e.SeeInvisibility="See Invisibility",e.Shatter="Shatter",e.Silence="Silence",e.SpiderClimb="Spider Climb",e.SpikeGrowth="Spike Growth",e.SpiritualWeapon="Spiritual Weapon",e.Suggestion="Suggestion",e.WardingBond="Warding Bond",e.Web="Web",e.ZoneOfTruth="Zone of Truth",e.AnimateDead="Animate Dead",e.AuraOfVitality="Aura of Vitality",e.BeaconOfHope="Beacon of Hope",e.BestowCurse="Bestow Curse",e.BlindingSmite="Blinding Smite",e.Blink="Blink",e.CallLightning="Call Lightning",e.Clairvoyance="Clairvoyance",e.ConjureAnimals="Conjure Animals",e.ConjureBarrage="Conjure Barrage",e.Counterspell="Counterspell",e.CreateFoodAndWater="Create Food and Water",e.CrusadersMantle="Crusader's Mantle",e.Daylight="Daylight",e.DispelMagic="Dispel Magic",e.ElementalWeapon="Elemental Weapon",e.Fear="Fear",e.FeignDeath="Feign Death",e.Fireball="Fireball",e.Fly="Fly",e.GaseousForm="Gaseous Form",e.GlyphOfWarding="Glyph of Warding",e.Haste="Haste",e.HungerOfHadar="Hunger of Hadar",e.HypnoticPattern="Hypnotic Pattern",e.LeomundsTinyHut="Leomund's Tiny Hut",e.LightningArrow="Lightning Arrow",e.LightningBolt="Lightning Bolt",e.MagicCircle="Magic Circle",e.MajorImage="Major Image",e.MassHealingWord="Mass Healing Word",e.MeldIntoStone="Meld into Stone",e.Nondetection="Nondetection",e.PhantomSteed="Phantom Steed",e.PlantGrowth="Plant Growth",e.ProtectionFromEnergy="Protection from Energy",e.RemoveCurse="Remove Curse",e.Revivify="Revivify",e.Sending="Sending",e.SleetStorm="Sleet Storm",e.Slow="Slow",e.SpeakWithDead="Speak with Dead",e.SpeakWithPlants="Speak with Plants",e.SpiritGuardians="Spirit Guardians",e.StinkingCloud="Stinking Cloud",e.Tongues="Tongues",e.VampiricTouch="Vampiric Touch",e.WaterBreathing="Water Breathing",e.WaterWalk="Water Walk",e.WindWall="Wind Wall",e.ArcaneEye="Arcane Eye",e.AuraOfLife="Aura of Life",e.AuraOfPurity="Aura of Purity",e.Banishment="Banishment",e.Blight="Blight",e.Compulsion="Compulsion",e.Confusion="Confusion",e.ConjureMinorElementals="Conjure Minor Elementals",e.ConjureWoodlandBeings="Conjure Woodland Beings",e.ControlWater="Control Water",e.DeathWard="Death Ward",e.DimensionDoor="Dimension Door",e.Divination="Divination",e.DominateBeast="Dominate Beast",e.EvardsBlackTentacles="Evard's Black Tentacles",e.Fabricate="Fabricate",e.FireShield="Fire Shield",e.FreedomOfMovement="Freedom of Movement",e.GiantInsect="Giant Insect",e.GraspingVine="Grasping Vine",e.GreaterInvisibility="Greater Invisibility",e.GuardianOfFaith="Guardian of Faith",e.HallucinatoryTerrain="Hallucinatory Terrain",e.IceStorm="Ice Storm",e.LeomundsSecretChest="Leomund's Secret Chest",e.LocateCreature="Locate Creature",e.MordenkainensFaithfulHound="Mordenkainen's Faithful Hound",e.MordenkainensPrivateSanctum="Mordenkainen's Private Sanctum",e.OtilukesResilientSphere="Otiluke's Resilient Sphere",e.PhantasmalKiller="Phantasmal Killer",e.Polymorph="Polymorph",e.StaggeringSmite="Staggering Smite",e.StoneShape="Stone Shape",e.Stoneskin="Stoneskin",e.WallOfFire="Wall of Fire",e.AnimateObjects="Animate Objects",e.AntilifeShell="Antilife Shell",e.Awaken="Awaken",e.BanishingSmite="Banishing Smite",e.BigbysHand="Bigby's Hand",e.CircleOfPower="Circle of Power",e.Cloudkill="Cloudkill",e.Commune="Commune",e.CommuneWithNature="Commune with Nature",e.ConeOfCold="Cone of Cold",e.ConjureElemental="Conjure Elemental",e.ConjureVolley="Conjure Volley",e.ContactOtherPlane="Contact Other Plane",e.Contagion="Contagion",e.Creation="Creation",e.DestructiveWave="Destructive Wave",e.DispelEvilAndGood="Dispel Evil and Good",e.DominatePerson="Dominate Person",e.Dream="Dream",e.FlameStrike="Flame Strike",e.Geas="Geas",e.GreaterRestoration="Greater Restoration",e.Hallow="Hallow",e.HoldMonster="Hold Monster",e.InsectPlague="Insect Plague",e.LegendLore="Legend Lore",e.MassCureWounds="Mass Cure Wounds",e.Mislead="Mislead",e.ModifyMemory="Modify Memory",e.Passwall="Passwall",e.PlanarBinding="Planar Binding",e.RaiseDead="Raise Dead",e.RarysTelepathicBond="Rary's Telepathic Bond",e.Reincarnate="Reincarnate",e.Scrying="Scrying",e.Seeming="Seeming",e.SwiftQuiver="Swift Quiver",e.Telekinesis="Telekinesis",e.TeleportationCircle="Teleportation Circle",e.TreeStride="Tree Stride",e.WallOfForce="Wall of Force",e.WallOfStone="Wall of Stone",e.ArcaneGate="Arcane Gate",e.BladeBarrier="Blade Barrier",e.ChainLightning="Chain Lightning",e.CircleOfDeath="Circle of Death",e.ConjureFey="Conjure Fey",e.Contingency="Contingency",e.CreateUndead="Create Undead",e.Disintegrate="Disintegrate",e.DrawmijsInstantSummon="Drawmij's Instant Summon",e.Eyebite="Eyebite",e.FindThePath="Find the Path",e.FleshToStone="Flesh to Stone",e.Forbiddance="Forbiddance",e.GlobeOfInvulnerability="Globe of Invulnerability",e.GuardsAndWards="Guards and Wards",e.Harm="Harm",e.Heal="Heal",e.HeroesFeast="Heroes' Feast",e.MagicJar="Magic Jar",e.MassSuggestion="Mass Suggestion",e.MoveEarth="Move Earth",e.OtilukesFreezingSphere="Otiluke's Freezing Sphere",e.OttosIrresistibleDance="Otto's Irresistible Dance",e.PlanarAlly="Planar Ally",e.ProgrammedIllusion="Programmed Illusion",e.Sunbeam="Sunbeam",e.TransportViaPlants="Transport via Plants",e.TrueSeeing="True Seeing",e.WallOfIce="Wall of Ice",e.WallOfThorns="Wall of Thorns",e.WindWalk="Wind Walk",e.WordOfRecall="Word of Recall",e.ConjureCelestial="Conjure Celestial",e.DelayedBlastFireball="Delayed Blast Fireball",e.DivineWord="Divine Word",e.Etherealness="Etherealness",e.FingerOfDeath="Finger of Death",e.FireStorm="Fire Storm",e.Forcecage="Forcecage",e.MirageArcane="Mirage Arcane",e.MordenkainensMagnificentMansion="Mordenkainen's Magnificent Mansion",e.MordenkainensSword="Mordenkainen's Sword",e.PlaneShift="Plane Shift",e.PrismaticSpray="Prismatic Spray",e.ProjectImage="Project Image",e.Regenerate="Regenerate",e.Resurrection="Resurrection",e.ReverseGravity="Reverse Gravity",e.Sequester="Sequester",e.Simulacrum="Simulacrum",e.Symbol="Symbol",e.Teleport="Teleport",e.AnimalShapes="Animal Shapes",e.AntimagicField="Antimagic Field",e.AntipathySympathy="Antipathy/Sympathy",e.Clone="Clone",e.ControlWeather="Control Weather",e.Demiplane="Demiplane",e.DominateMonster="Dominate Monster",e.Earthquake="Earthquake",e.Feeblemind="Feeblemind",e.Glibness="Glibness",e.HolyAura="Holy Aura",e.IncendiaryCloud="Incendiary Cloud",e.Maze="Maze",e.MindBlank="Mind Blank",e.PowerWordStun="Power Word Stun",e.Sunburst="Sunburst",e.Telepathy="Telepathy",e.Tsunami="Tsunami",e.AstralProjection="Astral Projection",e.Foresight="Foresight",e.Gate="Gate",e.Imprisonment="Imprisonment",e.MassHeal="Mass Heal",e.MeteorSwarm="Meteor Swarm",e.PowerWordHeal="Power Word Heal",e.PowerWordKill="Power Word Kill",e.PrismaticWall="Prismatic Wall",e.Shapechange="Shapechange",e.StormOfVengeance="Storm of Vengeance",e.TimeStop="Time Stop",e.TruePolymorph="True Polymorph",e.TrueResurrection="True Resurrection",e.Weird="Weird",e.Wish="Wish"}(t.SpellName||(t.SpellName={}));class r{constructor(e,t,n,i,r,a,o,s,l,c){this.name=e,this.level=t,this.verbalRequirement=n,this.somaticRequirement=i,this.materialRequirement=r,this.castingTime=a,this.desc=o,this.duration=s,this.range=l,this.save=c}static fromJson(e){let t=new r(e.name,e.level,e.verbalRequirement,e.somaticRequirement,e.materialRequirement,e.castingTime,e.desc,e.duration,e.range,a.fromJson(e.save));return t.id=e.id,t}}t.Spell=r;class a{constructor(e,t,n,i){this.ability=e,this.toBeat=t,this.ifBeaten=n,this.ifLost=i}static fromJson(e){if(e)return new a(e.ability,e.toBeat,e.ifBeaten,e.ifLost)}}t.SpellSave=a},function(e,t,n){"use strict";n.r(t),function(e,n){var i=Object.keys,r=Array.isArray,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:e;function o(e,t){return"object"!=typeof t?e:(i(t).forEach(function(n){e[n]=t[n]}),e)}var s=Object.getPrototypeOf,l={}.hasOwnProperty;function c(e,t){return l.call(e,t)}function u(e,t){"function"==typeof t&&(t=t(s(e))),i(t).forEach(function(n){d(e,n,t[n])})}var h=Object.defineProperty;function d(e,t,n,i){h(e,t,o(n&&c(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function f(e){return{from:function(t){return e.prototype=Object.create(t.prototype),d(e.prototype,"constructor",e),{extend:u.bind(null,e.prototype)}}}}var g=Object.getOwnPropertyDescriptor;var m=[].slice;function p(e,t,n){return m.call(e,t,n)}function y(e,t){return t(e)}function v(e){if(!e)throw new Error("Assertion Failed")}function b(e){a.setImmediate?n(e):setTimeout(e,0)}function w(e,t){return e.reduce(function(e,n,i){var r=t(n,i);return r&&(e[r[0]]=r[1]),e},{})}function S(e,t){return function(){try{e.apply(this,arguments)}catch(e){t(e)}}}function k(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}function A(e,t){if(c(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],i=0,r=t.length;i<r;++i){var a=A(e,t[i]);n.push(a)}return n}var o=t.indexOf(".");if(-1!==o){var s=e[t.substr(0,o)];return void 0===s?void 0:A(s,t.substr(o+1))}}function C(e,t,n){if(e&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){v("string"!=typeof n&&"length"in n);for(var i=0,r=t.length;i<r;++i)C(e,t[i],n[i])}else{var a=t.indexOf(".");if(-1!==a){var o=t.substr(0,a),s=t.substr(a+1);if(""===s)void 0===n?delete e[o]:e[o]=n;else{var l=e[o];l||(l=e[o]={}),C(l,s,n)}}else void 0===n?delete e[t]:e[t]=n}}function D(e){var t={};for(var n in e)c(e,n)&&(t[n]=e[n]);return t}var K=[].concat;function P(e){return K.apply([],e)}var W="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(P([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return a[e]}).map(function(e){return a[e]});function T(e){if(!e||"object"!=typeof e)return e;var t;if(r(e)){t=[];for(var n=0,i=e.length;n<i;++n)t.push(T(e[n]))}else if(W.indexOf(e.constructor)>=0)t=e;else for(var a in t=e.constructor?Object.create(e.constructor.prototype):{},e)c(e,a)&&(t[a]=T(e[a]));return t}function _(e,t,n,r){return n=n||{},r=r||"",i(e).forEach(function(i){if(c(t,i)){var a=e[i],o=t[i];"object"==typeof a&&"object"==typeof o&&a&&o&&""+a.constructor==""+o.constructor?_(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else n[r+i]=void 0}),i(t).forEach(function(i){c(e,i)||(n[r+i]=t[i])}),n}var x="undefined"!=typeof Symbol&&Symbol.iterator,B=x?function(e){var t;return null!=e&&(t=e[x])&&t.apply(e)}:function(){return null},M={};function N(e){var t,n,i,a;if(1===arguments.length){if(r(e))return e.slice();if(this===M&&"string"==typeof e)return[e];if(a=B(e)){for(n=[];!(i=a.next()).done;)n.push(i.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var O="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function I(e,t){O=e,R=t}var R=function(){return!0},H=!new Error("").stack;function E(){if(H)try{throw E.arguments,new Error}catch(e){return e}return new Error}function F(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(R).map(function(e){return"\n"+e}).join("")):""}var L=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],j=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(L),G={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function J(e,t){this._e=E(),this.name=e,this.message=t}function Y(e,t,n,i){this._e=E(),this.failures=t,this.failedKeys=i,this.successCount=n}function z(e,t){this._e=E(),this.name="BulkError",this.failures=t,this.message=function(e,t){return e+". Errors: "+t.map(function(e){return e.toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}(e,t)}f(J).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+F(this._e,2))}},toString:function(){return this.name+": "+this.message}}),f(Y).from(J),f(z).from(J);var U=j.reduce(function(e,t){return e[t]=t+"Error",e},{}),$=J,V=j.reduce(function(e,t){var n=t+"Error";function i(e,i){this._e=E(),this.name=n,e?"string"==typeof e?(this.message=e,this.inner=i||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=G[t]||n,this.inner=null)}return f(i).from($),e[t]=i,e},{});V.Syntax=SyntaxError,V.Type=TypeError,V.Range=RangeError;var q=L.reduce(function(e,t){return e[t+"Error"]=V[t],e},{});var Q=j.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=V[t]),e},{});function X(){}function Z(e){return e}function ee(e,t){return null==e||e===Z?t:function(n){return t(e(n))}}function te(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ne(e,t){return e===X?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var i=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?te(i,this.onsuccess):i),r&&(this.onerror=this.onerror?te(r,this.onerror):r),void 0!==a?a:n}}function ie(e,t){return e===X?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?te(n,this.onsuccess):n),i&&(this.onerror=this.onerror?te(i,this.onerror):i)}}function re(e,t){return e===X?t:function(n){var i=e.apply(this,arguments);o(n,i);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?te(r,this.onsuccess):r),a&&(this.onerror=this.onerror?te(a,this.onerror):a),void 0===i?void 0===s?void 0:s:o(i,s)}}function ae(e,t){return e===X?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function oe(e,t){return e===X?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var i=this,r=arguments.length,a=new Array(r);r--;)a[r]=arguments[r];return n.then(function(){return t.apply(i,a)})}return t.apply(this,arguments)}}Q.ModifyError=Y,Q.DexieError=J,Q.BulkError=z;var se={},le=100,ce=7,ue=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(t){var e=a.Promise;return e?[e.resolve(),e.prototype,e.resolve()]:[]}}(),he=ue[0],de=ue[1],fe=ue[2],ge=de&&de.then,me=he&&he.constructor,pe=ue[3],ye=!!fe,ve=!1,be=fe?function(){fe.then(Fe)}:a.setImmediate?n.bind(null,Fe):a.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){Fe(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Fe,0)},we=function(e,t){Te.push([e,t]),ke&&(be(),ke=!1)},Se=!0,ke=!0,Ae=[],Ce=[],De=null,Ke=Z,Pe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ct,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{ct(e[0],e[1])}catch(e){}})}},We=Pe,Te=[],_e=0,xe=[];function Be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=X,this._lib=!1;var t=this._PSD=We;if(O&&(this._stackHolder=E(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==se)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Oe(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,n){try{n(function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var i=t._lib&&Le();n&&"function"==typeof n.then?e(t,function(e,t){n instanceof Be?n._then(e,t):n.then(e,t)}):(t._state=!0,t._value=n,Ie(t)),i&&je()}},Oe.bind(null,t))}catch(e){Oe(t,e)}}(this,e)}var Me={get:function(){var e=We,t=qe;function n(n,i){var r=this,a=!e.global&&(e!==We||t!==qe);a&&et();var o=new Be(function(t,o){Re(r,new Ne(ot(n,e,a),ot(i,e,a),t,o,e))});return O&&Ee(o,this),o}return n.prototype=se,n},set:function(e){d(this,"then",e&&e.prototype===se?Me:{get:function(){return e},set:Me.set})}};function Ne(e,t,n,i,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i,this.psd=r}function Oe(e,t){if(Ce.push(t),null===e._state){var n=e._lib&&Le();t=Ke(t),e._state=!1,e._value=t,O&&null!==t&&"object"==typeof t&&!t._promise&&k(function(){var n=function e(t,n){var i;return g(t,n)||(i=s(t))&&e(i,n)}(t,"stack");t._promise=e,d(t,"stack",{get:function(){return ve?n&&(n.get?n.get.apply(t):n.value):e.stack}})}),function(e){Ae.some(function(t){return t._value===e._value})||Ae.push(e)}(e),Ie(e),n&&je()}}function Ie(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)Re(e,t[n]);var r=e._PSD;--r.ref||r.finalize(),0===_e&&(++_e,we(function(){0==--_e&&Ge()},[]))}function Re(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++_e,we(He,[n,e,t])}else e._listeners.push(t)}function He(e,t,n){try{De=t;var i,r=t._value;t._state?i=e(r):(Ce.length&&(Ce=[]),i=e(r),-1===Ce.indexOf(r)&&function(e){var t=Ae.length;for(;t;)if(Ae[--t]._value===e._value)return void Ae.splice(t,1)}(t)),n.resolve(i)}catch(e){n.reject(e)}finally{De=null,0==--_e&&Ge(),--n.psd.ref||n.psd.finalize()}}function Ee(e,t){var n=t?t._numPrev+1:0;n<le&&(e._prev=t,e._numPrev=n)}function Fe(){Le()&&je()}function Le(){var e=Se;return Se=!1,ke=!1,e}function je(){var e,t,n;do{for(;Te.length>0;)for(e=Te,Te=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}}while(Te.length>0);Se=!0,ke=!0}function Ge(){var e=Ae;Ae=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=xe.slice(0),n=t.length;n;)t[--n]()}function Je(e){return new Be(se,!1,e)}function Ye(e,t){var n=We;return function(){var i=Le(),r=We;try{return it(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{it(r,!1),i&&je()}}}u(Be.prototype,{then:Me,_then:function(e,t){Re(this,new Ne(null,null,e,t,We))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):Je(e)}):this.then(null,function(e){return e&&e.name===t?n(e):Je(e)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),Je(t)})},stack:{get:function(){if(this._stack)return this._stack;try{ve=!0;var e=function e(t,n,i){if(n.length===i)return n;var r="";if(!1===t._state){var a,o,s=t._value;null!=s?(a=s.name||"Error",o=s.message||s,r=F(s,0)):(a=s,o=""),n.push(a+(o?": "+o:"")+r)}O&&((r=F(t._stackHolder,2))&&-1===n.indexOf(r)&&n.push(r),t._prev&&e(t._prev,n,i));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{ve=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Be(function(i,r){var a=setTimeout(function(){return r(new V.Timeout(t))},e);n.then(i,r).finally(clearTimeout.bind(null,a))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Be.prototype,Symbol.toStringTag,"Promise"),Pe.env=rt(),u(Be,{all:function(){var e=N.apply(null,arguments).map(tt);return new Be(function(t,n){0===e.length&&t([]);var i=e.length;e.forEach(function(r,a){return Be.resolve(r).then(function(n){e[a]=n,--i||t(e)},n)})})},resolve:function(e){if(e instanceof Be)return e;if(e&&"function"==typeof e.then)return new Be(function(t,n){e.then(t,n)});var t=new Be(se,!0,e);return Ee(t,De),t},reject:Je,race:function(){var e=N.apply(null,arguments).map(tt);return new Be(function(t,n){e.map(function(e){return Be.resolve(e).then(t,n)})})},PSD:{get:function(){return We},set:function(e){return We=e}},newPSD:Xe,usePSD:at,scheduler:{get:function(){return we},set:function(e){we=e}},rejectionMapper:{get:function(){return Ke},set:function(e){Ke=e}},follow:function(e,t){return new Be(function(n,i){return Xe(function(t,n){var i=We;i.unhandleds=[],i.onunhandled=n,i.finalize=te(function(){var e=this;!function(e){xe.push(function t(){e();xe.splice(xe.indexOf(t),1)}),++_e,we(function(){0==--_e&&Ge()},[])}(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},i.finalize),e()},t,n,i)})}});var ze={awaits:0,echoes:0,id:0},Ue=0,$e=[],Ve=0,qe=0,Qe=0;function Xe(e,t,n,i){var r=We,a=Object.create(r);a.parent=r,a.ref=0,a.global=!1,a.id=++Qe;var s=Pe.env;a.env=ye?{Promise:Be,PromiseProp:{value:Be,configurable:!0,writable:!0},all:Be.all,race:Be.race,resolve:Be.resolve,reject:Be.reject,nthen:st(s.nthen,a),gthen:st(s.gthen,a)}:{},t&&o(a,t),++r.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=at(a,e,n,i);return 0===a.ref&&a.finalize(),l}function Ze(){return ze.id||(ze.id=++Ue),++ze.awaits,ze.echoes+=ce,ze.id}function et(e){!ze.awaits||e&&e!==ze.id||(0==--ze.awaits&&(ze.id=0),ze.echoes=ze.awaits*ce)}function tt(e){return ze.echoes&&e&&e.constructor===me?(Ze(),e.then(function(e){return et(),e},function(e){return et(),ut(e)})):e}function nt(){var e=$e[$e.length-1];$e.pop(),it(e,!1)}function it(e,t){var n,i=We;if((t?!ze.echoes||Ve++&&e===We:!Ve||--Ve&&e===We)||(n=t?function(e){++qe,ze.echoes&&0!=--ze.echoes||(ze.echoes=ze.id=0),$e.push(We),it(e,!0)}.bind(null,e):nt,ge.call(he,n)),e!==We&&(We=e,i===Pe&&(Pe.env=rt()),ye)){var r=Pe.env.Promise,o=e.env;de.then=o.nthen,r.prototype.then=o.gthen,(i.global||e.global)&&(Object.defineProperty(a,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject)}}function rt(){var e=a.Promise;return ye?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:e.all,race:e.race,resolve:e.resolve,reject:e.reject,nthen:de.then,gthen:e.prototype.then}:{}}function at(e,t,n,i,r){var a=We;try{return it(e,!0),t(n,i,r)}finally{it(a,!1)}}function ot(e,t,n){return"function"!=typeof e?e:function(){var i=We;n&&Ze(),it(t,!0);try{return e.apply(this,arguments)}finally{it(i,!1)}}}function st(e,t){return function(n,i){return e.call(this,ot(n,t,!1),ot(i,t,!1))}}var lt="unhandledrejection";function ct(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var i,r={promise:t,reason:e};if(a.document&&document.createEvent?((i=document.createEvent("Event")).initEvent(lt,!0,!0),o(i,r)):a.CustomEvent&&o(i=new CustomEvent(lt,{detail:r}),r),i&&a.dispatchEvent&&(dispatchEvent(i),!a.PromiseRejectionEvent&&a.onunhandledrejection))try{a.onunhandledrejection(i)}catch(e){}i.defaultPrevented||console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var ut=Be.reject;function ht(e){var t={},n=function(n,i){if(i){for(var r=arguments.length,a=new Array(r-1);--r;)a[r-1]=arguments[r];return t[n].subscribe.apply(null,a),e}if("string"==typeof n)return t[n]};n.addEventType=s;for(var a=1,o=arguments.length;a<o;++a)s(arguments[a]);return n;function s(e,a,o){if("object"!=typeof e){var l;a||(a=ae),o||(o=X);var c={subscribers:[],fire:o,subscribe:function(e){-1===c.subscribers.indexOf(e)&&(c.subscribers.push(e),c.fire=a(c.fire,e))},unsubscribe:function(e){c.subscribers=c.subscribers.filter(function(t){return t!==e}),c.fire=c.subscribers.reduce(a,o)}};return t[e]=n[e]=c,c}i(l=e).forEach(function(e){var t=l[e];if(r(t))s(e,l[e][0],l[e][1]);else{if("asap"!==t)throw new V.InvalidArgument("Invalid event config");var n=s(e,Z,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach(function(e){b(function(){e.apply(null,t)})})})}})}}var dt,ft=String.fromCharCode(65535),gt=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return ft}}(),mt=-1/0,pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",yt="String expected.",vt=[],bt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wt=bt,St=bt,kt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function At(e,t){var n,s,l,h,f,g=At.dependencies,m=o({addons:At.addons,autoOpen:!0,indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange},t),b=m.addons,K=m.autoOpen,W=m.indexedDB,x=m.IDBKeyRange,B=this._dbSchema={},I=[],R=[],H={},L=null,j=null,G=!1,J=null,U=!1,$="readwrite",q=this,Q=new Be(function(e){n=e}),te=new Be(function(e,t){s=t}),ae=!0,se=!!Nt(W);function le(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function ce(e,t,n){var r=q._createTransaction($,R,B);r.create(t),r._completion.catch(n);var a=r._reject.bind(r);Xe(function(){We.trans=r,0===e?(i(B).forEach(function(e){ue(t,e,B[e].primKey,B[e].indexes)}),Be.follow(function(){return q.on.populate.fire(r)}).catch(a)):function(e,t,n){var r=[],a=I.filter(function(t){return t._cfg.version===e})[0];if(!a)throw new V.Upgrade("Dexie specification of currently installed DB version is missing");B=q._dbSchema=a._cfg.dbschema;var o=!1;return I.filter(function(t){return t._cfg.version>e}).forEach(function(e){r.push(function(){var i=B,r=e._cfg.dbschema;Me(i,n),Me(r,n),B=q._dbSchema=r;var a=function(e,t){var n={del:[],add:[],change:[]};for(var i in e)t[i]||n.del.push(i);for(i in t){var r=e[i],a=t[i];if(r){var o={name:i,def:a,recreate:!1,del:[],add:[],change:[]};if(r.primKey.src!==a.primKey.src)o.recreate=!0,n.change.push(o);else{var s=r.idxByName,l=a.idxByName;for(var c in s)l[c]||o.del.push(c);for(c in l){var u=s[c],h=l[c];u?u.src!==h.src&&o.change.push(h):o.add.push(h)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}else n.add.push([i,a])}return n}(i,r);if(a.add.forEach(function(e){ue(n,e[0],e[1].primKey,e[1].indexes)}),a.change.forEach(function(e){if(e.recreate)throw new V.Upgrade("Not yet support for changing primary key");var t=n.objectStore(e.name);e.add.forEach(function(e){he(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),he(t,e)}),e.del.forEach(function(e){t.deleteIndex(e)})}),e._cfg.contentUpgrade)return o=!0,Be.follow(function(){e._cfg.contentUpgrade(t)})}),r.push(function(t){o&&wt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var i=t.db.objectStoreNames[n];null==e[i]&&t.db.deleteObjectStore(i)}}(e._cfg.dbschema,t)})}),function e(){return r.length?Be.resolve(r.shift()(t.idbtrans)).then(e):Be.resolve()}().then(function(){!function(e,t){i(e).forEach(function(n){t.db.objectStoreNames.contains(n)||ue(t,n,e[n].primKey,e[n].indexes)})}(B,n)})}(e,r,t).catch(a)})}function ue(e,t,n,i){var r=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(e){he(r,e)}),r}function he(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function de(e,t,n){this.name=e,this.schema=t,this._tx=n,this.hook=H[e]?H[e].hook:ht(null,{creating:[ne,X],reading:[ee,Z],updating:[re,X],deleting:[ie,X]})}function fe(e,t,n){return(n?Wt:Kt)(function(n){e.push(n),t&&t()})}function ge(e,t,n,i,r){return new Be(function(a,o){var s=n.length,l=s-1;if(0===s)return a();if(i){var c,u=Wt(o),h=Dt(null);k(function(){for(var i=0;i<s;++i){c={onsuccess:null,onerror:null};var o=n[i];r.call(c,o[0],o[1],t);var d=e.delete(o[0]);d._hookCtx=c,d.onerror=u,d.onsuccess=i===l?Dt(a):h}},function(e){throw c.onerror&&c.onerror(e),e})}else for(var d=0;d<s;++d){var f=e.delete(n[d]);f.onerror=Kt(o),d===l&&(f.onsuccess=Ye(function(){return a()}))}})}function ye(e,t,n,i){var r=this;this.db=q,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=ht(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Be(function(e,t){r._resolve=e,r._reject=t}),this._completion.then(function(){r.active=!1,r.on.complete.fire()},function(e){var t=r.active;return r.active=!1,r.on.error.fire(e),r.parent?r.parent._reject(e):t&&r.idbtrans&&r.idbtrans.abort(),ut(e)})}function ve(e,t,n){this._ctx={table:e,index:":id"===t?null:t,or:n}}function be(e,t){var n=null,i=null;if(t)try{n=t()}catch(e){i=e}var r=e._ctx,a=r.table;this._ctx={table:a,index:r.index,isPrimKey:!r.index||a.schema.primKey.keyPath&&r.index===a.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:r.or,valueMapper:a.hook.reading.fire}}function we(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Se(e,t){return e._cfg.version-t._cfg.version}function ke(e,t,n){t.forEach(function(t){var i=n[t];e.forEach(function(e){t in e||(e===ye.prototype||e instanceof ye?d(e,t,{get:function(){return this.table(t)}}):e[t]=new de(t,i))})})}function Ae(e,t,n,i,r,a){var o=Ye(a?function(e,t,i){return n(a(e),t,i)}:n,r);e.onerror||(e.onerror=Kt(r)),e.onsuccess=S(t?function(){var n=e.result;if(n){var a=function(){n.continue()};t(n,function(e){a=e},i,r)&&o(n.value,n,function(e){a=e}),a()}else i()}:function(){var t=e.result;if(t){var n=function(){t.continue()};o(t.value,t,function(e){n=e}),n()}else i()},r)}function Ce(e,t){return W.cmp(e,t)}function De(e,t){return Ce(e,t)>0?e:t}function Ke(e,t){return W.cmp(e,t)}function Pe(e,t){return W.cmp(t,e)}function Te(e,t){return e<t?-1:e===t?0:1}function _e(e,t){return e>t?-1:e===t?0:1}function xe(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function Me(e,t){for(var n=t.db.objectStoreNames,i=0;i<n.length;++i){var r=n[i],o=t.objectStore(r);l="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var c=o.indexNames[s],u=o.index(c).keyPath,h="string"==typeof u?u:"["+p(u).join("+")+"]";if(e[r]){var d=e[r].idxByName[h];d&&(d.name=c)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l=!1)}function Ne(e){q.on("blocked").fire(e),vt.filter(function(e){return e.name===q.name&&e!==q&&!e._vcFired}).map(function(t){return t.on("versionchange").fire(e)})}this.version=function(e){if(L||G)throw new V.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=I.filter(function(t){return t._cfg.version===e})[0];return t||(t=new le(e),I.push(t),I.sort(Se),ae=!1,t)},o(le.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var t={};I.forEach(function(e){o(t,e._cfg.storesSource)});var n=this._cfg.dbschema={};return this._parseStoresSpec(t,n),B=q._dbSchema=n,[H,q,ye.prototype].forEach(function(e){for(var t in e)e[t]instanceof de&&delete e[t]}),ke([H,q,ye.prototype,this._cfg.tables],i(n),n),R=i(n),this},upgrade:function(e){return this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){i(e).forEach(function(n){if(null!==e[n]){var i={},a=function(e){var t=[];return e.split(",").forEach(function(e){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;t.push(new xt(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),r(i),/\./.test(e)))}),t}(e[n]),o=a.shift();if(o.multi)throw new V.Schema("Primary key cannot be multi-valued");o.keyPath&&C(i,o.keyPath,o.auto?0:o.keyPath),a.forEach(function(e){if(e.auto)throw new V.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new V.Schema("Index must have a name and cannot be an empty string");C(i,e.keyPath,e.compound?e.keyPath.map(function(){return""}):"")}),t[n]=new Bt(n,o,a,i)}})}}),this._allTables=H,this._createTransaction=function(e,t,n,i){return new ye(e,t,n,i)},this._whenReady=function(e){return U||We.letThrough?e():new Be(function(e,t){if(!G){if(!K)return void t(new V.DatabaseClosed);q.open().catch(X)}Q.then(e,t)}).then(e)},this.verno=0,this.open=function(){if(G||L)return Q.then(function(){return j?ut(j):q});O&&(te._stackHolder=E()),G=!0,j=null,U=!1;var t=n,r=null;return Be.race([te,new Be(function(t,n){if(!W)throw new V.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=ae?W.open(e):W.open(e,Math.round(10*q.verno));if(!a)throw new V.MissingAPI("IndexedDB API not available");a.onerror=Kt(n),a.onblocked=Ye(Ne),a.onupgradeneeded=Ye(function(t){if(r=a.transaction,ae&&!q._allowEmptyDB){a.onerror=Tt,r.abort(),a.result.close();var i=W.deleteDatabase(e);i.onsuccess=i.onerror=Ye(function(){n(new V.NoSuchDatabase("Database "+e+" doesnt exist"))})}else{r.onerror=Kt(n),ce((t.oldVersion>Math.pow(2,62)?0:t.oldVersion)/10,r,n)}},n),a.onsuccess=Ye(function(){if(r=null,L=a.result,vt.push(q),ae)!function(){if(q.verno=L.version/10,q._dbSchema=B={},0===(R=p(L.objectStoreNames,0)).length)return;var e=L.transaction(Mt(R),"readonly");R.forEach(function(t){for(var n=e.objectStore(t),i=n.keyPath,r=i&&"string"==typeof i&&-1!==i.indexOf("."),a=new xt(i,i||"",!1,!1,!!n.autoIncrement,i&&"string"!=typeof i,r),o=[],s=0;s<n.indexNames.length;++s){var l=n.index(n.indexNames[s]);i=l.keyPath,r=i&&"string"==typeof i&&-1!==i.indexOf(".");var c=new xt(l.name,i,!!l.unique,!!l.multiEntry,!1,i&&"string"!=typeof i,r);o.push(c)}B[t]=new Bt(t,a,o,{})}),ke([H],i(B),B)}();else if(L.objectStoreNames.length>0)try{Me(B,L.transaction(Mt(L.objectStoreNames),"readonly"))}catch(e){}L.onversionchange=Ye(function(e){q._vcFired=!0,q.on("versionchange").fire(e)}),se||"__dbnames"===e||dt.dbnames.put({name:e}).catch(X),t()},n)})]).then(function(){return J=[],Be.resolve(At.vip(q.on.ready.fire)).then(function e(){if(J.length>0){var t=J.reduce(oe,X);return J=[],Be.resolve(At.vip(t)).then(e)}})}).finally(function(){J=null}).then(function(){return G=!1,q}).catch(function(e){try{r&&r.abort()}catch(e){}return G=!1,q.close(),ut(j=e)}).finally(function(){U=!0,t()})},this.close=function(){var e=vt.indexOf(q);if(e>=0&&vt.splice(e,1),L){try{L.close()}catch(e){}L=null}K=!1,j=new V.DatabaseClosed,G&&s(j),Q=new Be(function(e){n=e}),te=new Be(function(e,t){s=t})},this.delete=function(){var t=arguments.length>0;return new Be(function(n,i){if(t)throw new V.InvalidArgument("Arguments not allowed in db.delete()");function r(){q.close();var t=W.deleteDatabase(e);t.onsuccess=Ye(function(){se||dt.dbnames.delete(e).catch(X),n()}),t.onerror=Kt(i),t.onblocked=Ne}G?Q.then(r):r()})},this.backendDB=function(){return L},this.isOpen=function(){return null!==L},this.hasBeenClosed=function(){return j&&j instanceof V.DatabaseClosed},this.hasFailed=function(){return null!==j},this.dynamicallyOpened=function(){return ae},this.name=e,u(this,{tables:{get:function(){return i(H).map(function(e){return H[e]})}}}),this.on=ht(this,"populate","blocked","versionchange",{ready:[oe,X]}),this.on.ready.subscribe=y(this.on.ready.subscribe,function(e){return function(t,n){At.vip(function(){U?(j||Be.resolve().then(t),n&&e(t)):J?(J.push(t),n&&e(t)):(e(t),n||e(function e(){q.on.ready.unsubscribe(t),q.on.ready.unsubscribe(e)}))})}}),this.transaction=function(){var e=function(e,t,n){var i=arguments.length;if(i<2)throw new V.InvalidArgument("Too few arguments");var r=new Array(i-1);for(;--i;)r[i-1]=arguments[i];n=r.pop();var a=P(r);return[e,a,n]}.apply(this,arguments);return this._transaction.apply(this,e)},this._transaction=function(e,t,n){var i=We.trans;i&&i.db===q&&-1===e.indexOf("!")||(i=null);var r=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{var a=t.map(function(e){var t=e instanceof de?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t});if("r"==e||"readonly"==e)e="readonly";else{if("rw"!=e&&e!=$)throw new V.InvalidArgument("Invalid transaction mode: "+e);e=$}if(i){if("readonly"===i.mode&&e===$){if(!r)throw new V.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach(function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!r)throw new V.SubTransaction("Table "+e+" not included in parent transaction.");i=null}}),r&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,n){n(e)}):ut(e)}return i?i._promise(e,o,"lock"):We.trans?at(We.transless,function(){return q._whenReady(o)}):q._whenReady(o);function o(){return Be.resolve().then(function(){var t,r=We.transless||We,o=q._createTransaction(e,a,B,i),s={trans:o,transless:r};i?o.idbtrans=i.idbtrans:o.create(),n.constructor===pe&&Ze();var l=Be.follow(function(){if(t=n.call(o,o))if(t.constructor===me){var e=et.bind(null,null);t.then(e,e)}else"function"==typeof t.next&&"function"==typeof t.throw&&(t=_t(t))},s);return(t&&"function"==typeof t.then?Be.resolve(t).then(function(e){return o.active?e:ut(new V.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):l.then(function(){return t})).then(function(e){return i&&o._resolve(),o._completion.then(function(){return e})}).catch(function(e){return o._reject(e),ut(e)})})}},this.table=function(e){if(!c(H,e))throw new V.InvalidTable("Table "+e+" does not exist");return H[e]},u(de.prototype,{_trans:function(e,t,n){var i=this._tx||We.trans;return i&&i.db===q?i===We.trans?i._promise(e,t,n):Xe(function(){return i._promise(e,t,n)},{trans:i,transless:We.transless||We}):function e(t,n,i){if(U||We.letThrough){var r=q._createTransaction(t,n,B);try{r.create()}catch(e){return ut(e)}return r._promise(t,function(e,t){return Xe(function(){return We.trans=r,i(e,t,r)})}).then(function(e){return r._completion.then(function(){return e})})}if(!G){if(!K)return ut(new V.DatabaseClosed);q.open().catch(X)}return Q.then(function(){return e(t,n,i)})}(e,[this.name],t)},_idbstore:function(e,t,n){var i=this.name;return this._trans(e,function(e,n,r){if(-1===r.storeNames.indexOf(i))throw new V.NotFound("Table"+i+" not part of transaction");return t(e,n,r.idbtrans.objectStore(i),r)},n)},get:function(e,t){if(e&&e.constructor===Object)return this.where(e).first(t);var n=this;return this._idbstore("readonly",function(t,i,r){var a=r.get(e);a.onerror=Kt(i),a.onsuccess=Ye(function(){t(n.hook.reading.fire(a.result))},i)}).then(t)},where:function(e){if("string"==typeof e)return new ve(this,e);if(r(e))return new ve(this,"["+e.join("+")+"]");var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){return e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})&&e.keyPath.every(function(e){return t.indexOf(e)>=0})})[0];if(n&&gt!==ft)return this.where(n.name).equals(n.keyPath.map(function(t){return e[t]}));n||console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var a=this.schema.idxByName,o=t.reduce(function(t,n){return[t[0]||a[n],t[0]||!a[n]?xe(t[1],function(t){return""+A(t,n)==""+e[n]}):t[1]]},[null,null]),s=o[0];return s?this.where(s.name).equals(e[s.keyPath]).filter(o[1]):n?this.filter(o[1]):this.where(t).equals("")},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new be(new ve(this,r(e)?"["+e.join("+")+"]":e))},toCollection:function(){return new be(new ve(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var n=Object.create(e.prototype);t&&Ct(n,t),this.schema.instanceTemplate=n;var i=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var i in t)if(c(t,i))try{n[i]=t[i]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),e},defineClass:function(e){return this.mapToClass(At.defineClass(e),e)},bulkDelete:function(e){return this.hook.deleting.fire===X?this._idbstore($,function(t,n,i,r){t(ge(i,r,e,!1,X))}):this.where(":id").anyOf(e).delete().then(function(){})},bulkPut:function(e,t){var n=this;return this._idbstore($,function(i,r,a){if(!a.keyPath&&!n.schema.primKey.auto&&!t)throw new V.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(a.keyPath&&t)throw new V.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();var o,s,l=function(e){0===c.length?i(e):r(new z(n.name+".bulkPut(): "+c.length+" of "+u+" operations failed",c))},c=[],u=e.length,h=n;if(n.hook.creating.fire===X&&n.hook.updating.fire===X){s=fe(c);for(var d=0,f=e.length;d<f;++d)(o=t?a.put(e[d],t[d]):a.put(e[d])).onerror=s;o.onerror=fe(c,l),o.onsuccess=Pt(l)}else{var g=t||a.keyPath&&e.map(function(e){return A(e,a.keyPath)}),m=g&&w(g,function(t,n){return null!=t&&[t,e[n]]});(g?h.where(":id").anyOf(g.filter(function(e){return null!=e})).modify(function(){this.value=m[this.primKey],m[this.primKey]=null}).catch(Y,function(e){c=e.failures}).then(function(){for(var n=[],i=t&&[],r=g.length-1;r>=0;--r){var a=g[r];(null==a||m[a])&&(n.push(e[r]),t&&i.push(a),null!=a&&(m[a]=null))}return n.reverse(),t&&i.reverse(),h.bulkAdd(n,i)}).then(function(e){var t=g[g.length-1];return null!=t?t:e}):h.bulkAdd(e)).then(l).catch(z,function(e){c=c.concat(e.failures),l()}).catch(r)}},"locked")},bulkAdd:function(e,t){var n=this,i=this.hook.creating.fire;return this._idbstore($,function(r,a,o,s){if(!o.keyPath&&!n.schema.primKey.auto&&!t)throw new V.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(o.keyPath&&t)throw new V.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return r();function l(e){0===d.length?r(e):a(new z(n.name+".bulkAdd(): "+d.length+" of "+f+" operations failed",d))}var c,u,h,d=[],f=e.length;if(i!==X){var g,m=o.keyPath;u=fe(d,null,!0),h=Dt(null),k(function(){for(var n=0,r=e.length;n<r;++n){g={onerror:null,onsuccess:null};var a=t&&t[n],l=e[n],d=t?a:m?A(l,m):void 0,f=i.call(g,d,l,s);null==d&&null!=f&&(m?C(l=T(l),m,f):a=f),(c=null!=a?o.add(l,a):o.add(l))._hookCtx=g,n<r-1&&(c.onerror=u,g.onsuccess&&(c.onsuccess=h))}},function(e){throw g.onerror&&g.onerror(e),e}),c.onerror=fe(d,l,!0),c.onsuccess=Dt(l)}else{u=fe(d);for(var p=0,y=e.length;p<y;++p)(c=t?o.add(e[p],t[p]):o.add(e[p])).onerror=u;c.onerror=fe(d,l),c.onsuccess=Pt(l)}})},add:function(e,t){var n=this.hook.creating.fire;return this._idbstore($,function(i,r,a,o){var s={onsuccess:null,onerror:null};if(n!==X){var l=null!=t?t:a.keyPath?A(e,a.keyPath):void 0,c=n.call(s,l,e,o);null==l&&null!=c&&(a.keyPath?C(e,a.keyPath,c):t=c)}try{var u=null!=t?a.add(e,t):a.add(e);u._hookCtx=s,u.onerror=Wt(r),u.onsuccess=Dt(function(t){var n=a.keyPath;n&&C(e,n,t),i(t)})}catch(e){throw s.onerror&&s.onerror(e),e}})},put:function(e,t){var n=this,i=this.hook.creating.fire,r=this.hook.updating.fire;if(i!==X||r!==X){var a=this.schema.primKey.keyPath,o=void 0!==t?t:a&&A(e,a);return null==o?this.add(e):(e=T(e),this._trans($,function(){return n.where(":id").equals(o).modify(function(){this.value=e}).then(function(i){return 0===i?n.add(e,t):o})},"locked"))}return this._idbstore($,function(n,i,r){var a=void 0!==t?r.put(e,t):r.put(e);a.onerror=Kt(i),a.onsuccess=Ye(function(t){var i=r.keyPath;i&&C(e,i,t.target.result),n(a.result)})})},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore($,function(t,n,i){var r=i.delete(e);r.onerror=Kt(n),r.onsuccess=Ye(function(){t(r.result)})})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore($,function(e,t,n){var i=n.clear();i.onerror=Kt(t),i.onsuccess=Ye(function(){e(i.result)})})},update:function(e,t){if("object"!=typeof t||r(t))throw new V.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||r(e))return this.where(":id").equals(e).modify(t);i(t).forEach(function(n){C(e,n,t[n])});var n=A(e,this.schema.primKey.keyPath);return void 0===n?ut(new V.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)}}),u(ye.prototype,{_lock:function(){return v(!We.global),++this._reculock,1!==this._reculock||We.global||(We.lockOwnerFor=this),this},_unlock:function(){if(v(!We.global),0==--this._reculock)for(We.global||(We.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{at(e[1],e[0])}catch(e){}}return this},_locked:function(){return this._reculock&&We.lockOwnerFor!==this},create:function(e){var t=this;if(!this.mode)return this;if(v(!this.idbtrans),!e&&!L)switch(j&&j.name){case"DatabaseClosedError":throw new V.DatabaseClosed(j);case"MissingAPIError":throw new V.MissingAPI(j.message,j);default:throw new V.OpenFailed(j)}if(!this.active)throw new V.TransactionInactive;return v(null===this._completion._state),(e=this.idbtrans=e||L.transaction(Mt(this.storeNames),this.mode)).onerror=Ye(function(n){Tt(n),t._reject(e.error)}),e.onabort=Ye(function(n){Tt(n),t.active&&t._reject(new V.Abort(e.error)),t.active=!1,t.on("abort").fire(n)}),e.oncomplete=Ye(function(){t.active=!1,t._resolve()}),this},_promise:function(e,t,n){var i=this;if(e===$&&this.mode!==$)return ut(new V.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new V.TransactionInactive);if(this._locked())return new Be(function(r,a){i._blockedFuncs.push([function(){i._promise(e,t,n).then(r,a)},We])});if(n)return Xe(function(){var e=new Be(function(e,n){i._lock();var r=t(e,n,i);r&&r.then&&r.then(e,n)});return e.finally(function(){return i._unlock()}),e._lib=!0,e});var r=new Be(function(e,n){var r=t(e,n,i);r&&r.then&&r.then(e,n)});return r._lib=!0,r},_root:function(){return this.parent?this.parent._root():this},waitFor:function(e){var t=this._root();if(e=Be.resolve(e),t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return e});else{t._waitingFor=e,t._waitingQueue=[];var n=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Be(function(n,r){e.then(function(e){return t._waitingQueue.push(Ye(n.bind(null,e)))},function(e){return t._waitingQueue.push(Ye(r.bind(null,e)))}).finally(function(){t._waitingFor===i&&(t._waitingFor=null)})})},abort:function(){this.active&&this._reject(new V.Abort),this.active=!1},tables:{get:(h="Transaction.tables",f=function(){return H},function(){return console.warn(h+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+F(E(),1)),f.apply(this,arguments)})},table:function(e){return new de(e,q.table(e).schema,this)}}),u(ve.prototype,function(){function e(e,t,n){var i=e instanceof ve?new be(e):e;return i._ctx.error=n?new n(t):new TypeError(t),i}function t(e){return new be(e,function(){return x.only("")}).limit(0)}function n(e,t,n,i,r,a){for(var o=Math.min(e.length,i.length),s=-1,l=0;l<o;++l){var c=t[l];if(c!==i[l])return r(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):r(e[l],i[l])<0?e.substr(0,l)+i[l]+n.substr(l+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;r(e[l],c)<0&&(s=l)}return o<i.length&&"next"===a?e+n.substr(e.length):o<e.length&&"prev"===a?e.substr(0,n.length):s<0?null:e.substr(0,s)+i[s]+n.substr(s+1)}function i(t,i,r,a){var o,s,l,c,u,h,d,f=r.length;if(!r.every(function(e){return"string"==typeof e}))return e(t,yt);function g(e){o=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),s=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),l="next"===e?Te:_e;var t=r.map(function(e){return{lower:s(e),upper:o(e)}}).sort(function(e,t){return l(e.lower,t.lower)});c=t.map(function(e){return e.upper}),u=t.map(function(e){return e.lower}),h=e,d="next"===e?"":a}g("next");var m=new be(t,function(){return x.bound(c[0],u[f-1]+a)});m._ondirectionchange=function(e){g(e)};var p=0;return m._addAlgorithm(function(e,t,r){var a=e.key;if("string"!=typeof a)return!1;var o=s(a);if(i(o,u,p))return!0;for(var g=null,m=p;m<f;++m){var y=n(a,o,c[m],u[m],l,h);null===y&&null===g?p=m+1:(null===g||l(g,y)>0)&&(g=y)}return t(null!==g?function(){e.continue(g+d)}:r),!1}),m}return{between:function(n,i,r,a){r=!1!==r,a=!0===a;try{return Ce(n,i)>0||0===Ce(n,i)&&(r||a)&&(!r||!a)?t(this):new be(this,function(){return x.bound(n,i,!r,!a)})}catch(t){return e(this,pt)}},equals:function(e){return new be(this,function(){return x.only(e)})},above:function(e){return new be(this,function(){return x.lowerBound(e,!0)})},aboveOrEqual:function(e){return new be(this,function(){return x.lowerBound(e)})},below:function(e){return new be(this,function(){return x.upperBound(e,!0)})},belowOrEqual:function(e){return new be(this,function(){return x.upperBound(e)})},startsWith:function(t){return"string"!=typeof t?e(this,yt):this.between(t,t+ft,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):i(this,function(e,t){return 0===e.indexOf(t[0])},[e],ft)},equalsIgnoreCase:function(e){return i(this,function(e,t){return e===t[0]},[e],"")},anyOfIgnoreCase:function(){var e=N.apply(M,arguments);return 0===e.length?t(this):i(this,function(e,t){return-1!==t.indexOf(e)},e,"")},startsWithAnyOfIgnoreCase:function(){var e=N.apply(M,arguments);return 0===e.length?t(this):i(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,ft)},anyOf:function(){var n=N.apply(M,arguments),i=Ke;try{n.sort(i)}catch(t){return e(this,pt)}if(0===n.length)return t(this);var r=new be(this,function(){return x.bound(n[0],n[n.length-1])});r._ondirectionchange=function(e){i="next"===e?Ke:Pe,n.sort(i)};var a=0;return r._addAlgorithm(function(e,t,r){for(var o=e.key;i(o,n[a])>0;)if(++a===n.length)return t(r),!1;return 0===i(o,n[a])||(t(function(){e.continue(n[a])}),!1)}),r},notEqual:function(e){return this.inAnyRange([[mt,e],[e,gt]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=N.apply(M,arguments);if(0===t.length)return new be(this);try{t.sort(Ke)}catch(t){return e(this,pt)}var n=t.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[mt,t]]},null);return n.push([t[t.length-1],gt]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,i){if(0===n.length)return t(this);if(!n.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&Ke(e[0],e[1])<=0}))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",V.InvalidArgument);var r=!i||!1!==i.includeLowers,a=i&&!0===i.includeUppers;var o,s=Ke;function l(e,t){return s(e[0],t[0])}try{(o=n.reduce(function(e,t){for(var n=0,i=e.length;n<i;++n){var r=e[n];if(Ce(t[0],r[1])<0&&Ce(t[1],r[0])>0){r[0]=(a=r[0],o=t[0],Ce(a,o)<0?a:o),r[1]=De(r[1],t[1]);break}}var a,o;return n===i&&e.push(t),e},[])).sort(l)}catch(t){return e(this,pt)}var c=0,u=a?function(e){return Ke(e,o[c][1])>0}:function(e){return Ke(e,o[c][1])>=0},h=r?function(e){return Pe(e,o[c][0])>0}:function(e){return Pe(e,o[c][0])>=0};var d=u,f=new be(this,function(){return x.bound(o[0][0],o[o.length-1][1],!r,!a)});return f._ondirectionchange=function(e){"next"===e?(d=u,s=Ke):(d=h,s=Pe),o.sort(l)},f._addAlgorithm(function(e,t,n){for(var i=e.key;d(i);)if(++c===o.length)return t(n),!1;return!!function(e){return!u(e)&&!h(e)}(i)||0!==Ce(i,o[c][1])&&0!==Ce(i,o[c][0])&&(t(function(){s===Ke?e.continue(o[c][0]):e.continue(o[c][1])}),!1)}),f},startsWithAnyOf:function(){var n=N.apply(M,arguments);return n.every(function(e){return"string"==typeof e})?0===n.length?t(this):this.inAnyRange(n.map(function(e){return[e,e+ft]})):e(this,"startsWithAnyOf() only works with strings")}}}),u(be.prototype,function(){function e(e,t){e.filter=xe(e.filter,t)}function t(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return xe(i(),t())}:t,e.justLimit=n&&!i}function n(e,t){if(e.isPrimKey)return t;var n=e.table.schema.idxByName[e.index];if(!n)throw new V.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(n.name)}function r(e,t){var i=n(e,t);return e.keysOnly&&"openKeyCursor"in i?i.openKeyCursor(e.range||null,e.dir+e.unique):i.openCursor(e.range||null,e.dir+e.unique)}function a(e,t,n,i,a){var o=e.replayFilter?xe(e.filter,e.replayFilter()):e.filter;e.or?function(){var s={},l=0;function u(){2==++l&&n()}function h(e,n,r){if(!o||o(n,r,u,i)){var a=n.primaryKey,l=""+a;"[object ArrayBuffer]"===l&&(l=""+new Uint8Array(a)),c(s,l)||(s[l]=!0,t(e,n,r))}}e.or._iterate(h,u,i,a),Ae(r(e,a),e.algorithm,h,u,i,!e.keysOnly&&e.valueMapper)}():Ae(r(e,a),xe(e.algorithm,o),t,n,i,!e.keysOnly&&e.valueMapper)}return{_read:function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ut.bind(null,n.error)):n.table._idbstore("readonly",e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,ut.bind(null,t.error)):t.table._idbstore($,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=xe(t.algorithm,e)},_iterate:function(e,t,n,i){return a(this._ctx,e,t,n,i)},clone:function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&o(n,e),t._ctx=n,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;return this._read(function(n,i,r){a(t,e,n,i,r)})},count:function(e){var t=this._ctx;if(we(t,!0))return this._read(function(e,i,r){var a=n(t,r),o=t.range?a.count(t.range):a.count();o.onerror=Kt(i),o.onsuccess=function(n){e(Math.min(n.target.result,t.limit))}},e);var i=0;return this._read(function(e,n,r){a(t,function(){return++i,!1},function(){e(i)},n,r)},e)},sortBy:function(e,t){var n=e.split(".").reverse(),i=n[0],r=n.length-1;function a(e,t){return t?a(e[n[t]],t-1):e[i]}var o="next"===this._ctx.dir?1:-1;function s(e,t){var n=a(e,r),i=a(t,r);return n<i?-o:n>i?o:0}return this.toArray(function(e){return e.sort(s)}).then(t)},toArray:function(e){var t=this._ctx;return this._read(function(e,i,r){if(l&&"next"===t.dir&&we(t,!0)&&t.limit>0){var o=t.table.hook.reading.fire,s=n(t,r),c=t.limit<1/0?s.getAll(t.range,t.limit):s.getAll(t.range);c.onerror=Kt(i),c.onsuccess=Pt(o===Z?e:function(t){try{e(t.map(o))}catch(e){i(e)}})}else{var u=[];a(t,function(e){u.push(e)},function(){e(u)},i,r)}},e)},offset:function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,we(n)?t(n,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):t(n,function(){var t=e;return function(){return--t<0}}),this)},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,function(){var t=e;return function(e,n,i){return--t<=0&&n(i),t>=0}},!0),this},until:function(t,n){return e(this._ctx,function(e,i,r){return!t(e.value)||(i(r),n)}),this},first:function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){var n,i;return e(this._ctx,function(e){return t(e.value)}),n=this._ctx,i=t,n.isMatch=xe(n.isMatch,i),this},and:function(e){return this.filter(e)},or:function(e){return new ve(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},primaryKeys:function(e){var t=this._ctx;if(l&&"next"===t.dir&&we(t,!0)&&t.limit>0)return this._read(function(e,i,r){var a=n(t,r),o=t.limit<1/0?a.getAllKeys(t.range,t.limit):a.getAllKeys(t.range);o.onerror=Kt(i),o.onsuccess=Pt(e)}).then(e);t.keysOnly=!t.isMatch;var i=[];return this.each(function(e,t){i.push(t.primaryKey)}).then(function(){return i}).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var i={};return e(this._ctx,function(e){var t=e.primaryKey.toString(),n=c(i,t);return i[t]=!0,!n}),this},modify:function(e){var t=this,n=this._ctx.table.hook,r=n.updating.fire,a=n.deleting.fire;return this._write(function(n,s,l,u){var h;if("function"==typeof e)h=r===X&&a===X?e:function(t){var n=T(t);if(!1===e.call(this,t,this))return!1;if(c(this,"value")){var o=_(n,this.value),s=r.call(this,o,this.primKey,n,u);s&&(t=this.value,i(s).forEach(function(e){C(t,e,s[e])}))}else a.call(this,this.primKey,t,u)};else if(r===X){var d=i(e),f=d.length;h=function(t){for(var n=!1,i=0;i<f;++i){var r=d[i],a=e[r];A(t,r)!==a&&(C(t,r,a),n=!0)}return n}}else{var g=e;e=D(g),h=function(t){var n=!1,a=r.call(this,e,this.primKey,T(t),u);return a&&o(e,a),i(e).forEach(function(i){var r=e[i];A(t,i)!==r&&(C(t,i,r),n=!0)}),a&&(e=D(g)),n}}var m=0,p=0,y=!1,v=[],b=[],w=null;function S(e){return e&&(v.push(e),b.push(w)),s(new Y("Error modifying one or more objects",v,p,b))}function K(){y&&p+v.length===m&&(v.length>0?S():n(p))}t.clone().raw()._iterate(function(e,t){w=t.primaryKey;var n={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};function i(e){return v.push(e),b.push(n.primKey),K(),!0}if(!1!==h.call(n,e,n)){var r=!c(n,"value");++m,k(function(){var e=r?t.delete():t.update(n.value);e._hookCtx=n,e.onerror=Wt(i),e.onsuccess=Dt(function(){++p,K()})},i)}else n.onsuccess&&n.onsuccess(n.value)},function(){y=!0,K()},S,l)})},delete:function(){var e=this,t=this._ctx,n=t.range,i=t.table.hook.deleting.fire,r=i!==X;if(!r&&we(t)&&(t.isPrimKey&&!St||!n))return this._write(function(e,t,i){var r=Kt(t),a=n?i.count(n):i.count();a.onerror=r,a.onsuccess=function(){var o=a.result;k(function(){var t=n?i.delete(n):i.clear();t.onerror=r,t.onsuccess=function(){return e(o)}},function(e){return t(e)})}});var a=r?2e3:1e4;return this._write(function(n,o,s,l){var c=0,u=e.clone({keysOnly:!t.isMatch&&!r}).distinct().limit(a).raw(),h=[],d=function(){return u.each(r?function(e,t){h.push([t.primaryKey,t.value])}:function(e,t){h.push(t.primaryKey)}).then(function(){return r?h.sort(function(e,t){return Ke(e[0],t[0])}):h.sort(Ke),ge(s,l,h,r,i)}).then(function(){var e=h.length;return c+=e,h=[],e<a?c:d()})};n(d())})}}}),o(this,{Collection:be,Table:de,Transaction:ye,Version:le,WhereClause:ve}),q.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+q.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+q.name+"'. Closing db now to resume the delete request."),q.close()}),q.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+q.name+"') was blocked"):console.warn("Upgrade '"+q.name+"' blocked by other connection holding version "+e.oldVersion/10)}),b.forEach(function(e){e(q)})}function Ct(e,t){return i(t).forEach(function(n){var i=function e(t){if("function"==typeof t)return new t;if(r(t))return[e(t[0])];if(t&&"object"==typeof t){var n={};return Ct(n,t),n}return t}(t[n]);e[n]=i}),e}function Dt(e){return Ye(function(t){var n=t.target,i=n._hookCtx,r=i.value||n.result,a=i&&i.onsuccess;a&&a(r),e&&e(r)},e)}function Kt(e){return Ye(function(t){return Tt(t),e(t.target.error),!1})}function Pt(e){return Ye(function(t){e(t.target.result)})}function Wt(e){return Ye(function(t){var n=t.target,i=n.error,r=n._hookCtx,a=r&&r.onerror;return a&&a(i),Tt(t),e(i),!1})}function Tt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function _t(e){var t=function(t){return e.next(t)},n=a(t),i=a(function(t){return e.throw(t)});function a(e){return function(t){var a=e(t),o=a.value;return a.done?o:o&&"function"==typeof o.then?o.then(n,i):r(o)?Be.all(o).then(n,i):n(o)}}return a(t)()}function xt(e,t,n,i,r,a,o){this.name=e,this.keyPath=t,this.unique=n,this.multi=i,this.auto=r,this.compound=a,this.dotted=o;var s="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(n?"&":"")+(i?"*":"")+(r?"++":"")+s}function Bt(e,t,n,i){this.name=e,this.primKey=t||new xt,this.indexes=n||[new xt],this.instanceTemplate=i,this.mappedClass=null,this.idxByName=w(n,function(e){return[e.name,e]})}function Mt(e){return 1===e.length?e[0]:e}function Nt(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}I(O,kt),u(At,Q),u(At,{delete:function(e){var t=new At(e),n=t.delete();return n.onblocked=function(e){return t.on("blocked",e),this},n},exists:function(e){return new At(e).open().then(function(e){return e.close(),!0}).catch(At.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(e){var t=Nt(At.dependencies.indexedDB);return t?new Be(function(e,n){var i=t();i.onsuccess=function(t){e(p(t.target.result,0))},i.onerror=Kt(n)}).then(e):dt.dbnames.toCollection().primaryKeys(e)},defineClass:function(){return function(e){e&&o(this,e)}},applyStructure:Ct,ignoreTransaction:function(e){return We.trans?at(We.transless,e):e()},vip:function(e){return Xe(function(){return We.letThrough=!0,e()})},async:function(e){return function(){try{var t=_t(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Be.resolve(t)}catch(e){return ut(e)}}},spawn:function(e,t,n){try{var i=_t(e.apply(n,t||[]));return i&&"function"==typeof i.then?i:Be.resolve(i)}catch(e){return ut(e)}},currentTransaction:{get:function(){return We.trans||null}},waitFor:function(e,t){var n=Be.resolve("function"==typeof e?At.ignoreTransaction(e):e).timeout(t||6e4);return We.trans?We.trans.waitFor(n):n},Promise:Be,debug:{get:function(){return O},set:function(e){I(e,"dexie"===e?function(){return!0}:kt)}},derive:f,extend:o,props:u,override:y,Events:ht,getByKeyPath:A,setByKeyPath:C,delByKeyPath:function(e,t){"string"==typeof t?C(e,t,void 0):"length"in t&&[].map.call(t,function(t){C(e,t,void 0)})},shallowClone:D,deepClone:T,getObjectDiff:_,asap:b,maxKey:gt,minKey:mt,addons:[],connections:vt,MultiModifyError:V.Modify,errnames:U,IndexSpec:xt,TableSchema:Bt,dependencies:function(){try{return{indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"{version}",version:"{version}".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)}),default:At,Dexie:At}),Be.rejectionMapper=function(e,t){if(!e||e instanceof J||e instanceof TypeError||e instanceof SyntaxError||!e.name||!q[e.name])return e;var n=new q[e.name](t||e.message,e);return"stack"in e&&d(n,"stack",{get:function(){return this.inner.stack}}),n},(dt=new At("__dbnames")).version(1).stores({dbnames:"name"}),function(){try{void 0!==typeof localStorage&&void 0!==a.document&&(JSON.parse(localStorage.getItem("Dexie.DatabaseNames")||"[]").forEach(function(e){return dt.dbnames.put({name:e}).catch(X)}),localStorage.removeItem("Dexie.DatabaseNames"))}catch(e){}}(),t.default=At}.call(this,n(18),n(41).setImmediate)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new a(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(42),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(18))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,r,a,o,s,l=1,c={},u=!1,h=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){g(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){g(e.data)},i=function(e){a.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(e){var t=h.createElement("script");t.onreadystatechange=function(){g(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):i=function(e){setTimeout(g,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&g(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[l]=r,i(l),l++},d.clearImmediate=f}function f(e){delete c[e]}function g(e){if(u)setTimeout(g,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(18),n(32))}]);
//# sourceMappingURL=seeder.js.map